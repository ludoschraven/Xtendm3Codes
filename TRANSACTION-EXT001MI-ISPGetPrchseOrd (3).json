{"utilities":{},"programModules":{"EXT001MI":{"program":"EXT001MI","triggers":{},"transactions":{"ISPGetPrchseOrd":{"sourceUuid":"f65058ed-dac1-40d1-a9ed-feebcaf6a608","name":"ISPGetPrchseOrd","program":"EXT001MI","description":"ALL_MI_0001_GetPurchaseOrders","active":true,"multi":true,"modified":1668280645258,"modifiedBy":"MALALS01","outputFields":[{"name":"RCTP","description":"Record Type (OH,OC,OL,LR,LC)","length":2,"mandatory":false,"type":"A"},{"name":"DIVI","description":"division","length":3,"mandatory":false,"type":"A"},{"name":"FACI","description":"facility","length":3,"mandatory":false,"type":"A"},{"name":"WHLO","description":"warehouse","length":3,"mandatory":false,"type":"A"},{"name":"PUNO","description":"purchase order number","length":10,"mandatory":false,"type":"A"},{"name":"SUNO","description":"supplier","length":10,"mandatory":false,"type":"A"},{"name":"SUNM","description":"supplier name","length":700,"mandatory":false,"type":"A"},{"name":"RENM","description":"name","length":36,"mandatory":false,"type":"A"},{"name":"BUYE","description":"buyer","length":10,"mandatory":false,"type":"A"},{"name":"CSCD","description":"country","length":3,"mandatory":false,"type":"A"},{"name":"CUCD","description":"currency","length":3,"mandatory":false,"type":"A"},{"name":"DATE","description":"entry date","length":8,"mandatory":false,"type":"N"},{"name":"PUDT","description":"order date","length":8,"mandatory":false,"type":"N"},{"name":"DWDT","description":"requested delivery date","length":8,"mandatory":false,"type":"N"},{"name":"YRE1","description":"your reference","length":36,"mandatory":false,"type":"A"},{"name":"PHNO","description":"telephone number 1","length":16,"mandatory":false,"type":"A"},{"name":"TFNO","description":"facsimile transmission number","length":16,"mandatory":false,"type":"A"},{"name":"REMK","description":"remark","length":30,"mandatory":false,"type":"A"},{"name":"ORTY","description":"order type","length":3,"mandatory":false,"type":"A"},{"name":"COAM","description":"total order cost","length":17,"mandatory":false,"type":"N"},{"name":"TOQT","description":"total quantity","length":15,"mandatory":false,"type":"N"},{"name":"TEPY","description":"payment terms","length":3,"mandatory":false,"type":"A"},{"name":"MODL","description":"delivery method","length":3,"mandatory":false,"type":"A"},{"name":"TEDL","description":"delivery terms","length":3,"mandatory":false,"type":"A"},{"name":"TEPA","description":"packaging terms","length":3,"mandatory":false,"type":"A"},{"name":"TEL1","description":"terms text","length":36,"mandatory":false,"type":"A"},{"name":"PUSL","description":"lowest status - purchase order","length":2,"mandatory":false,"type":"A"},{"name":"PUST","description":"highest status - purchase order","length":2,"mandatory":false,"type":"A"},{"name":"CDSE","description":"sequence number - costing element","length":4,"mandatory":false,"type":"N"},{"name":"REPN","description":"receiving number","length":10,"mandatory":false,"type":"N"},{"name":"EXTY","description":"charge type","length":1,"mandatory":false,"type":"N"},{"name":"TX30","description":"description","length":30,"mandatory":false,"type":"A"},{"name":"EXIC","description":"charge invoicing","length":1,"mandatory":false,"type":"N"},{"name":"WSOP","description":"costing operator","length":2,"mandatory":false,"type":"A"},{"name":"CCUC","description":"Charge Currency","length":3,"mandatory":false,"type":"A"},{"name":"CEVA","description":"costing element amount","length":15,"mandatory":false,"type":"N"},{"name":"CEVJ","description":"adjusted costing element amount","length":15,"mandatory":false,"type":"N"},{"name":"THPR","description":"3rd party charges","length":1,"mandatory":false,"type":"N"},{"name":"IVCQ","description":"invoice charge quantity","length":1,"mandatory":false,"type":"N"},{"name":"CEID","description":"costing element","length":6,"mandatory":false,"type":"A"},{"name":"PNLI","description":"purchase order line","length":3,"mandatory":false,"type":"N"},{"name":"PNLS","description":"purchase order line subnumber","length":3,"mandatory":false,"type":"N"},{"name":"ITNO","description":"item number","length":15,"mandatory":false,"type":"A"},{"name":"ADQA","description":"transport notified quantit alternate U/M","length":15,"mandatory":false,"type":"N"},{"name":"ORQT","description":"ordered quantity - basic U/M","length":15,"mandatory":false,"type":"N"},{"name":"TRDT","description":"transaction date","length":8,"mandatory":false,"type":"N"},{"name":"LWHL","description":"Line Warehouse","length":3,"mandatory":false,"type":"A"},{"name":"PITD","description":"purchase order item name","length":60,"mandatory":false,"type":"A"},{"name":"PITT","description":"purchase order item description","length":120,"mandatory":false,"type":"A"},{"name":"SITE","description":"supplier item number","length":30,"mandatory":false,"type":"A"},{"name":"CAQA","description":"approved quantity - alternate U/M","length":15,"mandatory":false,"type":"N"},{"name":"RJQA","description":"rejected quantity","length":15,"mandatory":false,"type":"N"},{"name":"SDQA","description":"stored quantity","length":15,"mandatory":false,"type":"N"},{"name":"ORQA","description":"ordered quantity - alternate U/M","length":15,"mandatory":false,"type":"N"},{"name":"IVQA","description":"invoiced quantity - alternate U/M","length":15,"mandatory":false,"type":"N"},{"name":"RVQA","description":"received quantity","length":15,"mandatory":false,"type":"N"},{"name":"CFQA","description":"confirmed quantity","length":15,"mandatory":false,"type":"N"},{"name":"OQPU","description":"Open Quantity Price UM","length":3,"mandatory":false,"type":"A"},{"name":"PURC","description":"requisition by","length":10,"mandatory":false,"type":"A"},{"name":"LBUY","description":"Line Buyer","length":10,"mandatory":false,"type":"A"},{"name":"STUM","description":"Standard UM","length":3,"mandatory":false,"type":"A"},{"name":"UNMS","description":"basic unit of measure","length":3,"mandatory":false,"type":"A"},{"name":"ALUM","description":"Alternative UM","length":3,"mandatory":false,"type":"A"},{"name":"LNAM","description":"line amount - order currency","length":15,"mandatory":false,"type":"N"},{"name":"PUPR","description":"purchase price","length":17,"mandatory":false,"type":"N"},{"name":"PUQT","description":"purchased quantity","length":15,"mandatory":false,"type":"N"},{"name":"ALPR","description":"Alternative Price","length":17,"mandatory":false,"type":"N"},{"name":"PTCD","description":"purchase price text","length":1,"mandatory":false,"type":"N"},{"name":"VTCD","description":"VAT code","length":2,"mandatory":false,"type":"N"},{"name":"GRMT","description":"goods receiving method","length":3,"mandatory":false,"type":"A"},{"name":"LMOD","description":"Line MODL","length":3,"mandatory":false,"type":"A"},{"name":"LTED","description":"Line TEDL","length":3,"mandatory":false,"type":"A"},{"name":"LTEL","description":"Line TEL1","length":36,"mandatory":false,"type":"A"},{"name":"LPSL","description":"Line PUSL","length":2,"mandatory":false,"type":"A"},{"name":"LPST","description":"Line PUST","length":2,"mandatory":false,"type":"A"},{"name":"POPN","description":"alias number","length":30,"mandatory":false,"type":"A"},{"name":"RORC","description":"reference order category","length":1,"mandatory":false,"type":"N"},{"name":"RORN","description":"reference order number","length":10,"mandatory":false,"type":"A"},{"name":"RORL","description":"reference order line","length":6,"mandatory":false,"type":"N"},{"name":"RORX","description":"line suffix","length":3,"mandatory":false,"type":"N"},{"name":"SUDO","description":"delivery note number","length":20,"mandatory":false,"type":"A"},{"name":"FRRC","description":"freight reference type","length":1,"mandatory":false,"type":"N"},{"name":"FRRE","description":"freight reference","length":12,"mandatory":false,"type":"N"},{"name":"AMOP","description":"Amount Open Std Unit Value","length":17,"mandatory":false,"type":"A"},{"name":"AMOR","description":"Amount Ordered Std Unit Value","length":17,"mandatory":false,"type":"A"},{"name":"PRCE","description":"Price Std Unit Value","length":17,"mandatory":false,"type":"N"},{"name":"UNIT","description":"Unit - Std Unit Value","length":3,"mandatory":false,"type":"A"},{"name":"OPQT","description":"Open Quantity Std Unit Value","length":17,"mandatory":false,"type":"A"},{"name":"QTIV","description":"Quantity Invoice Std Unit Value","length":17,"mandatory":false,"type":"A"},{"name":"QTOR","description":"Quantity Ordered Std Unit Value","length":17,"mandatory":false,"type":"A"},{"name":"QTRV","description":"Quantity Received - Std Unit Value","length":17,"mandatory":false,"type":"A"},{"name":"ALTU","description":"Alternative Unit - Unit Value","length":3,"mandatory":false,"type":"A"},{"name":"ALQO","description":"Alternative Quanity Open Unit Value","length":17,"mandatory":false,"type":"N"},{"name":"ALTP","description":"Alternative Price Unit Value","length":17,"mandatory":false,"type":"N"},{"name":"RPNM","description":"Receipt Number","length":15,"mandatory":false,"type":"A"},{"name":"RELP","description":"receipt type","length":1,"mandatory":false,"type":"N"},{"name":"RPDT","description":"Receipt Date","length":8,"mandatory":false,"type":"A"},{"name":"RPQT","description":"Receipt Quantity","length":17,"mandatory":false,"type":"N"},{"name":"RQAL","description":"Receipt Quantity Alternative UM","length":17,"mandatory":false,"type":"A"},{"name":"OAOU","description":"Open Amount Order UM","length":17,"mandatory":false,"type":"A"},{"name":"OALC","description":"Open Amount Local Currency","length":17,"mandatory":false,"type":"A"},{"name":"OPCW","description":"Open Catch Weight","length":17,"mandatory":false,"type":"N"},{"name":"OQOU","description":"Open Quantity Order UM","length":17,"mandatory":false,"type":"A"},{"name":"OQPM","description":"Open Quantity Purchase Order Price UM","length":17,"mandatory":false,"type":"A"},{"name":"CELD","description":"Costing element Description","length":20,"mandatory":false,"type":"A"},{"name":"IVCS","description":"Invoice Costs","length":20,"mandatory":false,"type":"A"},{"name":"CHFC","description":"Charge Factor","length":20,"mandatory":false,"type":"A"}],"inputFields":[{"name":"SUNO","description":"supplier","length":10,"mandatory":false,"type":"A"},{"name":"PUNO","description":"Purchase Orders List (semi-colon separated)","length":500,"mandatory":false,"type":"A"},{"name":"PUSL","description":"lowest status - purchase order","length":2,"mandatory":false,"type":"A"},{"name":"PUST","description":"highest status - purchase order","length":2,"mandatory":false,"type":"A"}],"utilities":[]}},"batches":{}}},"sources":{"f65058ed-dac1-40d1-a9ed-feebcaf6a608":{"uuid":"f65058ed-dac1-40d1-a9ed-feebcaf6a608","updated":1668280625532,"updatedBy":"MALALS01","created":1660746710124,"createdBy":"MALALS01","apiVersion":"0.9","beVersion":"16.0.0.20220817161547","codeHash":"2E3E386E5517A5D5D07802D27EE7BEEEE8B497F05748107201660D184AC9484C","code":"LyoqDQogKiBOYW1lOiBJU1BHZXRQcmNoc2VPcmQNCiAqIFR5cGUgOiBFeHRlbmRNM0FQSQ0KICogRGVzY3JpcHRpb246IFNlbmQgTTMgUHVyY2hhc2Ugb3JkZXIgZGV0YWlscyAoTGluZSBkZXRhaWxzLGNoYXJnZSBkZXRhaWxzLCBpdGVtIGRldGFpbHMsc3VwcGxpZXIgZGV0YWlscykNCiAqICoNCiAqIENyZWF0ZWQgQnk6IEFwZXggc3lzdGVtcw0KICogQXV0aG9yOiBTaGFzaGFuayBNYWxhbGksIEFuZ2hlbG8gRmVybmFuZGV6DQogKg0KICogSGlzdG9yeQ0KICogMjcgSnVseSAyMDIxIENoYW5nZSBpbiBQTyBzdGF0dXMgY29uZGl0aW9uIGluICBQTyBoZWFkZXIgcmVjb3JkcyANCiAqIDA2IEp1bHkgMjAyMiBTaGFzaGFuayBNYWxhbGkgLSBBZGRlZC9tb2RpZmllZCB0aGUgbG9naWMgb2YgdGhlIGNvbmZpcm1lZCBwdXJjaGFzZSBwcmljZSB3aXRoIGRpc2NvdW50cw0KICogMjAyMi0xMS0xMiBDb2RlIGNsZWFuIHVwDQogKi8NCg0KaW1wb3J0IGdyb292eS5qc29uLio7DQppbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTsNCmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0dGVyOw0KaW1wb3J0IGphdmEudGV4dC5EZWNpbWFsRm9ybWF0Ow0KaW1wb3J0IGphdmEubGFuZy5Eb3VibGU7DQppbXBvcnQgamF2YS5sYW5nLkludGVnZXI7DQppbXBvcnQgamF2YS5tYXRoLio7DQoNCnB1YmxpYyBjbGFzcyBJU1BHZXRQcmNoc2VPcmQgZXh0ZW5kcyBFeHRlbmRNM1RyYW5zYWN0aW9uIHsNCiAgcHJpdmF0ZSBmaW5hbCBNSUFQSSBtaTsNCiAgcHJpdmF0ZSBmaW5hbCBNSUNhbGxlckFQSSBtaUNhbGxlcjsNCiAgcHJpdmF0ZSBmaW5hbCBMb2dnZXJBUEkgbG9nZ2VyOw0KICBwcml2YXRlIGZpbmFsIFByb2dyYW1BUEkgcHJvZ3JhbTsNCiAgcHJpdmF0ZSBmaW5hbCBEYXRhYmFzZUFQSSBkYXRhYmFzZTsNCiAgcHJpdmF0ZSBmaW5hbCBJb25BUEkgaW9uOw0KICBwcml2YXRlIFN0cmluZyBDT05PID0gIiI7DQogIHByaXZhdGUgU3RyaW5nIFNVTk8gPSAiIjsNCiAgcHJpdmF0ZSBTdHJpbmcgUFVOTyA9ICIiOw0KICBwcml2YXRlIFN0cmluZyBpbnB1dFBVU0wgPSAiIjsNCiAgcHJpdmF0ZSBTdHJpbmcgaW5wdXRQVVNUID0gIiI7DQogIHByaXZhdGUgU3RyaW5nIGNoZWNrUFVTTCA9ICIiOw0KICBwcml2YXRlIFN0cmluZyBjaGVja1BVU1QgPSAiIjsNCiAgcHJpdmF0ZSBTdHJpbmcgY2hlY2tDT0FNID0gIiI7DQogIHByaXZhdGUgU3RyaW5nIGNoZWNrUE9UQyA9ICIiOw0KICBwcml2YXRlIFN0cmluZyBjaGVja1RPUVQgPSAiIjsNCiAgcHJpdmF0ZSBTdHJpbmcgbnVtYmVyT2ZEZWNpbWFscyA9ICIiOw0KICBwcml2YXRlIFN0cmluZyBwcmljZVVuaXRTdGFuZGFyZCA9ICIiOw0KICBwcml2YXRlIFN0cmluZyBleHBvcnRFbXB0eSA9ICIiOw0KICBwcml2YXRlIFN0cmluZyB2YWxpZENoYXJnZVR5cGVzID0gIiI7DQogIHByaXZhdGUgU3RyaW5nIGZpeGVkQ2hhcmdlVHlwZXMgPSAiIjsNCiAgcHJpdmF0ZSBBcnJheUxpc3QgPCBTdHJpbmcgPiB2YWxpZFB1cmNoYXNlT3JkZXJMaXN0ID0gbnVsbDsNCiAgcHJpdmF0ZSBBcnJheUxpc3QgPCBTdHJpbmcgPiB0ZW1wUFVOTyA9IG51bGw7DQogIHByaXZhdGUgQXJyYXlMaXN0IDwgSGFzaHRhYmxlID4gY2hhcmdlTGlzdCA9IG51bGw7DQogIHByaXZhdGUgQXJyYXlMaXN0IDwgSGFzaHRhYmxlID4gbGluZUxpc3QgPSBudWxsOw0KICBwcml2YXRlIEFycmF5TGlzdCA8IEhhc2h0YWJsZSA+IGxpbmVSZWNlaXB0TGlzdCA9IG51bGw7DQogIHByaXZhdGUgQXJyYXlMaXN0IDwgSGFzaHRhYmxlID4gb3BlbkxpbmVSZWNlaXB0TGlzdCA9IG51bGw7DQogIHByaXZhdGUgQXJyYXlMaXN0IDwgSGFzaHRhYmxlID4gbGluZUNoYXJnZVJlY2VpcHRMaXN0ID0gbnVsbDsNCiAgcHJpdmF0ZSBBcnJheUxpc3QgPCBIYXNodGFibGUgPiBsaW5lT3BlbkNoYXJnZVJlY2VpcHRMaXN0ID0gbnVsbDsNCiAgcHJpdmF0ZSBBcnJheUxpc3QgPCBIYXNodGFibGUgPiB0ZW1wTGluZUNoYXJnZUxpc3QgPSBudWxsOw0KICBwcml2YXRlIEFycmF5TGlzdCA8IEhhc2h0YWJsZSA+IExpbmVDaGFyZ2VMaXN0ID0gbnVsbDsNCiAgcHJpdmF0ZSBTdHJpbmcgb0RJVkkgPSAiIiwgb0ZBQ0kgPSAiIiwgb1dITE8gPSAiIiwgb1BVTk8gPSAiIiwgb1NVTk8gPSAiIiwgb1NVTk0gPSAiIiwgb1JFTk0gPSAiIiwgb0JVWUUgPSAiIiwgb09SVFkgPSAiIjsNCiAgcHJpdmF0ZSBTdHJpbmcgb0NTQ0QgPSAiIiwgb0NVQ0QgPSAiIiwgb0RBVEUgPSAiIiwgb1BVRFQgPSAiIiwgb0RXRFQgPSAiIiwgb1lSRTEgPSAiIiwgb1BITk8gPSAiIiwgb1RGTk8gPSAiIjsNCiAgcHJpdmF0ZSBTdHJpbmcgb1JFTUsgPSAiIiwgb09SVEsgPSAiIiwgb0NPQU0gPSAiIiwgb1RPUVQgPSAiIiwgb01PREwgPSAiIiwgb1RFUFkgPSAiIiwgb1RFUEEgPSAiIiwgb1RFTDEgPSAiIiwgb1BVU0wgPSAiIiwgb1BVU1QgPSAiIjsNCiAgcHJpdmF0ZSBTdHJpbmcgb0RNQ1UgPSAiIiwgb1RFREwgPSAiIjsNCiAgLy9wcml2YXRlIFN0cmluZyBjUE5MST0iIixjUE5MUz0iIiwgY0NEU0U9IiIsY1JFUE49IiIsIGNFWFRZPSIiLCBjQ0VJRD0iIiwgY0VYSVA9IiIsIGNXU09QPSIiLCBjQ1VDRD0iIiwgY0NFVkE9IiIsIGNDRVZKPSIiLCBjVEhQUj0iIiwgY0lWQ1E9IiI7DQogIHByaXZhdGUgU3RyaW5nIFByaWNlVU1fRENDRCA9ICIiLCBQcmljZVVNX0RNQ0YgPSAiIiwgUHJpY2VVTV9DT0ZBID0gIiIsIE9yZGVyVU1fRENDRCA9ICIiLCBPcmRlclVNX0RNQ0YgPSAiIiwgT3JkZXJVTV9DT0ZBID0gIiIsIEJhc2ljVU1fRENDRCA9ICIiLCBQT1BOX0VBMTMgPSAiIiwgSVZRVCA9ICIiLCBlYWNoTGluZVBVVU4gPSAiIiwgZWFjaExpbmVQUFVOID0gIiI7DQogIHByaXZhdGUgU3RyaW5nIE9yZGVyZWRRdWFudGl0eVByaWNlVU0sIFJlY2VpdmVkUXVhbnRpdHlQcmljZVVNLCBJbnZvaWNlZFF1YW50aXR5UHJpY2VVTSwgT3BlblF1YW50aXR5UHJpY2VVTSwgT3BlblF1YW50aXR5T3JkZXJVTSwgQW1vdW50T3BlbiwgUHJpY2VQZXJQaWVjZVByaWNlVU0sIFByaWNlUGVyUGllY2VPcmRlclVNOw0KICBwcml2YXRlIFN0cmluZyBQcmljZVBlclBpZWNlU3RhbmRhcmRVTSwgT3BlblF1YW50aXR5U3RhbmRhcmRVTSwgSW52b2ljZWRRdWFudGl0eVN0YW5kYXJkVU0sIE9yZGVyZWRRdWFudGl0eVN0YW5kYXJkVU0sIFJlY2VpdmVkUXVhbnRpdHlTdGFuZGFyZFVNLCBBbHRlcm5hdGl2ZVF1YW50aXR5T3BlbiwgQWx0ZXJuYXRpdmVQcmljZTsNCiAgcHJpdmF0ZSBTdHJpbmcgQVVUUF9hID0gIiIsIFJlY2VpdmVkUXVhbnRpdHlPcmRlclVNID0gIiIsIFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5ID0gIiIsIEFtb3VudFJlY2VpdmVkUHJpY2VVTSA9ICIiLCBBbW91bnRPcGVuUHJpY2VVTSA9ICIiLCBBbW91bnRPcGVuT3JkZXJVTSA9ICIiOw0KICBwcml2YXRlIGJvb2xlYW4gaXNFbmRPZkZpbGUgPSBmYWxzZTsNCiAgcHJpdmF0ZSBEb3VibGUgZENQUFIgPSAwLjBkOw0KDQogIHB1YmxpYyBJU1BHZXRQcmNoc2VPcmQoTUlBUEkgbWksIE1JQ2FsbGVyQVBJIG1pQ2FsbGVyLCBQcm9ncmFtQVBJIHByb2dyYW0sIERhdGFiYXNlQVBJIGRhdGFiYXNlLCBJb25BUEkgaW9uLCBMb2dnZXJBUEkgbG9nZ2VyKSB7DQogICAgdGhpcy5taSA9IG1pOw0KICAgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW07DQogICAgdGhpcy5taUNhbGxlciA9IG1pQ2FsbGVyOw0KICAgIHRoaXMubG9nZ2VyID0gbG9nZ2VyOw0KICAgIHRoaXMuZGF0YWJhc2UgPSBkYXRhYmFzZTsNCiAgICB0aGlzLmlvbiA9IGlvbjsNCiAgfQ0KDQogIHB1YmxpYyB2b2lkIG1haW4oKSB7DQogICAgZ2V0Q29udHJvbFByb3BlcnRpZXMoKTsNCiAgICB2YWxpZFB1cmNoYXNlT3JkZXJMaXN0ID0gbmV3IEFycmF5TGlzdCA8IFN0cmluZyA+ICgpOw0KICAgIENPTk8gPSBwcm9ncmFtLkxEQVpELmdldCgnQ09OTycpOw0KICAgIFNVTk8gPSBtaS5pbkRhdGEuZ2V0KCdTVU5PJyk7DQogICAgUFVOTyA9IG1pLmluRGF0YS5nZXQoJ1BVTk8nKTsNCiAgICBpbnB1dFBVU0wgPSBtaS5pbkRhdGEuZ2V0KCdQVVNMJyk7DQogICAgaW5wdXRQVVNUID0gbWkuaW5EYXRhLmdldCgnUFVTVCcpOw0KICAgIGlmIChpbnB1dFBVU0wgPT0gbnVsbCB8fCBpbnB1dFBVU0wudHJpbSgpLmlzRW1wdHkoKSkgew0KICAgICAgaW5wdXRQVVNMID0gIjAiOw0KICAgIH0NCiAgICBpZiAoaW5wdXRQVVNUID09IG51bGwgfHwgaW5wdXRQVVNULnRyaW0oKS5pc0VtcHR5KCkpIHsNCiAgICAgIGlucHV0UFVTVCA9ICIxMDAiOw0KICAgIH0NCiAgICBpbnQgb3JkZXJBcnJheUxlbmd0aCA9IDA7DQogICAgaWYgKCFQVU5PLnRyaW0oKS5pc0VtcHR5KCkgJiYgU1VOTy50cmltKCkuaXNFbXB0eSgpKSB7DQogICAgICBTdHJpbmdbXSBvcmRlckFycmF5ID0gUFVOTy5zcGxpdCgnOycpOw0KICAgICAgb3JkZXJBcnJheUxlbmd0aCA9IG9yZGVyQXJyYXkubGVuZ3RoOw0KICAgICAgb3JkZXJBcnJheS5lYWNoIHsNCiAgICAgICAgdmFsdWUgLT4NCiAgICAgICAgICBTdHJpbmcgZWFjaFBVTk8gPSB2YWx1ZTsNCg0KICAgICAgICBnZXRIZWFkQmFzaWMoZWFjaFBVTk8pOw0KICAgICAgICBnZXRIZWFkKGVhY2hQVU5PKTsNCiAgICAgICAgLy8gIGJvb2xlYW4gaXNWYWxpZFBVTk8gPSB2YWxpZGF0ZVBVTk8oKTsgLy8gQ09NTUVOVEVEIEZPUiBURVNUSU5HDQogICAgICAgIC8vICBpZihpc1ZhbGlkUFVOTyl7IC8vIENPTU1FTlRFRCBGT1IgVEVTVElORw0KICAgICAgICB2YWxpZFB1cmNoYXNlT3JkZXJMaXN0LmFkZChlYWNoUFVOTy50cmltKCkpOw0KICAgICAgICAvLyAgfS8vIENPTU1FTlRFRCBGT1IgVEVTVElORw0KICAgICAgfQ0KDQogICAgfSBlbHNlIGlmICghU1VOTy50cmltKCkuaXNFbXB0eSgpKSB7DQogICAgICBnZXRQdXJjaGFzZU9yZGVyRm9yU3VwcGxpZXIoKTsNCiAgICB9DQoNCiAgICBpbnQgcHVyY2hhc2VPcmRlckNhcCA9IDA7DQogICAgaWYgKG9yZGVyQXJyYXlMZW5ndGggPT0gMCkgew0KICAgICAgb3JkZXJBcnJheUxlbmd0aCA9IDUwOw0KICAgIH0NCiAgICBpZiAodmFsaWRQdXJjaGFzZU9yZGVyTGlzdC5zaXplID4gMTAwKSB7DQogICAgICB2YWxpZFB1cmNoYXNlT3JkZXJMaXN0LnNpemUgPSAxMDA7DQogICAgfQ0KICAgIGlmICh2YWxpZFB1cmNoYXNlT3JkZXJMaXN0LnNpemUgPCA1MCkgew0KICAgICAgaXNFbmRPZkZpbGUgPSB0cnVlOw0KICAgIH0NCiAgICB2YWxpZFB1cmNoYXNlT3JkZXJMaXN0LmVhY2ggew0KICAgICAgdmFsdWUgLT4NCiAgICAgICAgU3RyaW5nIGVhY2hQVU5PID0gdmFsdWU7DQogICAgICBjbGVhclBPSGVhZGVyRmllbGRzKCk7DQogICAgICBib29sZWFuIHJlY29yZEZvdW5kID0gZ2V0T3JkZXJEZXRhaWxzKGVhY2hQVU5PLnRyaW0oKSk7DQogICAgICBnZXRQT1N0YXR1cyhlYWNoUFVOTy50cmltKCkpOw0KICAgICAgZ2V0Q3VycmVuY3lDb252ZXJzaW9uKG9ESVZJLnRyaW0oKSk7DQogICAgICBnZXRTdXBwbGllck5hbWUob1NVTk8udHJpbSgpKTsNCiAgICAgIGlmIChyZWNvcmRGb3VuZCAmJiBwdXJjaGFzZU9yZGVyQ2FwIDwgb3JkZXJBcnJheUxlbmd0aCkgew0KICAgICAgICBwdXJjaGFzZU9yZGVyQ2FwKys7DQogICAgICAgIHdyaXRlUHVyY2hhc2VPcmRlcigpOw0KICAgICAgICBnZXRDaGFyZ2VzKGVhY2hQVU5PLnRyaW0oKSk7DQogICAgICAgIGNoYXJnZUxpc3QuZWFjaCB7DQogICAgICAgICAgdmFsdWUxIC0+DQogICAgICAgICAgICBIYXNodGFibGUgZWFjaENoYXJnZSA9IHZhbHVlMTsNCiAgICAgICAgICB3cml0ZUNoYXJnZXMoZWFjaFBVTk8sIGVhY2hDaGFyZ2UpOw0KICAgICAgICB9DQoNCiAgICAgICAgZ2V0TGluZURldGFpbHMoZWFjaFBVTk8pOw0KICAgICAgICBsaW5lTGlzdC5lYWNoIHsNCiAgICAgICAgICB2YWx1ZTIgLT4NCiAgICAgICAgICAgIEhhc2h0YWJsZSBlYWNoTGluZSA9IHZhbHVlMjsNCiAgICAgICAgICBnZXRVbml0T2ZNZWFzdXJlbWVudENvbnZlcnNpb24oZWFjaExpbmUpOw0KICAgICAgICAgIGdldEJhc2ljRGVjaW1hbENvZGUoZWFjaExpbmUpOw0KICAgICAgICAgIGdldEl0ZW1BbGlhcyhlYWNoTGluZSk7DQogICAgICAgICAgZ2V0TVBMSU5FRGV0YWlscyhlYWNoUFVOTywgZWFjaExpbmUpOw0KICAgICAgICAgIHVzZUNQUFJJZkF2YWlsYWJsZShlYWNoTGluZSk7DQogICAgICAgICAgY2hlY2tPcmRlclByaWNlQW5kQmFzZVVuaXRzKGVhY2hMaW5lKQ0KICAgICAgICAgIHdyaXRlUHVyY2hhc2VMaW5lKGVhY2hQVU5PLCBlYWNoTGluZSk7DQogICAgICAgICAgZ2V0TGluZVJlY2VpcHRzKGVhY2hQVU5PLCBlYWNoTGluZSk7DQogICAgICAgICAgb3BlbkxpbmVSZWNlaXB0TGlzdCA9IG5ldyBBcnJheUxpc3QgPCBIYXNodGFibGUgPiAoKTsNCiAgICAgICAgICBsaW5lUmVjZWlwdExpc3QuZWFjaCB7DQogICAgICAgICAgICBsaW5lUmVjZWlwdCAtPg0KICAgICAgICAgICAgICBIYXNodGFibGUgZWFjaExpbmVSZWNlaXB0ID0gbGluZVJlY2VpcHQ7DQoNCiAgICAgICAgICAgIGNhbGN1bGF0ZVJlY2VpcHRRdWFudGl0aWVzKGVhY2hMaW5lUmVjZWlwdCwgZWFjaExpbmUpOw0KDQogICAgICAgICAgICAvLyAgaWYoaWZPcGVuUmVjZWlwdChlYWNoTGluZVJlY2VpcHQpKXsgLy8gQ09NTUVOVEVEIEZPUiBURVNUSU5HDQogICAgICAgICAgICBvcGVuTGluZVJlY2VpcHRMaXN0LmFkZChlYWNoTGluZVJlY2VpcHQpOw0KICAgICAgICAgICAgLy8gICAgfS8vIENPTU1FTlRFRCBGT1IgVEVTVElORw0KICAgICAgICAgICAgZ2F0aGVyUmVjZWlwdENoYXJnZXMoZWFjaFBVTk8sIGVhY2hMaW5lUmVjZWlwdCwgZWFjaExpbmUpOw0KICAgICAgICAgICAgbGluZU9wZW5DaGFyZ2VSZWNlaXB0TGlzdCA9IG5ldyBBcnJheUxpc3QgPCBIYXNodGFibGUgPiAoKTsNCiAgICAgICAgICAgIGxpbmVDaGFyZ2VSZWNlaXB0TGlzdC5lYWNoIHsNCiAgICAgICAgICAgICAgbGluZUNoYXJnZVJlY2VpcHQgLT4NCiAgICAgICAgICAgICAgICBIYXNodGFibGUgZWFjaExpbmVDaGFyZ2VSZWNlaXB0ID0gbGluZUNoYXJnZVJlY2VpcHQ7DQogICAgICAgICAgICAgIGdldENoYXJnZVRleHQoZWFjaExpbmVDaGFyZ2VSZWNlaXB0KTsNCiAgICAgICAgICAgICAgY2FsY3VsYXRlUmVjZWlwdENoYXJnZVF1YW50aXRpZXMoZWFjaExpbmUsIGVhY2hMaW5lUmVjZWlwdCwgZWFjaExpbmVDaGFyZ2VSZWNlaXB0KTsNCg0KICAgICAgICAgICAgICAvLyAgaWYoaWZSZWNlaXB0Q2hhcmdlT3BlbihlYWNoTGluZUNoYXJnZVJlY2VpcHQpKXsgLy8gQ09NTUVOVEVEIEZPUiBURVNUSU5HDQogICAgICAgICAgICAgIGNoZWNrQ2hhcmdlT3JkZXJQcmljZUFuZEJhc2VVbml0KGVhY2hMaW5lLCBlYWNoTGluZVJlY2VpcHQsIGVhY2hMaW5lQ2hhcmdlUmVjZWlwdCk7DQogICAgICAgICAgICAgIGFkZFRvTGluZU9wZW5DaGFyZ2VSZWNlaXB0TGlzdChlYWNoUFVOTywgZWFjaExpbmUsIGVhY2hMaW5lUmVjZWlwdCwgZWFjaExpbmVDaGFyZ2VSZWNlaXB0KTsNCiAgICAgICAgICAgICAgZ2V0TGluZUNoYXJnZXMoZWFjaFBVTk8sIGVhY2hMaW5lKTsNCiAgICAgICAgICAgICAgdGVtcExpbmVDaGFyZ2VMaXN0LmVhY2ggew0KDQogICAgICAgICAgICAgICAgdGVtcExpbmVDaGFyZ2UgLT4NCiAgICAgICAgICAgICAgICAgIEhhc2h0YWJsZSBlYWNoVGVtcExpbmVDaGFyZ2UgPSB0ZW1wTGluZUNoYXJnZTsNCg0KICAgICAgICAgICAgICAgIGdldExpbmVDaGFyZ2VUZXh0KGVhY2hQVU5PLCB0ZW1wTGluZUNoYXJnZSwgZWFjaExpbmUpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIC8vICAgfS8vIENPTU1FTlRFRCBGT1IgVEVTVElORw0KDQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAgIG9wZW5MaW5lUmVjZWlwdExpc3QuZWFjaCB7DQogICAgICAgICAgICBvcGVuTGluZVJlY2VpcHQgLT4NCiAgICAgICAgICAgICAgSGFzaHRhYmxlIGVhY2hPcGVuTGluZVJlY2VpcHQgPSBvcGVuTGluZVJlY2VpcHQ7DQogICAgICAgICAgICB3cml0ZVJlY2VpcHRzKGVhY2hQVU5PLCBlYWNoT3BlbkxpbmVSZWNlaXB0LCBlYWNoTGluZSk7DQogICAgICAgICAgfQ0KICAgICAgICAgIExpbmVDaGFyZ2VMaXN0LmVhY2ggew0KICAgICAgICAgICAgbGluZUNoYXJnZSAtPg0KICAgICAgICAgICAgICBIYXNodGFibGUgZWFjaExpbmVDaGFyZ2UgPSBsaW5lQ2hhcmdlOw0KICAgICAgICAgICAgd3JpdGVMaW5lQ2hhcmdlcyhlYWNoUFVOTywgZWFjaExpbmVDaGFyZ2UsIGVhY2hMaW5lKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgfQ0KICAgIGlmIChpc0VuZE9mRmlsZSkgew0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JDVFAnLCAnTCcpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BVTk8nLCAnJSVFT0YlJScpOw0KICAgICAgbWkud3JpdGUoKTsNCiAgICB9DQogIH0NCg0KICAvKiByZXRyaXZlIHRoZSBjb250cm9sIHByb3BlcnRpZXMgZnJvbSBDVUdFWDENCiAgICovDQoNCiAgcHVibGljIGdldENvbnRyb2xQcm9wZXJ0aWVzKCkgew0KICAgIGJvb2xlYW4gcmVjb3JkRXhpc3RzID0gdHJ1ZTsNCiAgICBkZWYgY2FsbGJhY2sgPSB7DQogICAgICBNYXAgPCBTdHJpbmcsDQogICAgICBTdHJpbmcgPiByZXN1bHRzIC0+DQogICAgICByZWNvcmRFeGlzdHMgPSAhcmVzdWx0cy5nZXQoJ2Vycm9yJyk7DQogICAgICBpZiAocmVjb3JkRXhpc3RzKSB7DQogICAgICAgIG51bWJlck9mRGVjaW1hbHMgPSByZXN1bHRzLmdldCgnQTEyMScpOw0KDQogICAgICB9IGVsc2Ugew0KICAgICAgICBtaS5lcnJvcigiUGxlYXNlIG1haW50YWluIHJlY29yZCBpbiBDVUdFWDEgZm9yIE5PT0ZERUNJTUFMUyIpOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgfQ0KICAgIGRlZiBwYXJhbXMgPSBbIkZJTEUiOiAiSVNQRklMRSIsICJQSzAxIjogIkdFVFBVUkNIQVNFT1JERVIiLCAiUEswMiI6ICJOT09GREVDSU1BTFMiXTsNCiAgICBtaUNhbGxlci5jYWxsKCJDVVNFWFRNSSIsICJHZXRGaWVsZFZhbHVlIiwgcGFyYW1zLCBjYWxsYmFjayk7DQoNCiAgICBkZWYgY2FsbGJhY2syID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICBwcmljZVVuaXRTdGFuZGFyZCA9IHJlc3VsdHMuZ2V0KCdBMTIxJyk7DQoNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1pLmVycm9yKCJQbGVhc2UgbWFpbnRhaW4gcmVjb3JkIGluIENVR0VYMSBmb3IgUFJJQ0VVTklUU1RBTkRBUkQiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgIH0NCiAgICBkZWYgcGFyYW1zMiA9IFsiRklMRSI6ICJJU1BGSUxFIiwgIlBLMDEiOiAiR0VUUFVSQ0hBU0VPUkRFUiIsICJQSzAyIjogIlBSSUNFVU5JVFNUQU5EQVJEIl07DQogICAgbWlDYWxsZXIuY2FsbCgiQ1VTRVhUTUkiLCAiR2V0RmllbGRWYWx1ZSIsIHBhcmFtczIsIGNhbGxiYWNrMik7DQoNCiAgICBkZWYgY2FsbGJhY2szID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICBleHBvcnRFbXB0eSA9IHJlc3VsdHMuZ2V0KCdBMTIxJyk7DQoNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1pLmVycm9yKCJQbGVhc2UgbWFpbnRhaW4gcmVjb3JkIGluIENVR0VYMSBmb3IgRVhQT1JURU1QVFkiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgIH0NCiAgICBkZWYgcGFyYW1zMyA9IFsiRklMRSI6ICJJU1BGSUxFIiwgIlBLMDEiOiAiR0VUUFVSQ0hBU0VPUkRFUiIsICJQSzAyIjogIkVYUE9SVEVNUFRZIl07DQogICAgbWlDYWxsZXIuY2FsbCgiQ1VTRVhUTUkiLCAiR2V0RmllbGRWYWx1ZSIsIHBhcmFtczMsIGNhbGxiYWNrMyk7DQoNCiAgICBkZWYgY2FsbGJhY2s0ID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICB2YWxpZENoYXJnZVR5cGVzID0gcmVzdWx0cy5nZXQoJ0ExMjEnKTsNCg0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgbWkuZXJyb3IoIlBsZWFzZSBtYWludGFpbiByZWNvcmQgaW4gQ1VHRVgxIGZvciBDSEFSR0VUWVBFIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICB9DQogICAgZGVmIHBhcmFtczQgPSBbIkZJTEUiOiAiSVNQRklMRSIsICJQSzAxIjogIkdFVFBVUkNIQVNFT1JERVIiLCAiUEswMiI6ICJDSEFSR0VUWVBFIl07DQogICAgbWlDYWxsZXIuY2FsbCgiQ1VTRVhUTUkiLCAiR2V0RmllbGRWYWx1ZSIsIHBhcmFtczQsIGNhbGxiYWNrNCk7DQoNCiAgICBkZWYgY2FsbGJhY2s1ID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICBmaXhlZENoYXJnZVR5cGVzID0gcmVzdWx0cy5nZXQoJ0ExMjEnKTsNCg0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgbWkuZXJyb3IoIlBsZWFzZSBtYWludGFpbiByZWNvcmQgaW4gQ1VHRVgxIGZvciBDSEFSR0VUWVBFIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICB9DQogICAgZGVmIHBhcmFtczUgPSBbIkZJTEUiOiAiSVNQRklMRSIsICJQSzAxIjogIkdFVFBVUkNIQVNFT1JERVIiLCAiUEswMiI6ICJGSVhFRENIQVJHRVRZUEUiXTsNCiAgICBtaUNhbGxlci5jYWxsKCJDVVNFWFRNSSIsICJHZXRGaWVsZFZhbHVlIiwgcGFyYW1zNSwgY2FsbGJhY2s1KTsNCg0KICB9DQoNCiAgLyogY2xlYXIgbG9jYWwgdmVyaWFibGVzDQogICAqLw0KICBwdWJsaWMgY2xlYXJQT0hlYWRlckZpZWxkcygpIHsNCiAgICBvUFVOTyA9ICIiOw0KICAgIG9EQVRFID0gIiI7DQogICAgb1BVRFQgPSAiIjsNCiAgICBvRFdEVCA9ICIiOw0KICAgIG9SRU5NID0gIiI7DQogICAgb1NVTk8gPSAiIjsNCiAgICBvQ1NDRCA9ICIiOw0KICAgIG9CVVlFID0gIiI7DQogICAgb0NVQ0QgPSAiIjsNCiAgICBvWVJFMSA9ICIiOw0KICAgIG9QSE5PID0gIiI7DQogICAgb1RGTk8gPSAiIjsNCiAgICBvUkVNSyA9ICIiOw0KICAgIG9DT0FNID0gIiI7DQogICAgb0RJVkkgPSAiIjsNCiAgICBvRkFDSSA9ICIiOw0KICAgIG9XSExPID0gIiI7DQogICAgb09SVFkgPSAiIjsNCiAgICBvVEVQWSA9ICIiOw0KICAgIG9NT0RMID0gIiI7DQogICAgb1RFUEEgPSAiIjsNCiAgICBvVEVETCA9ICIiOw0KICAgIG9URUwxID0gIiI7DQogICAgb1RPUVQgPSAiIjsNCiAgICBvRE1DVSA9ICIiOw0KICAgIG9TVU5NID0gIiI7DQogIH0NCg0KICAvKiBnZXQgUHVyY2hhc2Ugb3JkZXIgYmFzaWMgZGF0YWJhc2UgdXNpbmcgUFBTMDAxTUkuR2V0SGVhZEJhc2ljDQogICAqLw0KICBwdWJsaWMgZ2V0SGVhZEJhc2ljKFN0cmluZyBQVU5PKSB7DQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgY2hlY2tQVVNMID0gcmVzdWx0cy5nZXQoJ1BVU0wnKTsNCiAgICAgICAgY2hlY2tQVVNUID0gcmVzdWx0cy5nZXQoJ1BVU1QnKTsNCiAgICAgIH0NCiAgICB9DQogICAgZGVmIHBhcmFtcyA9IFsiQ09OTyI6IENPTk8sICJQVU5PIjogUFVOT107DQogICAgbWlDYWxsZXIuY2FsbCgiUFBTMDAxTUkiLCAiR2V0SGVhZEJhc2ljIiwgcGFyYW1zLCBjYWxsYmFjayk7DQogIH0NCg0KICAvKiBnZXQgcHVyY2hhc2Ugb3JkZXIgc3RhdHVzIHVzaW5nIFBQUzAwMU1JLkdldEhlYWRCYXNpYw0KICAgKi8NCiAgcHVibGljIGdldFBPU3RhdHVzKFN0cmluZyBQVU5PKSB7DQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCg0KICAgICAgICBvUFVTTCA9IHJlc3VsdHMuZ2V0KCdQVVNMJyk7DQogICAgICAgIG9QVVNUID0gcmVzdWx0cy5nZXQoJ1BVU1QnKTsNCg0KICAgICAgfQ0KICAgIH0NCiAgICBkZWYgcGFyYW1zID0gWyJDT05PIjogQ09OTywgIlBVTk8iOiBQVU5PXTsNCiAgICBtaUNhbGxlci5jYWxsKCJQUFMwMDFNSSIsICJHZXRIZWFkQmFzaWMiLCBwYXJhbXMsIGNhbGxiYWNrKTsNCiAgfQ0KDQogIC8qIGdldCBwdXJjaGFzZSBvcmRlciBhZGRpdGlvbmFsIGRldGFpbHMgZnJvbSB0YWJsZSBNUEhFQUQNCiAgICovDQoNCiAgcHVibGljIGdldEhlYWQoU3RyaW5nIGVhY2hQVU5PKSB7DQoNCiAgICBpbnQgY3VycmVudENvbXBhbnkgPSAoSW50ZWdlcikgcHJvZ3JhbS5nZXRMREFaRCgpLkNPTk87DQogICAgREJBY3Rpb24gcXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiTVBIRUFEIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJJQUNPTk8iLCAiSUFQVU5PIiwgIklBQ09BTSIsICJJQVBPVEMiLCAiSUFUT1FUIikuYnVpbGQoKTsNCiAgICBEQkNvbnRhaW5lciBjb250YWluZXIgPSBxdWVyeS5nZXRDb250YWluZXIoKTsNCiAgICBjb250YWluZXIuc2V0KCJJQUNPTk8iLCBjdXJyZW50Q29tcGFueSk7DQogICAgY29udGFpbmVyLnNldCgiSUFQVU5PIiwgZWFjaFBVTk8pOw0KDQogICAgaWYgKHF1ZXJ5LnJlYWQoY29udGFpbmVyKSkgew0KICAgICAgY2hlY2tDT0FNID0gY29udGFpbmVyLmdldCgiSUFDT0FNIik7DQogICAgICBjaGVja1BPVEMgPSBjb250YWluZXIuZ2V0KCJJQVBPVEMiKTsNCiAgICAgIGNoZWNrVE9RVCA9IGNvbnRhaW5lci5nZXQoIklBVE9RVCIpOw0KICAgIH0NCiAgfQ0KDQogIC8qIHZhbGlkYXRlIHB1cmNoYXNlIG9yZGVyIG51bWJlcg0KICAgKi8NCiAgcHVibGljIGJvb2xlYW4gdmFsaWRhdGVQVU5PKCkgew0KICAgIGNoZWNrQ09BTSA9IGNoZWNrQ09BTS5lcXVhbHMoIiIpID8gIjAiIDogY2hlY2tDT0FNOw0KICAgIGNoZWNrVE9RVCA9IGNoZWNrVE9RVC5lcXVhbHMoIiIpID8gIjAiIDogY2hlY2tUT1FUOw0KDQogICAgQmlnRGVjaW1hbCB0b3RhbEFtb3VudCA9IG5ldyBCaWdEZWNpbWFsKGNoZWNrQ09BTSk7DQogICAgQmlnRGVjaW1hbCB0b3RhbFF1YW50aXR5ID0gbmV3IEJpZ0RlY2ltYWwoY2hlY2tUT1FUKTsNCg0KICAgIGJvb2xlYW4gaGFzQW1vdW50ID0gdG90YWxBbW91bnQuY29tcGFyZVRvKEJpZ0RlY2ltYWwuWkVSTykgIT0gMDsNCiAgICBib29sZWFuIGhhc1F1YW50aXR5ID0gdG90YWxRdWFudGl0eS5jb21wYXJlVG8oQmlnRGVjaW1hbC5aRVJPKSAhPSAwOw0KDQogICAgYm9vbGVhbiBoYXNBbW91bnRPclF1YW50aXR5ID0gaGFzQW1vdW50IHx8IGhhc1F1YW50aXR5Ow0KDQogICAgaWYgKGNoZWNrUE9UQy5lcXVhbHMoIjMwIikgfHwgY2hlY2tQT1RDLmVxdWFscygiNDAiKSkgew0KICAgICAgcmV0dXJuIGNoZWNrUFVTTC50b0ludGVnZXIoKSA8PSAzMCAmJiBjaGVja1BVU1QudG9JbnRlZ2VyKCkgPj0gMTU7DQogICAgfSBlbHNlIHsNCiAgICAgIHJldHVybiAoY2hlY2tQVVNMLnRvSW50ZWdlcigpIDw9IGlucHV0UFVTVC50b0ludGVnZXIoKSAmJiBjaGVja1BVU1QudG9JbnRlZ2VyKCkgPj0gaW5wdXRQVVNMLnRvSW50ZWdlcigpKSAmJiAoY2hlY2tQVVNMLnRvSW50ZWdlcigpIDwgODUpICYmIGhhc0Ftb3VudE9yUXVhbnRpdHk7DQogICAgfQ0KICB9DQoNCiAgLyogcmV0cml2ZSBQdXJjaGFzZSBvcmRlciBzdXBwbGllciBudW1iZXIgZnJvbSBNUEhFQUQNCiAgICovDQogIHB1YmxpYyBnZXRQdXJjaGFzZU9yZGVyRm9yU3VwcGxpZXIoKSB7DQogICAgREJBY3Rpb24gcXVlcnlNUEhFQUQgPSBkYXRhYmFzZS50YWJsZSgiTVBIRUFEIikuaW5kZXgoIjQwIikuc2VsZWN0aW9uKCJJQVBVTk8iLCAiSUFDT05PIiwgIklBU1VOTyIsICJJQVBVU0wiLCAiSUFQVVNUIiwgIklBUE9UQyIsICJJQVRPUVQiLCAiSUFDT0FNIikuYnVpbGQoKTsNCiAgICBpZiAoIVBVTk8udHJpbSgpLmlzRW1wdHkoKSAmJiAhU1VOTy50cmltKCkuaXNFbXB0eSgpKSB7DQogICAgICBFeHByZXNzaW9uRmFjdG9yeSBleHByZXNzaW9uID0gZGF0YWJhc2UuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoIk1QSEVBRCIpOw0KICAgICAgaWYgKCFQVU5PLmNvbnRhaW5zKCc7JykpIHsNCiAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZ3QoIklBUFVOTyIsIFBVTk8udHJpbSgpKTsNCiAgICAgICAgcXVlcnlNUEhFQUQgPSBkYXRhYmFzZS50YWJsZSgiTVBIRUFEIikuaW5kZXgoIjQwIikubWF0Y2hpbmcoZXhwcmVzc2lvbikuc2VsZWN0aW9uKCJJQVBVTk8iLCAiSUFDT05PIiwgIklBU1VOTyIsICJJQVBVU0wiLCAiSUFQVVNUIiwgIklBUE9UQyIsICJJQVRPUVQiLCAiSUFDT0FNIikuYnVpbGQoKTsNCiAgICAgIH0NCg0KICAgIH0NCg0KICAgIERCQ29udGFpbmVyIHJlY29yZE1QSEVBRCA9IHF1ZXJ5TVBIRUFELmdldENvbnRhaW5lcigpOw0KICAgIHJlY29yZE1QSEVBRC5zZXQoIklBQ09OTyIsIEludGVnZXIucGFyc2VJbnQoQ09OTy50cmltKCkpKTsNCiAgICByZWNvcmRNUEhFQUQuc2V0KCJJQVNVTk8iLCBTVU5PLnRyaW0oKSk7DQogICAgLy8gcmVhZCBsb2NrIGFuZCBjYWxsIGNyZWF0ZVJlY29yZHMoKQ0KICAgIGludCByZWFkcyA9IHF1ZXJ5TVBIRUFELnJlYWRBbGwocmVjb3JkTVBIRUFELCAyLCBnZXRNUEhFQURSZWNvcmRzKTsNCg0KICB9DQoNCiAgQ2xvc3VyZSA8ID8gPiBnZXRNUEhFQURSZWNvcmRzID0gew0KICAgIERCQ29udGFpbmVyIHJlY29yZCAtPg0KICAgIFN0cmluZyBQVU5PID0gcmVjb3JkLmdldCgiSUFQVU5PIikgPT0gbnVsbCA/ICIiIDogcmVjb3JkLmdldCgiSUFQVU5PIik7DQogICAgY2hlY2tQVVNMID0gcmVjb3JkLmdldCgnSUFQVVNMJykgPT0gbnVsbCA/ICIwMCIgOiByZWNvcmQuZ2V0KCdJQVBVU0wnKTsNCiAgICBjaGVja1BVU1QgPSByZWNvcmQuZ2V0KCdJQVBVU1QnKSA9PSBudWxsID8gIjAwIiA6IHJlY29yZC5nZXQoJ0lBUFVTVCcpOw0KICAgIGNoZWNrUE9UQyA9IHJlY29yZC5nZXQoIklBUE9UQyIpID09IG51bGwgPyAiIiA6IHJlY29yZC5nZXQoJ0lBUE9UQycpOw0KICAgIGNoZWNrVE9RVCA9IHJlY29yZC5nZXQoIklBVE9RVCIpID09IG51bGwgPyAiIiA6IHJlY29yZC5nZXQoJ0lBVE9RVCcpOw0KICAgIGNoZWNrQ09BTSA9IHJlY29yZC5nZXQoJ0lBQ09BTScpID09IG51bGwgPyAiMCIgOiByZWNvcmQuZ2V0KCdJQUNPQU0nKTsNCiAgICBib29sZWFuIGlzVmFsaWRQVU5PID0gdmFsaWRhdGVQVU5PKCk7DQogICAgaWYgKGlzVmFsaWRQVU5PKSB7DQogICAgICB2YWxpZFB1cmNoYXNlT3JkZXJMaXN0LmFkZChQVU5PLnRyaW0oKSk7DQogICAgfSBlbHNlIHsNCiAgICAgIHZhbGlkUHVyY2hhc2VPcmRlckxpc3QuYWRkKFBVTk8udHJpbSgpKTsNCiAgICB9DQoNCiAgfQ0KDQogIC8qIHJldHJpdmUgcHVyY2hhc2Ugb3JkZXIgZGV0YWlscyBmcm9tIE1QSEVBRA0KICAgKi8NCiAgcHVibGljIGJvb2xlYW4gZ2V0T3JkZXJEZXRhaWxzKFN0cmluZyBlYWNoUFVOTykgew0KDQogICAgYm9vbGVhbiByZWNvcmRGb3VuZCA9IGZhbHNlOw0KICAgIGludCBjdXJyZW50Q29tcGFueSA9IChJbnRlZ2VyKSBwcm9ncmFtLmdldExEQVpEKCkuQ09OTzsNCiAgICBEQkFjdGlvbiBxdWVyeSA9IGRhdGFiYXNlLnRhYmxlKCJNUEhFQUQiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIklBQ09OTyIsICJJQVBVTk8iLCAiSUFQVURUIiwgIklBRFdEVCIsICJJQVNVTk8iLCAiSUFCVVlFIiwgIklBQ1VDRCIsICJJQVlSRTEiLCAiSUFURk5PIiwgIklBQ09BTSIsICJJQURJVkkiLCAiSUFGQUNJIiwgIklBV0hMTyIsICJJQU9SVFkiLCAiSUFURVBZIiwgIklBTU9ETCIsICJJQVRFUEEiLCAiSUFURURMIiwgIklBVEVMMSIsICJJQVRPUVQiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmdldENvbnRhaW5lcigpOw0KICAgIGNvbnRhaW5lci5zZXQoIklBQ09OTyIsIGN1cnJlbnRDb21wYW55KTsNCiAgICBjb250YWluZXIuc2V0KCJJQVBVTk8iLCBlYWNoUFVOTyk7DQoNCiAgICBpZiAocXVlcnkucmVhZChjb250YWluZXIpKSB7DQogICAgICByZWNvcmRGb3VuZCA9IHRydWU7DQogICAgICBvUFVOTyA9IGNvbnRhaW5lci5nZXQoJ0lBUFVOTycpOw0KICAgICAgb1BVRFQgPSBjb250YWluZXIuZ2V0KCdJQVBVRFQnKTsNCiAgICAgIG9EV0RUID0gY29udGFpbmVyLmdldCgnSUFEV0RUJyk7DQogICAgICBvU1VOTyA9IGNvbnRhaW5lci5nZXQoJ0lBU1VOTycpOw0KICAgICAgb0JVWUUgPSBjb250YWluZXIuZ2V0KCdJQUJVWUUnKTsNCiAgICAgIG9DVUNEID0gY29udGFpbmVyLmdldCgnSUFDVUNEJyk7DQogICAgICBvWVJFMSA9IGNvbnRhaW5lci5nZXQoJ0lBWVJFMScpOw0KICAgICAgb1RGTk8gPSBjb250YWluZXIuZ2V0KCdJQVRGTk8nKTsNCiAgICAgIG9DT0FNID0gY29udGFpbmVyLmdldCgnSUFDT0FNJyk7DQogICAgICBvRElWSSA9IGNvbnRhaW5lci5nZXQoJ0lBRElWSScpOw0KICAgICAgb0ZBQ0kgPSBjb250YWluZXIuZ2V0KCdJQUZBQ0knKTsNCiAgICAgIG9XSExPID0gY29udGFpbmVyLmdldCgnSUFXSExPJyk7DQogICAgICBvT1JUWSA9IGNvbnRhaW5lci5nZXQoJ0lBT1JUWScpOw0KICAgICAgb1RFUFkgPSBjb250YWluZXIuZ2V0KCdJQVRFUFknKTsNCiAgICAgIG9NT0RMID0gY29udGFpbmVyLmdldCgnSUFNT0RMJyk7DQogICAgICBvVEVQQSA9IGNvbnRhaW5lci5nZXQoJ0lBVEVQQScpOw0KICAgICAgb1RFREwgPSBjb250YWluZXIuZ2V0KCdJQVRFREwnKTsNCiAgICAgIG9URUwxID0gY29udGFpbmVyLmdldCgnSUFURUwxJyk7DQogICAgICBvVE9RVCA9IGNvbnRhaW5lci5nZXQoJ0lBVE9RVCcpOw0KDQogICAgICAvLyBHZXQgVG9kYXkncyBkYXRlDQogICAgICBvREFURSA9IExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKTsNCg0KICAgICAgLy8gR2V0IG5hbWUgb2YgdXNlciByZXNwb25zaWJsZQ0KICAgICAgREJBY3Rpb24gcXVlcnlDU1lVU1IgPSBkYXRhYmFzZS50YWJsZSgiQ1NZVVNSIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJDUkNPTk8iLCAiQ1JESVZJIiwgIkNSUkVTUCIsICJDUlJFTk0iKS5idWlsZCgpOw0KICAgICAgREJDb250YWluZXIgY29udGFpbmVyQ1NZVVNSID0gcXVlcnlDU1lVU1IuZ2V0Q29udGFpbmVyKCk7DQogICAgICBjb250YWluZXJDU1lVU1Iuc2V0KCJDUkNPTk8iLCBjdXJyZW50Q29tcGFueSk7DQogICAgICBjb250YWluZXJDU1lVU1Iuc2V0KCJDUkRJVkkiLCBvRElWSSk7DQogICAgICBjb250YWluZXJDU1lVU1Iuc2V0KCJDUlJFU1AiLCBvQlVZRSk7DQoNCiAgICAgIGlmIChxdWVyeUNTWVVTUi5yZWFkKGNvbnRhaW5lckNTWVVTUikpIHsNCiAgICAgICAgb1JFTk0gPSBjb250YWluZXJDU1lVU1IuZ2V0KCJDUlJFTk0iKTsNCiAgICAgIH0NCg0KICAgICAgLy8gR2V0IFN1cHBsaWVyJ3MgY291bnRyeSBjb2RlIGFuZCBQaG9uZSBudW1iZXINCiAgICAgIERCQWN0aW9uIHF1ZXJ5Q0lETUFTID0gZGF0YWJhc2UudGFibGUoIkNJRE1BUyIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiSURDT05PIiwgIklEU1VOTyIsICJJRENTQ0QiLCAiSURQSE5PIikuYnVpbGQoKTsNCiAgICAgIERCQ29udGFpbmVyIGNvbnRhaW5lckNJRE1BUyA9IHF1ZXJ5Q0lETUFTLmdldENvbnRhaW5lcigpOw0KICAgICAgY29udGFpbmVyQ0lETUFTLnNldCgiSURDT05PIiwgY3VycmVudENvbXBhbnkpOw0KICAgICAgY29udGFpbmVyQ0lETUFTLnNldCgiSURTVU5PIiwgb1NVTk8pOw0KDQogICAgICBpZiAocXVlcnlDSURNQVMucmVhZChjb250YWluZXJDSURNQVMpKSB7DQogICAgICAgIG9DU0NEID0gY29udGFpbmVyQ0lETUFTLmdldCgiSURDU0NEIik7DQogICAgICAgIG9QSE5PID0gY29udGFpbmVyQ0lETUFTLmdldCgiSURQSE5PIik7DQogICAgICB9DQoNCiAgICAgIC8vIEdldCBPcmRlciB0eXBlIGRldGFpbHMNCiAgICAgIERCQWN0aW9uIHF1ZXJ5TVBPUkRUID0gZGF0YWJhc2UudGFibGUoIk1QT1JEVCIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiT1RDT05PIiwgIk9UT1JUWSIsICJPVFAyNTAiLCAiT1RQT1RDIikuYnVpbGQoKTsNCiAgICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck1QT1JEVCA9IHF1ZXJ5TVBPUkRULmdldENvbnRhaW5lcigpOw0KICAgICAgY29udGFpbmVyTVBPUkRULnNldCgiT1RDT05PIiwgY3VycmVudENvbXBhbnkpOw0KICAgICAgY29udGFpbmVyTVBPUkRULnNldCgiT1RPUlRZIiwgb09SVFkpOw0KDQogICAgICBTdHJpbmcgdFAyNTAgPSAiIjsNCiAgICAgIFN0cmluZyB0UE9UQyA9ICIiOw0KICAgICAgU3RyaW5nIHRBR05UID0gY29udGFpbmVyLmdldCgiSUFBR05UIik7DQoNCiAgICAgIGlmIChxdWVyeU1QT1JEVC5yZWFkKGNvbnRhaW5lck1QT1JEVCkpIHsNCiAgICAgICAgdFAyNTAgPSBjb250YWluZXJNUE9SRFQuZ2V0KCJPVFAyNTAiKTsNCiAgICAgICAgdFBPVEMgPSBjb250YWluZXJNUE9SRFQuZ2V0KCJPVFBPVEMiKTsNCiAgICAgIH0NCg0KICAgICAgLy8gR2V0IHBob25lIG51bWJlciBmcm9tIENJRFJFRiBhbmQgdXBkYXRlIG9QSE5PDQogICAgICBTdHJpbmcgdFNVTk8gPSBjb250YWluZXIuZ2V0KCJJQVNVTk8iKTsNCiAgICAgIFN0cmluZyB0UkZUWSA9ICIiOw0KICAgICAgU3RyaW5nIHRSRklEID0gY29udGFpbmVyLmdldCgiSUFSRklEIik7DQoNCiAgICAgIGlmICh0UDI1MC5lcXVhbHMoIjEiKSAmJiAhdEFHTlQuZXF1YWxzKCIiKSkgew0KICAgICAgICB0U1VOTyA9ICIiICsgdEFHTlQ7DQogICAgICB9DQoNCiAgICAgIGlmICh0UE9UQy5lcXVhbHMoIjYwIikgfHwgdFBPVEMuZXF1YWxzKCI2NSIpIHx8IHRQT1RDLmVxdWFscygiNzAiKSkgew0KICAgICAgICB0UkZUWSA9ICIxNSI7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBpZiAodFBPVEMuZXF1YWxzKCI4MCIpIHx8IHRQT1RDLmVxdWFscygiODUiKSkgew0KICAgICAgICAgIHRSRlRZID0gIjM1IjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0UkZUWSA9ICIxMCI7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgREJBY3Rpb24gcXVlcnlDSURSRUYgPSBkYXRhYmFzZS50YWJsZSgiQ0lEUkVGIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJJUkNPTk8iLCAiSVJTVU5PIiwgIklSUkZUWSIsICJJUlJGSUQiLCAiSVJQSE5PIikuYnVpbGQoKTsNCiAgICAgIERCQ29udGFpbmVyIGNvbnRhaW5lckNJRFJFRiA9IHF1ZXJ5Q0lEUkVGLmdldENvbnRhaW5lcigpOw0KICAgICAgY29udGFpbmVyQ0lEUkVGLnNldCgiSVJDT05PIiwgY3VycmVudENvbXBhbnkpOw0KICAgICAgY29udGFpbmVyQ0lEUkVGLnNldCgiSVJTVU5PIiwgdFNVTk8pOw0KICAgICAgY29udGFpbmVyQ0lEUkVGLnNldCgiSVJSRlRZIiwgdFJGVFkpOw0KICAgICAgY29udGFpbmVyQ0lEUkVGLnNldCgiSVJSRklEIiwgdFJGSUQpOw0KDQogICAgICBpZiAocXVlcnlDSURSRUYucmVhZChjb250YWluZXJDSURSRUYpKSB7DQogICAgICAgIG9QSE5PID0gY29udGFpbmVyQ0lEUkVGLmdldCgiSVJQSE5PIik7DQogICAgICB9DQoNCiAgICAgIC8vIEdldCBsYXRlc3QgcmVtYXJrIGZyb20gQ1JFVlRCDQogICAgICBEQkFjdGlvbiBxdWVyeUNSRVZUQiA9IGRhdGFiYXNlLnRhYmxlKCJDUkVWVEIiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIlJUQ09OTyIsICJSVFJFVlQiLCAiUlRSSUROIiwgIlJUUkVNSyIpLmJ1aWxkKCk7DQogICAgICBEQkNvbnRhaW5lciBjb250YWluZXJDUkVWVEIgPSBxdWVyeUNSRVZUQi5nZXRDb250YWluZXIoKTsNCiAgICAgIGNvbnRhaW5lckNSRVZUQi5zZXQoIlJUQ09OTyIsIGN1cnJlbnRDb21wYW55KTsNCiAgICAgIGNvbnRhaW5lckNSRVZUQi5zZXQoIlJUUkVWVCIsIDEpOw0KICAgICAgY29udGFpbmVyQ1JFVlRCLnNldCgiUlRSSUROIiwgZWFjaFBVTk8pOw0KICAgICAgcXVlcnlDUkVWVEIucmVhZEFsbChjb250YWluZXJDUkVWVEIsIDMsIGNsb3N1cmVDUkVWVEIpOw0KDQogICAgfQ0KDQogICAgcmV0dXJuIHJlY29yZEZvdW5kOw0KICB9DQoNCiAgQ2xvc3VyZSA8ID8gPiBjbG9zdXJlQ1JFVlRCID0gew0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lclJlY29yZCAtPg0KICAgIG9SRU1LID0gY29udGFpbmVyUmVjb3JkLmdldCgiUlRSRU1LIik7DQogIH0NCg0KICAvKiByZXRyaXZlIGN1cnJlbmN5IHNldHRpbmcgZm9yIGEgZGl2aXNpb24NCiAgICovDQogIHB1YmxpYyBnZXRDdXJyZW5jeUNvbnZlcnNpb24oU3RyaW5nIG9ESVZJKSB7DQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgb0RNQ1UgPSByZXN1bHRzLmdldCgnRE1DVScpOw0KDQogICAgICB9DQogICAgfQ0KICAgIGRlZiBwYXJhbXMgPSBbIkNPTk8iOiBDT05PLCAiRElWSSI6IG9ESVZJXTsNCiAgICBtaUNhbGxlci5jYWxsKCJNTlMxMDBNSSIsICJHZXRCYXNpY0RhdGEiLCBwYXJhbXMsIGNhbGxiYWNrKTsNCiAgfQ0KDQogIC8qIHJldHJpdmUgc3VwcGxpZXIgZGV0YWlscyB1c2luZyBDUlM2MjBNSS5HZXRCYXNpY0RhdGENCiAgICovDQogIHB1YmxpYyBnZXRTdXBwbGllck5hbWUoU3RyaW5nIG9TVU5PKSB7DQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgb1NVTk0gPSByZXN1bHRzLmdldCgnU1VOTScpOw0KDQogICAgICB9DQogICAgfQ0KICAgIGRlZiBwYXJhbXMgPSBbIkNPTk8iOiBDT05PLCAiU1VOTyI6IG9TVU5PXTsNCiAgICBtaUNhbGxlci5jYWxsKCJDUlM2MjBNSSIsICJHZXRCYXNpY0RhdGEiLCBwYXJhbXMsIGNhbGxiYWNrKTsNCiAgfQ0KDQogIC8qIHNlbmQgcHVyY2hhc2Ugb3JkZXIgZGF0YSB0byBvdXRwdXQNCiAgICovDQogIHB1YmxpYyB3cml0ZVB1cmNoYXNlT3JkZXIoKSB7DQogICAgLy8JaWYgKG9QVVNMIDwnODUnICYmIG9QVVNUIDwgJzkwJyl7ICAvL0NoYW5nZWQgYnkgU2hhc2hhbmsNCiAgICBpZiAob1BVU0wgPCAnODUnKSB7IC8vQ2hhbmdlZCBieSBLZWRhcg0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JDVFAnLCAnT0gnKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQVU5PJywgb1BVTk8pOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0RBVEUnLCBvREFURSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUFVEVCcsIG9QVURUKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdEV0RUJywgb0RXRFQpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JFTk0nLCBvUkVOTSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnU1VOTycsIG9TVU5PKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdDU0NEJywgb0NTQ0QpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0JVWUUnLCBvQlVZRSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQ1VDRCcsIG9DVUNEKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdZUkUxJywgb1lSRTEpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BITk8nLCBvUEhOTyk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnVEZOTycsIG9URk5PKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdSRU1LJywgb1JFTUspOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0NPQU0nLCBvQ09BTSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnRElWSScsIG9ESVZJKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdGQUNJJywgb0ZBQ0kpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1dITE8nLCBvV0hMTyk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnT1JUWScsIG9PUlRZKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdURVBZJywgb1RFUFkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ01PREwnLCBvTU9ETCk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnVEVQQScsIG9URVBBKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdURURMJywgb1RFREwpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1RFTDEnLCBvVEVMMSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnVE9RVCcsIG9UT1FUKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdTVU5NJywgb1NVTk0pOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BVU0wnLCBvUFVTTCk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUFVTVCcsIG9QVVNUKTsNCiAgICAgIG1pLndyaXRlKCk7DQogICAgfQ0KICB9DQoNCiAgLyogZ2V0IGNoYXJnZXMgZm9yIGVhY2ggcHVyY2hhc2Ugb3JkZXIgZnJvbSB0YWJsZSBNUE9FWFANCiAgICovDQogIHByaXZhdGUgZ2V0Q2hhcmdlcyhTdHJpbmcgZWFjaFBVTk8pIHsNCiAgICBjaGFyZ2VMaXN0ID0gbmV3IEFycmF5TGlzdCA8IEhhc2h0YWJsZSA+ICgpOw0KICAgIERCQWN0aW9uIHF1ZXJ5TVBPRVhQID0gZGF0YWJhc2UudGFibGUoIk1QT0VYUCIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiSVZDT05PIiwgIklWUFVOTyIsICJJVlBOTEkiLCAiSVZQTkxTIiwgIklWQ0RTRSIsICJJVlJFUE4iLCAiSVZFWFRZIiwgIklWQ0VJRCIsICJJVkVYSUMiLCAiSVZXU09QIiwgIklWQ1VDRCIsICJJVkNFVkEiLCAiSVZDRVZKIiwgIklWVEhQUiIsICJJVklWQ1EiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIHJlY29yZE1QT0VYUCA9IHF1ZXJ5TVBPRVhQLmdldENvbnRhaW5lcigpOw0KICAgIHJlY29yZE1QT0VYUC5zZXQoIklWQ09OTyIsIEludGVnZXIucGFyc2VJbnQoQ09OTy50cmltKCkpKTsNCiAgICByZWNvcmRNUE9FWFAuc2V0KCJJVlBVTk8iLCBlYWNoUFVOTy50cmltKCkpOw0KICAgIHJlY29yZE1QT0VYUC5zZXQoIklWUE5MSSIsIDApOw0KICAgIHJlY29yZE1QT0VYUC5zZXQoIklWUE5MUyIsIDApOw0KICAgIC8vIHJlYWQgbG9jayBhbmQgY2FsbCBjcmVhdGVSZWNvcmRzKCkNCiAgICBpbnQgcmVhZHMgPSBxdWVyeU1QT0VYUC5yZWFkQWxsKHJlY29yZE1QT0VYUCwgNCwgZ2V0TVBPRVhQUmVjb3Jkcyk7DQoNCiAgfQ0KDQogIENsb3N1cmUgPCA/ID4gZ2V0TVBPRVhQUmVjb3JkcyA9IHsNCiAgICBEQkNvbnRhaW5lciByZWNvcmQgLT4NCiAgICBTdHJpbmcgUE5MSSA9IHJlY29yZC5nZXQoJ0lWUE5MSScpOw0KICAgIFN0cmluZyBQTkxTID0gcmVjb3JkLmdldCgnSVZQTkxTJyk7DQogICAgU3RyaW5nIENEU0UgPSByZWNvcmQuZ2V0KCdJVkNEU0UnKTsNCiAgICBTdHJpbmcgUkVQTiA9IHJlY29yZC5nZXQoJ0lWUkVQTicpOw0KICAgIFN0cmluZyBFWFRZID0gcmVjb3JkLmdldCgnSVZFWFRZJyk7DQogICAgU3RyaW5nIENFSUQgPSByZWNvcmQuZ2V0KCdJVkNFSUQnKTsNCiAgICBTdHJpbmcgRVhJQyA9IHJlY29yZC5nZXQoJ0lWRVhJQycpOw0KICAgIFN0cmluZyBXU09QID0gcmVjb3JkLmdldCgnSVZXU09QJyk7DQogICAgU3RyaW5nIENVQ0QgPSByZWNvcmQuZ2V0KCdJVkNVQ0QnKTsNCiAgICBTdHJpbmcgQ0VWQSA9IHJlY29yZC5nZXQoJ0lWQ0VWQScpOw0KICAgIFN0cmluZyBDRVZKID0gcmVjb3JkLmdldCgnSVZDRVZKJyk7DQogICAgU3RyaW5nIFRIUFIgPSByZWNvcmQuZ2V0KCdJVlRIUFInKTsNCiAgICBTdHJpbmcgSVZDUSA9IHJlY29yZC5nZXQoJ0lWSVZDUScpOw0KICAgIEhhc2h0YWJsZSB0ZW1wVGFibGUgPSBuZXcgSGFzaHRhYmxlIDwgU3RyaW5nLA0KICAgIFN0cmluZyA+ICgpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1BOTEknLCBQTkxJKTsNCiAgICB0ZW1wVGFibGUucHV0KCdQTkxTJywgUE5MUyk7DQogICAgdGVtcFRhYmxlLnB1dCgnQ0RTRScsIENEU0UpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1JFUE4nLCBSRVBOKTsNCiAgICB0ZW1wVGFibGUucHV0KCdFWFRZJywgRVhUWSk7DQogICAgdGVtcFRhYmxlLnB1dCgnQ0VJRCcsIENFSUQpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0VYSUMnLCBFWElDKTsNCiAgICB0ZW1wVGFibGUucHV0KCdXU09QJywgV1NPUCk7DQogICAgdGVtcFRhYmxlLnB1dCgnQ1VDRCcsIENVQ0QpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0NFVkEnLCBDRVZBKTsNCiAgICB0ZW1wVGFibGUucHV0KCdDRVZKJywgQ0VWSik7DQogICAgdGVtcFRhYmxlLnB1dCgnVEhQUicsIFRIUFIpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0lWQ1EnLCBJVkNRKTsNCiAgICBjaGFyZ2VMaXN0LmFkZCh0ZW1wVGFibGUpOw0KDQogIH0NCiAgLyogc2VuZCBjaGFyZ2UgZGV0YWlscyB0byBvdXRwdXQNCiAgICovDQogIHB1YmxpYyB3cml0ZUNoYXJnZXMoU3RyaW5nIGVhY2hQVU5PLCBIYXNodGFibGUgZWFjaENoYXJnZSkgew0KICAgIFN0cmluZyBDRUlEID0gZWFjaENoYXJnZS5nZXQoJ0NFSUQnKTsNCiAgICBTdHJpbmcgVFgzMCA9ICIiOw0KICAgIGJvb2xlYW4gcmVjb3JkRXhpc3RzID0gdHJ1ZTsNCiAgICBkZWYgY2FsbGJhY2sgPSB7DQogICAgICBNYXAgPCBTdHJpbmcsDQogICAgICBTdHJpbmcgPiByZXN1bHRzIC0+DQogICAgICByZWNvcmRFeGlzdHMgPSAhcmVzdWx0cy5nZXQoJ2Vycm9yJyk7DQogICAgICBpZiAocmVjb3JkRXhpc3RzKSB7DQogICAgICAgIFRYMzAgPSByZXN1bHRzLmdldCgnVFgzMCcpOw0KDQogICAgICB9DQogICAgICBTdHJpbmcgUE5MSSA9IGVhY2hDaGFyZ2UuZ2V0KCdQTkxJJyk7DQogICAgICBTdHJpbmcgUE5MUyA9IGVhY2hDaGFyZ2UuZ2V0KCdQTkxTJyk7DQogICAgICBTdHJpbmcgQ0RTRSA9IGVhY2hDaGFyZ2UuZ2V0KCdDRFNFJyk7DQogICAgICBTdHJpbmcgUkVQTiA9IGVhY2hDaGFyZ2UuZ2V0KCdSRVBOJyk7DQogICAgICBTdHJpbmcgRVhUWSA9IGVhY2hDaGFyZ2UuZ2V0KCdFWFRZJyk7DQogICAgICBTdHJpbmcgRVhJQyA9IGVhY2hDaGFyZ2UuZ2V0KCdFWElDJyk7DQogICAgICBTdHJpbmcgV1NPUCA9IGVhY2hDaGFyZ2UuZ2V0KCdXU09QJyk7DQogICAgICBTdHJpbmcgQ1VDRCA9IGVhY2hDaGFyZ2UuZ2V0KCdDVUNEJyk7DQogICAgICBTdHJpbmcgQ0VWQSA9IGVhY2hDaGFyZ2UuZ2V0KCdDRVZBJyk7DQogICAgICBTdHJpbmcgQ0VWSiA9IGVhY2hDaGFyZ2UuZ2V0KCdDRVZKJyk7DQogICAgICBTdHJpbmcgVEhQUiA9IGVhY2hDaGFyZ2UuZ2V0KCdUSFBSJyk7DQogICAgICBTdHJpbmcgSVZDUSA9IGVhY2hDaGFyZ2UuZ2V0KCdJVkNRJyk7DQoNCiAgICAgIG1pLm91dERhdGEucHV0KCdSQ1RQJywgJ09DJyk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUFVOTycsIGVhY2hQVU5PKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdDRFNFJywgQ0RTRSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUkVQTicsIFJFUE4pOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0VYVFknLCBFWFRZKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdFWElDJywgRVhJQyk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnV1NPUCcsIFdTT1ApOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0NDVUMnLCBDVUNEKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdDRVZBJywgQ0VWQSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQ0VWSicsIENFVkopOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1RIUFInLCBUSFBSKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdJVkNRJywgSVZDUSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnVFgzMCcsIFRYMzApOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0NFSUQnLCBDRUlEKTsNCiAgICAgIG1pLndyaXRlKCk7DQogICAgfQ0KICAgIGRlZiBwYXJhbXMgPSBbIkNFSUQiOiBDRUlELnRyaW0oKV07DQogICAgbWlDYWxsZXIuY2FsbCgiUFBTMjgwTUkiLCAiR2V0RWxlbWVudCIsIHBhcmFtcywgY2FsbGJhY2spOw0KDQogIH0NCg0KICAvKiBSZXRyaXZlIHB1cmNoYXNlIG9yZGVyIGxpbmUgZGV0YWlscyBmcm9tIE1QTElORQ0KICAgKi8NCg0KICBwdWJsaWMgZ2V0TGluZURldGFpbHMoU3RyaW5nIGVhY2hQVU5PKSB7DQoNCiAgICBsaW5lTGlzdCA9IG5ldyBBcnJheUxpc3QgPCBIYXNodGFibGUgPiAoKTsNCiAgICBpbnQgY3VycmVudENvbXBhbnkgPSAoSW50ZWdlcikgcHJvZ3JhbS5nZXRMREFaRCgpLkNPTk87DQoNCiAgICBEQkFjdGlvbiBxdWVyeU1QTElORSA9IGRhdGFiYXNlLnRhYmxlKCJNUExJTkUiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIklCQ09OTyIsICJJQlBVTk8iLCAiSUJQTkxJIiwgIklCUE5MUyIsICJJQklUTk8iLCAiSUJTSVRFIiwgIklCQ0ZRQSIsICJJQlBVVU4iLCAiSUJXSExPIiwgIklCUFVTVCIsICJJQlBVU0wiLCAiSUJTVU5PIiwgIklCUElURCIsICJJQlBJVFQiLCAiSUJQVVBSIiwgIklCQ1BQUiIsICJJQkNGRDEiLCAiSUJDRkQyIiwgIklCQ0ZEMyIsICJJQlBQVU4iLCAiSUJQVUNEIiwgIklCTE5BTSIsICJJQlBUQ0QiLCAiSUJWVENEIiwgIklCT1JRQSIsICJJQkFEUUEiLCAiSUJSVlFBIiwgIklCQ0FRQSIsICJJQlJKUUEiLCAiSUJTRFFBIiwgIklCSVZRQSIsICJJQlBVUkMiLCAiSUJCVVlFIiwgIklCR1JNVCIsICJJQlJPUkMiLCAiSUJST1JOIiwgIklCUk9STCIsICJJQlJPUlgiLCAiSUJNT0RMIiwgIklCVEVETCIsICJJQlRFTDEiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck1QTElORSA9IHF1ZXJ5TVBMSU5FLmdldENvbnRhaW5lcigpOw0KICAgIGNvbnRhaW5lck1QTElORS5zZXQoIklCQ09OTyIsIGN1cnJlbnRDb21wYW55KTsNCiAgICBjb250YWluZXJNUExJTkUuc2V0KCJJQlBVTk8iLCBlYWNoUFVOTyk7DQoNCiAgICBxdWVyeU1QTElORS5yZWFkQWxsKGNvbnRhaW5lck1QTElORSwgMiwgY2xvc3VyZU1QTElORSk7DQoNCiAgfQ0KDQogIENsb3N1cmUgPCA/ID4gY2xvc3VyZU1QTElORSA9IHsNCiAgICBEQkNvbnRhaW5lciBjb250YWluZXJNUExJTkUgLT4NCg0KICAgIEhhc2h0YWJsZSB0ZW1wVGFibGUgPSBuZXcgSGFzaHRhYmxlIDwgU3RyaW5nLA0KICAgIFN0cmluZyA+ICgpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1BOTEknLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlBOTEknKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdQTkxTJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJQTkxTJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnSVROTycsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCSVROTycpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1NJVEUnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlNJVEUnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdDRlFBJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJDRlFBJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnUFVVTicsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCUFVVTicpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1dITE8nLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQldITE8nKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdQVVNUJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJQVVNUJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnUFVTTCcsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCUFVTTCcpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1NVTk8nLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlNVTk8nKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdQSVREJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJQSVREJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnUElUVCcsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCUElUVCcpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1BVUFInLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlBVUFInKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdDUFBSJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJDUFBSJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnQ0ZEMScsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCQ0ZEMScpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0NGRDInLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQkNGRDInKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdDRkQzJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJDRkQzJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnUFBVTicsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCUFBVTicpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1BVQ0QnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlBVQ0QnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdMTkFNJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJMTkFNJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnUFRDRCcsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCUFRDRCcpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1ZUQ0QnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlZUQ0QnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdPUlFBJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJPUlFBJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnQURRQScsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCQURRQScpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1JWUUEnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlJWUUEnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdDQVFBJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJDQVFBJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnUkpRQScsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCUkpRQScpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1NEUUEnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlNEUUEnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdJVlFBJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJJVlFBJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnUFVSQycsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCUFVSQycpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0JVWUUnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQkJVWUUnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdHUk1UJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJHUk1UJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnVlRDRCcsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCVlRDRCcpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1JPUkMnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlJPUkMnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdST1JOJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJST1JOJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnUk9STCcsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCUk9STCcpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1JPUlgnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlJPUlgnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdNT0RMJywgY29udGFpbmVyTVBMSU5FLmdldCgnSUJNT0RMJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnVEVETCcsIGNvbnRhaW5lck1QTElORS5nZXQoJ0lCVEVETCcpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1RFTDEnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlRFTDEnKS50b1N0cmluZygpKTsNCiAgICAvL3RlbXBUYWJsZS5wdXQoJ0NVUFInLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQlBVQ0QnKS50b1N0cmluZygpKTsgIC8vIE5vdCBwYXJ0IG9mIHRoZSBvdXRwdXQNCiAgICAvL3RlbXBUYWJsZS5wdXQoJ0NVQ1AnLCBjb250YWluZXJNUExJTkUuZ2V0KCdJQkNQUFInKS50b1N0cmluZygpKTsgIC8vIE5vdCBwYXJ0IG9mIHRoZSBvdXRwdXQNCg0KICAgIGludCBjdXJyZW50Q29tcGFueSA9IChJbnRlZ2VyKSBwcm9ncmFtLmdldExEQVpEKCkuQ09OTzsNCg0KICAgIC8vIEdldCBVbml0IG9mIG1lYXN1cmUgZnJvbSBNSVRNQVMNCiAgICBTdHJpbmcgdElUTk8gPSBjb250YWluZXJNUExJTkUuZ2V0KCdJQklUTk8nKS50b1N0cmluZygpOw0KICAgIFN0cmluZyB0VU5NUyA9ICIiOw0KICAgIFN0cmluZyB0RENDRCA9ICIwIjsNCiAgICBTdHJpbmcgdFBEQ0MgPSAiMCI7DQogICAgU3RyaW5nIGRlY2ltYWxaZXJvZXMgPSAiIjsNCg0KICAgIERCQWN0aW9uIHF1ZXJ5TUlUTUFTID0gZGF0YWJhc2UudGFibGUoIk1JVE1BUyIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiTU1DT05PIiwgIk1NSVROTyIsICJNTVVOTVMiLCAiTU1EQ0NEIiwgIk1NUERDQyIpLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgY29udGFpbmVyTUlUTUFTID0gcXVlcnlNSVRNQVMuZ2V0Q29udGFpbmVyKCk7DQogICAgY29udGFpbmVyTUlUTUFTLnNldCgiTU1DT05PIiwgY3VycmVudENvbXBhbnkpOw0KICAgIGNvbnRhaW5lck1JVE1BUy5zZXQoIk1NSVROTyIsIHRJVE5PKTsNCg0KICAgIGlmIChxdWVyeU1JVE1BUy5yZWFkKGNvbnRhaW5lck1JVE1BUykpIHsNCg0KICAgICAgdFVOTVMgPSBjb250YWluZXJNSVRNQVMuZ2V0KCJNTVVOTVMiKTsNCiAgICAgIHREQ0NEID0gY29udGFpbmVyTUlUTUFTLmdldCgiTU1EQ0NEIik7DQogICAgICB0UERDQyA9IGNvbnRhaW5lck1JVE1BUy5nZXQoIk1NUERDQyIpOw0KDQogICAgICAvLyBQcmVwYXJlIHRoZSB6ZXJvZXMgc3RyaW5nIGZvciBmb3JtYXR0aW5nDQogICAgICBpbnQgZGNjZCA9IEludGVnZXIucGFyc2VJbnQodERDQ0QpOw0KICAgICAgaWYgKGRjY2QgPiAwKSB7DQogICAgICAgIGRlY2ltYWxaZXJvZXMgPSAiLiI7DQoNCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBkY2NkOyBpKyspIHsNCiAgICAgICAgICBkZWNpbWFsWmVyb2VzID0gZGVjaW1hbFplcm9lcyArICIwIjsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIHRlbXBUYWJsZS5wdXQoJ1VOTVMnLCB0VU5NUyk7DQoNCiAgICAvLyBHZXQgQWx0ZXJuYXRlIFUvTSBkZXRhaWxzIGZyb20gTUlUQVVODQogICAgU3RyaW5nIHRETUNGID0gIjEiOw0KICAgIFN0cmluZyB0Q09GQSA9ICIxIjsNCiAgICBTdHJpbmcgdFBVVU4gPSBjb250YWluZXJNUExJTkUuZ2V0KCdJQlBVVU4nKS50b1N0cmluZygpOw0KICAgIGJvb2xlYW4gZXhpc3RNSVRBVU4gPSBmYWxzZTsNCg0KICAgIERCQWN0aW9uIHF1ZXJ5TUlUQVVOID0gZGF0YWJhc2UudGFibGUoIk1JVEFVTiIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiTVVDT05PIiwgIk1VSVROTyIsICJNVUFVVFAiLCAiTVVBTFVOIiwgIk1VRE1DRiIsICJNVUNPRkEiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck1JVEFVTiA9IHF1ZXJ5TUlUQVVOLmdldENvbnRhaW5lcigpOw0KICAgIGNvbnRhaW5lck1JVEFVTi5zZXQoIk1VQ09OTyIsIGN1cnJlbnRDb21wYW55KTsNCiAgICBjb250YWluZXJNSVRBVU4uc2V0KCJNVUlUTk8iLCB0SVROTyk7DQogICAgY29udGFpbmVyTUlUQVVOLnNldCgiTVVBVVRQIiwgMSk7DQogICAgY29udGFpbmVyTUlUQVVOLnNldCgiTVVBTFVOIiwgdFBVVU4pOw0KDQogICAgaWYgKHF1ZXJ5TUlUQVVOLnJlYWQoY29udGFpbmVyTUlUQVVOKSkgew0KICAgICAgZXhpc3RNSVRBVU4gPSB0cnVlOw0KICAgICAgdERNQ0YgPSBjb250YWluZXJNSVRBVU4uZ2V0KCJNVURNQ0YiKTsNCiAgICAgIHRDT0ZBID0gY29udGFpbmVyTUlUQVVOLmdldCgiTVVDT0ZBIik7DQogICAgfQ0KDQogICAgLy8gR2V0IE9yZGVyIFF1YW50aXR5IGNvbnZlcnRlZCB0byBCYXNpYyBVL00NCiAgICBTdHJpbmcgdE9SUVQgPSBjb250YWluZXJNUExJTkUuZ2V0KCdJQk9SUUEnKS50b1N0cmluZygpOw0KDQogICAgZG91YmxlIHRQWE5VTSA9IERvdWJsZS5wYXJzZURvdWJsZSh0T1JRVCk7DQoNCiAgICBpZiAoIXRQVVVOLmVxdWFscyh0VU5NUykpIHsNCg0KICAgICAgaWYgKGV4aXN0TUlUQVVOKSB7DQoNCiAgICAgICAgaWYgKHRETUNGLmVxdWFscygiMSIpKSB7DQogICAgICAgICAgdFBYTlVNID0gdFBYTlVNICogRG91YmxlLnBhcnNlRG91YmxlKHRDT0ZBKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0UFhOVU0gPSB0UFhOVU0gLyBEb3VibGUucGFyc2VEb3VibGUodENPRkEpOw0KICAgICAgICB9DQoNCiAgICAgIH0NCg0KICAgIH0NCg0KICAgIERlY2ltYWxGb3JtYXQgZGYgPSBuZXcgRGVjaW1hbEZvcm1hdCgiIyMjIyMjIyMjIyMwIiArIGRlY2ltYWxaZXJvZXMpOw0KICAgIHRPUlFUID0gIiIgKyBkZi5mb3JtYXQodFBYTlVNKTsNCiAgICB0ZW1wVGFibGUucHV0KCdPUlFUJywgdE9SUVQpOw0KDQogICAgLy8gR2V0IExPQ0QgZnJvbSBMREFaRA0KICAgIHRlbXBUYWJsZS5wdXQoJ0xPQ0QnLCBwcm9ncmFtLmdldExEQVpEKCkuTE9DRC50b1N0cmluZygpKTsNCg0KICAgIC8vIEdldCBQdXJjaGFzZSBwcmljZSBRdHkgY29udmVydGVkIHRvIEJhc2ljIFUvTQ0KICAgIFN0cmluZyB0UFVRVCA9IGNvbnRhaW5lck1QTElORS5nZXQoJ0lCUFVDRCcpLnRvU3RyaW5nKCk7DQoNCiAgICB0UFhOVU0gPSBEb3VibGUucGFyc2VEb3VibGUodFBVUVQpOw0KDQogICAgaWYgKCF0UFVVTi5lcXVhbHModFVOTVMpKSB7DQoNCiAgICAgIGlmIChleGlzdE1JVEFVTikgew0KDQogICAgICAgIGlmICh0RE1DRi5lcXVhbHMoIjIiKSkgew0KICAgICAgICAgIHRQWE5VTSA9IHRQWE5VTSAqIERvdWJsZS5wYXJzZURvdWJsZSh0Q09GQSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdFBYTlVNID0gdFBYTlVNIC8gRG91YmxlLnBhcnNlRG91YmxlKHRDT0ZBKTsNCiAgICAgICAgfQ0KDQogICAgICB9DQoNCiAgICB9DQoNCiAgICBkZiA9IG5ldyBEZWNpbWFsRm9ybWF0KCIjIyMjIyMjIyMjIzAiICsgZGVjaW1hbFplcm9lcyk7DQogICAgdFBVUVQgPSAiIiArIGRmLmZvcm1hdCh0UFhOVU0pOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1BVUVQnLCB0UFVRVCk7DQoNCiAgICAvLyBHZXQgUmVjZWl2ZWQgUXR5IGNvbnZlcnRlZCB0byBCYXNpYyBVL00NCiAgICBTdHJpbmcgdFJWUVQgPSBjb250YWluZXJNUExJTkUuZ2V0KCdJQlJWUUEnKS50b1N0cmluZygpOw0KDQogICAgdFBYTlVNID0gRG91YmxlLnBhcnNlRG91YmxlKHRSVlFUKTsNCg0KICAgIGlmICghdFBVVU4uZXF1YWxzKHRVTk1TKSkgew0KDQogICAgICBpZiAoZXhpc3RNSVRBVU4pIHsNCg0KICAgICAgICBpZiAodERNQ0YuZXF1YWxzKCIxIikpIHsNCiAgICAgICAgICB0UFhOVU0gPSB0UFhOVU0gKiBEb3VibGUucGFyc2VEb3VibGUodENPRkEpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRQWE5VTSA9IHRQWE5VTSAvIERvdWJsZS5wYXJzZURvdWJsZSh0Q09GQSk7DQogICAgICAgIH0NCg0KICAgICAgfQ0KDQogICAgfQ0KDQogICAgZGYgPSBuZXcgRGVjaW1hbEZvcm1hdCgiIyMjIyMjIyMjIyMwIiArIGRlY2ltYWxaZXJvZXMpOw0KICAgIHRSVlFUID0gIiIgKyBkZi5mb3JtYXQodFBYTlVNKTsNCiAgICB0ZW1wVGFibGUucHV0KCdSVlFUJywgdFJWUVQpOw0KDQogICAgbGluZUxpc3QuYWRkKHRlbXBUYWJsZSk7DQoNCiAgfQ0KDQogIC8qIHJlcnRpdmUgVW5pdCBvZiBNZWFzdXJlbWVudCBmcm9tIHRhYmxlIE1JVEFVTg0KICAgKi8NCiAgcHVibGljIGdldFVuaXRPZk1lYXN1cmVtZW50Q29udmVyc2lvbihIYXNodGFibGUgZWFjaExpbmUpIHsNCiAgICBTdHJpbmcgSVROTyA9IGVhY2hMaW5lLmdldCgnSVROTycpOw0KICAgIGVhY2hMaW5lUFVVTiA9IGVhY2hMaW5lLmdldCgnUFVVTicpOw0KICAgIGVhY2hMaW5lUFBVTiA9IGVhY2hMaW5lLmdldCgnUFBVTicpOw0KICAgIGludCBjdXJyZW50Q29tcGFueSA9IHByb2dyYW0uZ2V0TERBWkQoKS5DT05POw0KDQogICAgREJBY3Rpb24gcXVlcnlNSVRBVU4gPSBkYXRhYmFzZS50YWJsZSgiTUlUQVVOIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJNVUNPTk8iLCAiTVVJVE5PIiwgIk1VQVVUUCIsICJNVUFMVU4iLCAiTVVETUNGIiwgIk1VQ09GQSIsICJNVURDQ0QiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck1JVEFVTiA9IHF1ZXJ5TUlUQVVOLmdldENvbnRhaW5lcigpOw0KICAgIGNvbnRhaW5lck1JVEFVTi5zZXQoIk1VQ09OTyIsIGN1cnJlbnRDb21wYW55KTsNCiAgICBjb250YWluZXJNSVRBVU4uc2V0KCJNVUlUTk8iLCBJVE5PKTsNCiAgICBxdWVyeU1JVEFVTi5yZWFkQWxsKGNvbnRhaW5lck1JVEFVTiwgMiwgY2xvc3VyZU1JVEFVTik7DQoNCiAgfQ0KDQogIENsb3N1cmUgPCA/ID4gY2xvc3VyZU1JVEFVTiA9IHsNCiAgICBEQkNvbnRhaW5lciBjb250YWluZXJNSVRBVU4gLT4NCg0KICAgIFN0cmluZyBBVVRQID0gY29udGFpbmVyTUlUQVVOLmdldCgnTVVBVVRQJyk7DQogICAgQVVUUF9hID0gQVVUUDsNCiAgICBTdHJpbmcgQUxVTiA9IGNvbnRhaW5lck1JVEFVTi5nZXQoJ01VQUxVTicpOw0KICAgIFN0cmluZyBEQ0NEID0gY29udGFpbmVyTUlUQVVOLmdldCgnTVVEQ0NEJyk7DQogICAgU3RyaW5nIENPRkEgPSBjb250YWluZXJNSVRBVU4uZ2V0KCdNVUNPRkEnKTsNCiAgICBTdHJpbmcgRE1DRiA9IGNvbnRhaW5lck1JVEFVTi5nZXQoJ01VRE1DRicpOw0KICAgIGlmIChBTFVOLnRyaW0oKS5lcXVhbHMoZWFjaExpbmVQVVVOLnRyaW0oKSkgJiYgQVVUUC50cmltKCkuZXF1YWxzKCIxIikpIHsNCiAgICAgIE9yZGVyVU1fRENDRCA9IERDQ0Q7DQogICAgICBPcmRlclVNX0NPRkEgPSBDT0ZBOw0KICAgICAgT3JkZXJVTV9ETUNGID0gRE1DRjsNCiAgICB9DQogICAgaWYgKEFMVU4udHJpbSgpLmVxdWFscyhlYWNoTGluZVBQVU4udHJpbSgpKSkgew0KICAgICAgaWYgKEFVVFAudHJpbSgpLmVxdWFscygiMSIpKSB7DQogICAgICAgIFByaWNlVU1fRENDRCA9IERDQ0Q7DQogICAgICB9DQogICAgICBpZiAoQVVUUC50cmltKCkuZXF1YWxzKCIyIikpIHsNCiAgICAgICAgUHJpY2VVTV9DT0ZBID0gQ09GQTsNCiAgICAgICAgUHJpY2VVTV9ETUNGID0gRE1DRjsNCiAgICAgIH0NCiAgICB9DQogIH0NCiAgLyogZ2V0IGJhc2ljIGRlY2ltYWwgY29kZSBmb3IgSXRlbSBhbmQgb3JkZXIgcXVhbnRpdHlJbnZvaWNlZA0KICAgKi8NCiAgcHVibGljIGdldEJhc2ljRGVjaW1hbENvZGUoSGFzaHRhYmxlIGVhY2hMaW5lKSB7DQogICAgU3RyaW5nIElUTk8gPSBlYWNoTGluZS5nZXQoJ0lUTk8nKTsNCiAgICBTdHJpbmcgT1JRQSA9IGVhY2hMaW5lLmdldCgnT1JRQScpOw0KICAgIFN0cmluZyBBRFFBID0gZWFjaExpbmUuZ2V0KCdBRFFBJyk7DQogICAgU3RyaW5nIE9SUVQgPSBlYWNoTGluZS5nZXQoJ09SUVQnKTsNCiAgICBib29sZWFuIHJlY29yZEV4aXN0cyA9IHRydWU7DQogICAgZGVmIGNhbGxiYWNrID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICBCYXNpY1VNX0RDQ0QgPSByZXN1bHRzLmdldCgnRENDRCcpOw0KICAgICAgfQ0KICAgICAgaWYgKEFEUUEgIT0gbnVsbCAmJiBBRFFBLnRyaW0oKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgQmlnRGVjaW1hbCBhZHZpc2VkUXVhbnRpdHkgPSBuZXcgQmlnRGVjaW1hbChBRFFBKTsNCiAgICAgICAgaWYgKGFkdmlzZWRRdWFudGl0eS5jb21wYXJlVG8oQmlnRGVjaW1hbC5aRVJPKSAhPSAwKSB7DQogICAgICAgICAgQmFzaWNVTV9EQ0NEID0gQmFzaWNVTV9EQ0NELmVxdWFscygiIikgPyAiMiIgOiBCYXNpY1VNX0RDQ0Q7DQogICAgICAgICAgT3JkZXJVTV9DT0ZBID0gT3JkZXJVTV9DT0ZBLmVxdWFscygiIikgPyAiMSIgOiBPcmRlclVNX0NPRkEudHJpbSgpOw0KICAgICAgICAgIE9yZGVyVU1fRE1DRiA9IE9yZGVyVU1fRE1DRi5lcXVhbHMoIiIpID8gIjEiIDogT3JkZXJVTV9ETUNGLnRyaW0oKTsNCg0KICAgICAgICAgIEJpZ0RlY2ltYWwgb3JkZXJlZFF1YW50aXR5ID0gbmV3IEJpZ0RlY2ltYWwoT1JRQSk7DQogICAgICAgICAgQmlnRGVjaW1hbCBjb252ZXJzaW9uRmFjdG9yID0gbmV3IEJpZ0RlY2ltYWwoT3JkZXJVTV9DT0ZBKTsNCiAgICAgICAgICBCaWdJbnRlZ2VyIGRlY2ltYWxQbGFjZXMgPSBuZXcgQmlnSW50ZWdlcihCYXNpY1VNX0RDQ0QpOw0KDQogICAgICAgICAgQmlnRGVjaW1hbCBiYXNlUXVhbnRpdHkgPSBudWxsOw0KDQogICAgICAgICAgaWYgKE9yZGVyVU1fRE1DRi5lcXVhbHMoIjEiKSkgew0KICAgICAgICAgICAgYmFzZVF1YW50aXR5ID0gb3JkZXJlZFF1YW50aXR5LnNldFNjYWxlKDgsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS5tdWx0aXBseShjb252ZXJzaW9uRmFjdG9yKTsNCiAgICAgICAgICAgIE9SUVQgPSBiYXNlUXVhbnRpdHkuc2V0U2NhbGUoZGVjaW1hbFBsYWNlcy5pbnRWYWx1ZSgpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBiYXNlUXVhbnRpdHkgPSBvcmRlcmVkUXVhbnRpdHkuc2V0U2NhbGUoOCwgUm91bmRpbmdNb2RlLkhBTEZfVVApLmRpdmlkZShjb252ZXJzaW9uRmFjdG9yLCBSb3VuZGluZ01vZGUuSEFMRl9VUCk7DQogICAgICAgICAgICBPUlFUID0gYmFzZVF1YW50aXR5LnNldFNjYWxlKGRlY2ltYWxQbGFjZXMuaW50VmFsdWUoKSwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICB9DQogICAgICAgICAgZWFjaExpbmUucmVwbGFjZSgnT1JRVCcsIE9SUVQpOw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICAgIGRlZiBwYXJhbXMgPSBbIkNPTk8iOiBDT05PLCAiSVROTyI6IElUTk9dOw0KICAgIG1pQ2FsbGVyLmNhbGwoIk1NUzIwME1JIiwgIkdldEl0bUJhc2ljIiwgcGFyYW1zLCBjYWxsYmFjayk7DQogIH0NCg0KICAvKiBzZW5kIHB1cmNoYXNlIG9yZGVyIGxpbmUgZGV0YWlscyB0byBvdXRwdXQNCiAgICovDQogIHB1YmxpYyB3cml0ZVB1cmNoYXNlTGluZShTdHJpbmcgZWFjaFBVTk8sIEhhc2h0YWJsZSBlYWNoTGluZSkgew0KICAgIGlmIChlYWNoTGluZS5nZXQoJ1BVU0wnKS50b1N0cmluZygpIDwgJzg1JykgeyAvLyBDaGFuZ2VkIGJ5IHNoYXNoYW5rDQogICAgICBtaS5vdXREYXRhLnB1dCgnUkNUUCcsICdPTCcpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BVTk8nLCBlYWNoUFVOTyk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUE5MSScsIGVhY2hMaW5lLmdldCgnUE5MSScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BOTFMnLCBlYWNoTGluZS5nZXQoJ1BOTFMnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdUUkRUJywgZWFjaExpbmUuZ2V0KCdUUkRUJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnTFdITCcsIGVhY2hMaW5lLmdldCgnV0hMTycpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0lUTk8nLCBlYWNoTGluZS5nZXQoJ0lUTk8nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQSVREJywgZWFjaExpbmUuZ2V0KCdQSVREJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUElUVCcsIGVhY2hMaW5lLmdldCgnUElUVCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1NJVEUnLCBlYWNoTGluZS5nZXQoJ1NJVEUnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdDQVFBJywgZWFjaExpbmUuZ2V0KCdDQVFBJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUkpRQScsIGVhY2hMaW5lLmdldCgnUkpRQScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1NEUUEnLCBlYWNoTGluZS5nZXQoJ1NEUUEnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdPUlFBJywgZWFjaExpbmUuZ2V0KCdPUlFBJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnSVZRQScsIGVhY2hMaW5lLmdldCgnSVZRQScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JWUUEnLCBlYWNoTGluZS5nZXQoJ1JWUUEnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdDRlFBJywgZWFjaExpbmUuZ2V0KCdDRlFBJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnT1FQVScsIGVhY2hMaW5lLmdldCgnT3BlblF1YW50aXR5UHJpY2VVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BVUkMnLCBlYWNoTGluZS5nZXQoJ1BVUkMnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdMQlVZJywgZWFjaExpbmUuZ2V0KCdCVVlFJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnU1RVTScsIGVhY2hMaW5lLmdldCgnU3RhbmRhcmRVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1VOTVMnLCBlYWNoTGluZS5nZXQoJ1VOTVMnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBTFVNJywgZWFjaExpbmUuZ2V0KCdBbHRlcm5hdGVVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0xOQU0nLCBlYWNoTGluZS5nZXQoJ0xOQU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQVVBSJywgZWFjaExpbmUuZ2V0KCdQcmljZVBlclBpZWNlU3RhbmRhcmRVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BVUVQnLCBlYWNoTGluZS5nZXQoJ1BVUVQnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBTFBSJywgZWFjaExpbmUuZ2V0KCdBbHRlcm5hdGl2ZVByaWNlJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUFRDRCcsIGVhY2hMaW5lLmdldCgnVlRDRCcpLnRvU3RyaW5nKCkpOw0KICAgICAgaWYgKGVhY2hMaW5lLmdldCgnVlRDRCcpLnRvU3RyaW5nKCkubGVuZ3RoKCkgPT0gMSkgew0KDQogICAgICAgIG1pLm91dERhdGEucHV0KCdWVENEJywgJzAnICsgZWFjaExpbmUuZ2V0KCdWVENEJykudG9TdHJpbmcoKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBtaS5vdXREYXRhLnB1dCgnVlRDRCcsIGVhY2hMaW5lLmdldCgnVlRDRCcpLnRvU3RyaW5nKCkpOw0KICAgICAgfQ0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0dSTVQnLCBlYWNoTGluZS5nZXQoJ0dSTVQnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdMTU9EJywgZWFjaExpbmUuZ2V0KCdNT0RMJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnTFRFRCcsIGVhY2hMaW5lLmdldCgnVEVETCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0xURUwnLCBlYWNoTGluZS5nZXQoJ1RFTDEnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdMUFNMJywgZWFjaExpbmUuZ2V0KCdQVVNMJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnTFBTVCcsIGVhY2hMaW5lLmdldCgnUFVTVCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BPUE4nLCBlYWNoTGluZS5nZXQoJ1BPUE5fRUExMycpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JPUkMnLCBlYWNoTGluZS5nZXQoJ1JPUkMnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdST1JOJywgZWFjaExpbmUuZ2V0KCdST1JOJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUk9STCcsIGVhY2hMaW5lLmdldCgnUk9STCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JPUlgnLCBlYWNoTGluZS5nZXQoJ1JPUlgnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdTVURPJywgZWFjaExpbmUuZ2V0KCdTVURPJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnRlJSQycsIGVhY2hMaW5lLmdldCgnRlJSQycpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0ZSUkUnLCBlYWNoTGluZS5nZXQoJ0ZSUkUnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBRFFBJywgZWFjaExpbmUuZ2V0KCdBRFFBJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnT1JRVCcsIGVhY2hMaW5lLmdldCgnT1JRVCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0FNT1AnLCBlYWNoTGluZS5nZXQoJ0Ftb3VudE9wZW4nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBTU9SJywgZWFjaExpbmUuZ2V0KCdMTkFNJykudG9TdHJpbmcoKSk7DQogICAgICAvL2lmIChlYWNoTGluZS5nZXQoJ0NQUFInKS50b1N0cmluZygpLmVxdWFscygnMC4wMDAwMDAnKSl7IAkJCQkJCQkgICAgICAgLy9jaGFuZ2VkIGJ5CSBzaGFzaGFuaw0KICAgICAgaWYgKERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NQUFInKS50b1N0cmluZygpKSA9PSAwKSB7IC8vQWRkZWQgYnkJIHNoYXNoYW5rIA0KICAgICAgICBtaS5vdXREYXRhLnB1dCgnUFJDRScsIGVhY2hMaW5lLmdldCgnUHJpY2VQZXJQaWVjZVN0YW5kYXJkVU0nKS50b1N0cmluZygpKTsgLy9BZGRlZCBieQkgc2hhc2hhbmsgDQogICAgICB9DQoNCiAgICAgIGlmIChEb3VibGUucGFyc2VEb3VibGUoZWFjaExpbmUuZ2V0KCdDUFBSJykudG9TdHJpbmcoKSkgIT0gMCAmJiBEb3VibGUucGFyc2VEb3VibGUoZWFjaExpbmUuZ2V0KCdDRkQxJykudG9TdHJpbmcoKSkgIT0gMCkgeyAvL0FkZGVkIGJ5CSBzaGFzaGFuaw0KICAgICAgICBtaS5vdXREYXRhLnB1dCgnUFJDRScsIChEb3VibGUucGFyc2VEb3VibGUoZWFjaExpbmUuZ2V0KCdDUFBSJykudG9TdHJpbmcoKSkgLSAoKChEb3VibGUucGFyc2VEb3VibGUoZWFjaExpbmUuZ2V0KCdDRkQxJykudG9TdHJpbmcoKSkpIC8gMTAwKSAqIChEb3VibGUucGFyc2VEb3VibGUoZWFjaExpbmUuZ2V0KCdDUFBSJykudG9TdHJpbmcoKSkpKSkudG9TdHJpbmcoKSk7IC8vQWRkZWQgYnkJIHNoYXNoYW5rDQoNCiAgICAgIH0NCg0KICAgICAgaWYgKERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NQUFInKS50b1N0cmluZygpKSAhPSAwICYmIERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NGRDInKS50b1N0cmluZygpKSAhPSAwKSB7IC8vQWRkZWQgYnkJIHNoYXNoYW5rDQogICAgICAgIG1pLm91dERhdGEucHV0KCdQUkNFJywgKERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NQUFInKS50b1N0cmluZygpKSAtICgoKERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NGRDInKS50b1N0cmluZygpKSkgLyAxMDApICogKERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NQUFInKS50b1N0cmluZygpKSkpKS50b1N0cmluZygpKTsgLy9BZGRlZCBieQkgc2hhc2hhbmsNCg0KICAgICAgfQ0KDQogICAgICBpZiAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpICE9IDAgJiYgRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ0ZEMycpLnRvU3RyaW5nKCkpICE9IDApIHsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1BSQ0UnLCAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpIC0gKCgoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ0ZEMycpLnRvU3RyaW5nKCkpKSAvIDEwMCkgKiAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpKSkpLnRvU3RyaW5nKCkpOyAvL0FkZGVkIGJ5CSBzaGFzaGFuayAgICANCiAgICAgIH0NCg0KICAgICAgaWYgKERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NQUFInKS50b1N0cmluZygpKSAhPSAwICYmIChEb3VibGUucGFyc2VEb3VibGUoZWFjaExpbmUuZ2V0KCdDRkQxJykudG9TdHJpbmcoKSkgPT0gMCAmJiBEb3VibGUucGFyc2VEb3VibGUoZWFjaExpbmUuZ2V0KCdDRkQyJykudG9TdHJpbmcoKSkgPT0gMCAmJiBEb3VibGUucGFyc2VEb3VibGUoZWFjaExpbmUuZ2V0KCdDRkQzJykudG9TdHJpbmcoKSkgPT0gMCkpIHsgLy9BZGRlZCBieQkgc2hhc2hhbmsNCg0KICAgICAgICBtaS5vdXREYXRhLnB1dCgnUFJDRScsIGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpOyAvL0FkZGVkIGJ5CSBzaGFzaGFuaw0KICAgICAgfSAvL0FkZGVkIGJ5CSBzaGFzaGFuaw0KDQogICAgICBtaS5vdXREYXRhLnB1dCgnVU5JVCcsIGVhY2hMaW5lLmdldCgnU3RhbmRhcmRVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ09QUVQnLCBlYWNoTGluZS5nZXQoJ09wZW5RdWFudGl0eVN0YW5kYXJkVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdRVElWJywgZWFjaExpbmUuZ2V0KCdJbnZvaWNlZFF1YW50aXR5U3RhbmRhcmRVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1FUT1InLCBlYWNoTGluZS5nZXQoJ09yZGVyZWRRdWFudGl0eVN0YW5kYXJkVU0nKS50b1N0cmluZygpKQ0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1FUUlYnLCBlYWNoTGluZS5nZXQoJ1JlY2VpdmVkUXVhbnRpdHlTdGFuZGFyZFVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQUxUVScsIGVhY2hMaW5lLmdldCgnQWx0ZXJuYXRlVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBTFFPJywgZWFjaExpbmUuZ2V0KCdBbHRlcm5hdGl2ZVF1YW50aXR5T3BlbicpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0FMVFAnLCBlYWNoTGluZS5nZXQoJ0FsdGVybmF0aXZlUHJpY2UnKS50b1N0cmluZygpKTsNCg0KICAgICAgbWkud3JpdGUoKTsNCiAgICB9DQogIH0NCiAgLyogcmV0cml2ZSBpdGVtIGFsaWFzIHVzaW5nIE1NUzAyNU1JLkdldEFsaWFzDQogICAqLw0KICBwdWJsaWMgZ2V0SXRlbUFsaWFzKEhhc2h0YWJsZSBlYWNoTGluZSkgew0KICAgIFN0cmluZyBJVE5PID0gZWFjaExpbmUuZ2V0KCdJVE5PJyk7DQoNCiAgICBib29sZWFuIHJlY29yZEV4aXN0cyA9IHRydWU7DQogICAgZGVmIGNhbGxiYWNrID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICBQT1BOX0VBMTMgPSByZXN1bHRzLmdldCgnUE9QTicpOw0KICAgICAgfQ0KDQogICAgfQ0KICAgIGRlZiBwYXJhbXMgPSBbIkNPTk8iOiBDT05PLCAiQUxXVCI6ICIwMiIsICJJVE5PIjogSVROTywgIkFMV1EiOiAiRUExMyJdOw0KICAgIG1pQ2FsbGVyLmNhbGwoIk1NUzAyNU1JIiwgIkdldEFsaWFzIiwgcGFyYW1zLCBjYWxsYmFjayk7DQoNCiAgfQ0KICAvKiBnZXQgcHVyY2hhc2Ugb3JkZXIgbGluZSBkZXRhaWxzIGZyb20gTVBMSU5FDQogICAqLw0KICBwdWJsaWMgZ2V0TVBMSU5FRGV0YWlscyhTdHJpbmcgZWFjaFBVTk8sIEhhc2h0YWJsZSBlYWNoTGluZSkgew0KICAgIFN0cmluZyBQTkxJID0gZWFjaExpbmUuZ2V0KCdQTkxJJyk7DQogICAgU3RyaW5nIFBOTFMgPSBlYWNoTGluZS5nZXQoJ1BOTFMnKTsNCiAgICBpZiAoUE5MSSAhPSBudWxsICYmICFQTkxJLnRyaW0oKS5lcXVhbHMoIiIpKSBQTkxJID0gU3RyaW5nLmZvcm1hdCgiJTAzZCIsIEludGVnZXIucGFyc2VJbnQoUE5MSS50cmltKCkpKTsNCiAgICBpZiAoUE5MUyAhPSBudWxsICYmICFQTkxTLnRyaW0oKS5lcXVhbHMoIiIpKSBQTkxTID0gU3RyaW5nLmZvcm1hdCgiJTAzZCIsIEludGVnZXIucGFyc2VJbnQoUE5MUy50cmltKCkpKTsNCiAgICBEQkFjdGlvbiBxdWVyeU1QTElORSA9IGRhdGFiYXNlLnRhYmxlKCJNUExJTkUiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIklCQ09OTyIsICJJQlBVTk8iLCAiSUJQTkxJIiwgIklCUE5MUyIsICJJQlNVRE8iLCAiSUJGUlJDIiwgIklCRlJSRSIpLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgcmVjb3JkTVBMSU5FID0gcXVlcnlNUExJTkUuZ2V0Q29udGFpbmVyKCk7DQogICAgcmVjb3JkTVBMSU5FLnNldCgiSUJDT05PIiwgSW50ZWdlci5wYXJzZUludChDT05PLnRyaW0oKSkpOw0KICAgIHJlY29yZE1QTElORS5zZXQoIklCUFVOTyIsIGVhY2hQVU5PLnRyaW0oKSk7DQogICAgcmVjb3JkTVBMSU5FLnNldCgiSUJQTkxJIiwgUE5MSS50cmltKCkudG9JbnRlZ2VyKCkpOw0KICAgIHJlY29yZE1QTElORS5zZXQoIklCUE5MUyIsIFBOTFMudHJpbSgpLnRvSW50ZWdlcigpKTsNCiAgICBxdWVyeU1QTElORS5yZWFkKHJlY29yZE1QTElORSk7DQoNCiAgICBlYWNoTGluZS5wdXQoJ1NVRE8nLCByZWNvcmRNUExJTkUuZ2V0KCdJQlNVRE8nKS50b1N0cmluZygpKTsNCiAgICBlYWNoTGluZS5wdXQoJ0ZSUkMnLCByZWNvcmRNUExJTkUuZ2V0KCdJQkZSUkMnKS50b1N0cmluZygpKTsNCiAgICBlYWNoTGluZS5wdXQoJ0ZSUkUnLCByZWNvcmRNUExJTkUuZ2V0KCdJQkZSUkUnKS50b1N0cmluZygpKTsNCg0KICB9DQoNCiAgcHVibGljIHVzZUNQUFJJZkF2YWlsYWJsZShIYXNodGFibGUgZWFjaExpbmUpIHsNCiAgICBTdHJpbmcgUFVQUiA9IGVhY2hMaW5lLmdldCgnUFVQUicpOw0KICAgIFN0cmluZyBDUFBSID0gZWFjaExpbmUuZ2V0KCdDUFBSJyk7DQoNCiAgICBEb3VibGUgZFBVUFIgPSAwLjBkOw0KICAgIC8vRG91YmxlIGRDUFBSID0gMC4wZDsNCg0KICAgIGlmIChQVVBSICE9IG51bGwgJiYgIVBVUFIudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkUFVQUiA9IERvdWJsZS5wYXJzZURvdWJsZShQVVBSLnRyaW0oKSk7DQogICAgaWYgKENQUFIgIT0gbnVsbCAmJiAhQ1BQUi50cmltKCkuZXF1YWxzKCIiKSkNCiAgICAgIGRDUFBSID0gRG91YmxlLnBhcnNlRG91YmxlKENQUFIudHJpbSgpKTsNCg0KICAgIGlmIChkQ1BQUiA+PSAwLjAwMDAwMCkNCiAgICAgIGVhY2hMaW5lLnJlcGxhY2UoJ1BVUFInLCAnQ1BQUicpOw0KICB9DQoNCiAgLyogY2hlY2sgUE8gb3JkZXIgcHJpY2UgYW5kIEJhc2ljIHVuaXQgb2YgbWVhc3VyZW1lbnQNCiAgICovDQogIHB1YmxpYyBjaGVja09yZGVyUHJpY2VBbmRCYXNlVW5pdHMoSGFzaHRhYmxlIGVhY2hMaW5lKSB7DQogICAgU3RyaW5nIFVOTVMgPSBlYWNoTGluZS5nZXQoJ1VOTVMnKTsNCiAgICBTdHJpbmcgUFVVTiA9IGVhY2hMaW5lLmdldCgnUFVVTicpOw0KICAgIFN0cmluZyBJVlFBID0gZWFjaExpbmUuZ2V0KCdJVlFBJyk7DQogICAgU3RyaW5nIFBQVU4gPSBlYWNoTGluZS5nZXQoJ1BQVU4nKTsNCiAgICBTdHJpbmcgT1JRQSA9IGVhY2hMaW5lLmdldCgnT1JRQScpOw0KICAgIFN0cmluZyBSVlFBID0gZWFjaExpbmUuZ2V0KCdSVlFBJyk7DQogICAgU3RyaW5nIFJWUVQgPSBlYWNoTGluZS5nZXQoJ1JWUVQnKTsNCiAgICBTdHJpbmcgT1JRVCA9IGVhY2hMaW5lLmdldCgnT1JRVCcpOw0KICAgIFN0cmluZyBMTkFNID0gZWFjaExpbmUuZ2V0KCdMTkFNJyk7DQogICAgU3RyaW5nIEFVVFAgPSBlYWNoTGluZS5nZXQoJ0FVVFAnKTsNCiAgICBTdHJpbmcgU3RhbmRhcmRVTSA9ICIiOw0KICAgIFN0cmluZyBBbHRlcm5hdGVVTSA9ICIiOw0KDQogICAgaWYgKFVOTVMudHJpbSgpLmVxdWFscyhQVVVOLnRyaW0oKSkpIHsNCiAgICAgIElWUVQgPSBJVlFBOw0KICAgICAgT3JkZXJVTV9EQ0NEID0gQmFzaWNVTV9EQ0NEID09IG51bGwgPyAiMCIgOiBCYXNpY1VNX0RDQ0QudHJpbSgpOw0KICAgICAgT3JkZXJVTV9ETUNGID0gIjEiOw0KICAgICAgT3JkZXJVTV9DT0ZBID0gIjEiOw0KICAgICAgZG91YmxlIGRibE9SUUEgPSBEb3VibGUucGFyc2VEb3VibGUoT1JRQSk7DQogICAgICBkb3VibGUgZGJsSVZRQSA9IERvdWJsZS5wYXJzZURvdWJsZShJVlFBKTsNCiAgICAgIGRvdWJsZSB2YWx1ZSA9IGRibE9SUUEgLSBkYmxJVlFBOw0KICAgICAgT3BlblF1YW50aXR5UHJpY2VVTSA9IG5ldyBCaWdEZWNpbWFsKFN0cmluZy52YWx1ZU9mKHZhbHVlKSkuc2V0U2NhbGUoNCwgQmlnRGVjaW1hbC5ST1VORF9GTE9PUikudG9QbGFpblN0cmluZygpOw0KICAgIH0gZWxzZSB7DQogICAgICBCaWdEZWNpbWFsIGludm9pY2VkUXVhbnRpdHkgPSBuZXcgQmlnRGVjaW1hbChJVlFBKTsNCiAgICAgIEJpZ0RlY2ltYWwgY29udmVyc2lvbkZhY3RvciA9IG5ldyBCaWdEZWNpbWFsKE9yZGVyVU1fQ09GQSk7DQoNCiAgICAgIGlmIChPcmRlclVNX0RNQ0YuZXF1YWxzKCIxIikpIHsNCiAgICAgICAgSVZRVCA9IGludm9pY2VkUXVhbnRpdHkubXVsdGlwbHkoY29udmVyc2lvbkZhY3Rvcikuc2V0U2NhbGUoNCwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIElWUVQgPSBpbnZvaWNlZFF1YW50aXR5LmRpdmlkZShjb252ZXJzaW9uRmFjdG9yLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkuc2V0U2NhbGUoNCwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgIH0NCiAgICB9DQoNCiAgICAvL29yZGVyIHVuaXQgZXF1YWxzIHByaWNlIHVuaXQNCiAgICBpZiAoUFVVTi50cmltKCkuZXF1YWxzKFBQVU4udHJpbSgpKSkgew0KICAgICAgT3JkZXJlZFF1YW50aXR5UHJpY2VVTSA9IE9SUUE7DQogICAgICBSZWNlaXZlZFF1YW50aXR5UHJpY2VVTSA9IFJWUUE7DQogICAgICBJbnZvaWNlZFF1YW50aXR5UHJpY2VVTSA9IElWUUE7DQoNCiAgICAgIGRvdWJsZSBkYmxPUlFBID0gRG91YmxlLnBhcnNlRG91YmxlKE9SUUEpOw0KICAgICAgZG91YmxlIGRibElWUUEgPSBEb3VibGUucGFyc2VEb3VibGUoSVZRQSk7DQogICAgICBkb3VibGUgdmFsdWUgPSBkYmxPUlFBIC0gZGJsSVZRQTsNCiAgICAgIE9wZW5RdWFudGl0eVByaWNlVU0gPSBuZXcgQmlnRGVjaW1hbChTdHJpbmcudmFsdWVPZih2YWx1ZSkpLnNldFNjYWxlKDQsIEJpZ0RlY2ltYWwuUk9VTkRfRkxPT1IpLnRvUGxhaW5TdHJpbmcoKTsNCg0KICAgIH0NCg0KICAgIC8vIHByaWNlIHVuaXQgZXF1YWxzIGJhc2UgdW5pdA0KICAgIGlmIChQUFVOLnRyaW0oKS5lcXVhbHMoVU5NUy50cmltKCkpKSB7DQogICAgICBPcmRlcmVkUXVhbnRpdHlQcmljZVVNID0gT1JRVDsNCiAgICAgIFJlY2VpdmVkUXVhbnRpdHlQcmljZVVNID0gUlZRVDsNCiAgICAgIEludm9pY2VkUXVhbnRpdHlQcmljZVVNID0gSVZRVDsNCg0KICAgICAgZG91YmxlIGRibE9SUVQgPSBEb3VibGUucGFyc2VEb3VibGUoT1JRVCk7DQogICAgICBkb3VibGUgZGJsSVZRVCA9IERvdWJsZS5wYXJzZURvdWJsZShJVlFUKTsNCiAgICAgIGRvdWJsZSB2YWx1ZSA9IGRibE9SUVQgLSBkYmxJVlFUOw0KICAgICAgT3BlblF1YW50aXR5UHJpY2VVTSA9IG5ldyBCaWdEZWNpbWFsKFN0cmluZy52YWx1ZU9mKHZhbHVlKSkuc2V0U2NhbGUoNCwgQmlnRGVjaW1hbC5ST1VORF9GTE9PUikudG9QbGFpblN0cmluZygpOw0KDQogICAgICBQcmljZVVNX0RDQ0QgPSBCYXNpY1VNX0RDQ0QgPT0gbnVsbCA/ICIwIiA6IEJhc2ljVU1fRENDRC50cmltKCk7DQogICAgICBQcmljZVVNX0RNQ0YgPSAiMSI7DQogICAgICBQcmljZVVNX0NPRkEgPSAiMSI7DQogICAgfQ0KDQogICAgLy9wcmljZSB1bml0IG5vdCBlcXVhbCB0byBiYXNlIGFuZCBvcmRlciB1bml0DQogICAgaWYgKCFQUFVOLnRyaW0oKS5lcXVhbHMoUFVVTi50cmltKCkpICYmICFQUFVOLnRyaW0oKS5lcXVhbHMoVU5NUy50cmltKCkpKSB7DQogICAgICBCaWdEZWNpbWFsIGludm9pY2VkUXVhbnRpdHkgPSBuZXcgQmlnRGVjaW1hbChJVlFUKTsNCiAgICAgIEJpZ0RlY2ltYWwgY29udmVyc2lvbkZhY3RvciA9IG5ldyBCaWdEZWNpbWFsKFByaWNlVU1fQ09GQSk7DQogICAgICBCaWdEZWNpbWFsIG9yZGVyZWRRdWFudGl0eSA9IG5ldyBCaWdEZWNpbWFsKE9SUVQpOw0KICAgICAgQmlnRGVjaW1hbCByZWNlaXZlZFF1YW50aXR5ID0gbmV3IEJpZ0RlY2ltYWwoUlZRVCk7DQogICAgICBpZiAoQVVUUF9hLmVxdWFscygiMSIpKSB7DQogICAgICAgIGlmIChQcmljZVVNX0RNQ0YuZXF1YWxzKCIxIikpIHsNCiAgICAgICAgICBJbnZvaWNlZFF1YW50aXR5UHJpY2VVTSA9IGludm9pY2VkUXVhbnRpdHkuZGl2aWRlKGNvbnZlcnNpb25GYWN0b3IsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS5zZXRTY2FsZShJbnRlZ2VyLnZhbHVlT2YoUHJpY2VVTV9EQ0NEKSwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICBPcmRlcmVkUXVhbnRpdHlQcmljZVVNID0gb3JkZXJlZFF1YW50aXR5LmRpdmlkZShjb252ZXJzaW9uRmFjdG9yLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkuc2V0U2NhbGUoSW50ZWdlci52YWx1ZU9mKFByaWNlVU1fRENDRCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgICAgUmVjZWl2ZWRRdWFudGl0eVByaWNlVU0gPSByZWNlaXZlZFF1YW50aXR5LmRpdmlkZShjb252ZXJzaW9uRmFjdG9yLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkuc2V0U2NhbGUoSW50ZWdlci52YWx1ZU9mKFByaWNlVU1fRENDRCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgICAgT3BlblF1YW50aXR5UHJpY2VVTSA9IG9yZGVyZWRRdWFudGl0eS5zdWJ0cmFjdChpbnZvaWNlZFF1YW50aXR5KS5kaXZpZGUoY29udmVyc2lvbkZhY3RvciwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnNldFNjYWxlKEludGVnZXIudmFsdWVPZihQcmljZVVNX0RDQ0QpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIEludm9pY2VkUXVhbnRpdHlQcmljZVVNID0gaW52b2ljZWRRdWFudGl0eS5tdWx0aXBseShjb252ZXJzaW9uRmFjdG9yKS5zZXRTY2FsZShJbnRlZ2VyLnZhbHVlT2YoUHJpY2VVTV9EQ0NEKSwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICBPcmRlcmVkUXVhbnRpdHlQcmljZVVNID0gb3JkZXJlZFF1YW50aXR5Lm11bHRpcGx5KGNvbnZlcnNpb25GYWN0b3IpLnNldFNjYWxlKEludGVnZXIudmFsdWVPZihQcmljZVVNX0RDQ0QpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICAgIFJlY2VpdmVkUXVhbnRpdHlQcmljZVVNID0gcmVjZWl2ZWRRdWFudGl0eS5tdWx0aXBseShjb252ZXJzaW9uRmFjdG9yKS5zZXRTY2FsZShJbnRlZ2VyLnZhbHVlT2YoUHJpY2VVTV9EQ0NEKSwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICAvL09wZW5RdWFudGl0eVByaWNlVU0gPSBvcmRlcmVkUXVhbnRpdHkuc3VidHJhY3QoaW52b2ljZWRRdWFudGl0eSkubXVsdGlwbHkoY29udmVyc2lvbkZhY3Rvcikuc2V0U2NhbGUoSW50ZWdlci52YWx1ZU9mKFByaWNlVU1fRENDRCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGlmIChBVVRQX2EuZXF1YWxzKCIyIikpIHsNCiAgICAgICAgaWYgKFByaWNlVU1fRE1DRi5lcXVhbHMoIjEiKSkgew0KICAgICAgICAgIEludm9pY2VkUXVhbnRpdHlQcmljZVVNID0gaW52b2ljZWRRdWFudGl0eS5kaXZpZGUoY29udmVyc2lvbkZhY3RvciwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnNldFNjYWxlKDIsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgICAgT3JkZXJlZFF1YW50aXR5UHJpY2VVTSA9IG9yZGVyZWRRdWFudGl0eS5kaXZpZGUoY29udmVyc2lvbkZhY3RvciwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnNldFNjYWxlKDIsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgICAgUmVjZWl2ZWRRdWFudGl0eVByaWNlVU0gPSByZWNlaXZlZFF1YW50aXR5LmRpdmlkZShjb252ZXJzaW9uRmFjdG9yLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkuc2V0U2NhbGUoMiwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICBPcGVuUXVhbnRpdHlQcmljZVVNID0gb3JkZXJlZFF1YW50aXR5LnN1YnRyYWN0KGludm9pY2VkUXVhbnRpdHkpLmRpdmlkZShjb252ZXJzaW9uRmFjdG9yLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIEludm9pY2VkUXVhbnRpdHlQcmljZVVNID0gaW52b2ljZWRRdWFudGl0eS5tdWx0aXBseShjb252ZXJzaW9uRmFjdG9yKS5zZXRTY2FsZSgyLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICAgIE9yZGVyZWRRdWFudGl0eVByaWNlVU0gPSBvcmRlcmVkUXVhbnRpdHkubXVsdGlwbHkoY29udmVyc2lvbkZhY3Rvcikuc2V0U2NhbGUoMiwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICBSZWNlaXZlZFF1YW50aXR5UHJpY2VVTSA9IHJlY2VpdmVkUXVhbnRpdHkubXVsdGlwbHkoY29udmVyc2lvbkZhY3Rvcikuc2V0U2NhbGUoMiwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICBPcGVuUXVhbnRpdHlQcmljZVVNID0gb3JkZXJlZFF1YW50aXR5LnN1YnRyYWN0KGludm9pY2VkUXVhbnRpdHkpLm11bHRpcGx5KGNvbnZlcnNpb25GYWN0b3IpLnNldFNjYWxlKDIsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBzZXQgb3BlblF1YW50aXR5T3JkZXJVTQ0KICAgIGRvdWJsZSBkYmxPUlFBID0gRG91YmxlLnBhcnNlRG91YmxlKE9SUUEpOw0KICAgIGRvdWJsZSBkYmxSVlFBID0gRG91YmxlLnBhcnNlRG91YmxlKFJWUUEpOw0KICAgIGRvdWJsZSBkYmxJVlFBID0gRG91YmxlLnBhcnNlRG91YmxlKElWUUEpOw0KICAgIGludCBpbnREQ0NEID0gSW50ZWdlci52YWx1ZU9mKE9yZGVyVU1fRENDRCk7DQogICAgZG91YmxlIHZhbHVlID0gZGJsUlZRQSAtIGRibElWUUE7DQogICAgT3BlblF1YW50aXR5T3JkZXJVTSA9IG5ldyBCaWdEZWNpbWFsKFN0cmluZy52YWx1ZU9mKHZhbHVlKSkuc2V0U2NhbGUoaW50RENDRCwgQmlnRGVjaW1hbC5ST1VORF9GTE9PUikudG9QbGFpblN0cmluZygpOw0KDQogICAgLy9jYWxjdWxhdGUgYW1vdW50IGFuZCBQcmljZVVNX0RDQ0QNCiAgICBPcGVuUXVhbnRpdHlPcmRlclVNID0gT3BlblF1YW50aXR5T3JkZXJVTSA9PSBudWxsID8gIiIgOiBPcGVuUXVhbnRpdHlPcmRlclVNLnRyaW0oKTsNCiAgICBMTkFNID0gTE5BTSA9PSBudWxsID8gIiIgOiBMTkFNLnRyaW0oKTsNCiAgICBPcmRlcmVkUXVhbnRpdHlQcmljZVVNID0gT3JkZXJlZFF1YW50aXR5UHJpY2VVTSA9PSBudWxsID8gIiIgOiBPcmRlcmVkUXVhbnRpdHlQcmljZVVNLnRyaW0oKTsNCiAgICBPUlFBID0gT1JRQSA9PSBudWxsID8gIiIgOiBPUlFBLnRyaW0oKTsNCg0KICAgIEJpZ0RlY2ltYWwgb3BlblF1YW50aXR5T3JkZXJVTTsNCg0KICAgIGlmIChPcGVuUXVhbnRpdHlPcmRlclVNLmVxdWFscygiIikpIHsNCiAgICAgIG9wZW5RdWFudGl0eU9yZGVyVU0gPSBuZXcgQmlnRGVjaW1hbCgiMCIpOw0KICAgIH0gZWxzZSB7DQogICAgICBvcGVuUXVhbnRpdHlPcmRlclVNID0gbmV3IEJpZ0RlY2ltYWwoT3BlblF1YW50aXR5T3JkZXJVTSk7DQogICAgfQ0KDQogICAgQmlnRGVjaW1hbCBuZXR0TGluZUFtb3VudDsNCg0KICAgIGlmIChMTkFNLmVxdWFscygiIikpIHsNCiAgICAgIG5ldHRMaW5lQW1vdW50ID0gbmV3IEJpZ0RlY2ltYWwoIjAuMCIpOw0KICAgIH0gZWxzZSB7DQogICAgICBuZXR0TGluZUFtb3VudCA9IG5ldyBCaWdEZWNpbWFsKExOQU0pOw0KICAgIH0NCg0KICAgIEJpZ0RlY2ltYWwgb3JkZXJlZFF1YW50aXR5UHJpY2VVTTsNCg0KICAgIGlmIChPcmRlcmVkUXVhbnRpdHlQcmljZVVNLmVxdWFscygiIikpIHsNCiAgICAgIG9yZGVyZWRRdWFudGl0eVByaWNlVU0gPSBuZXcgQmlnRGVjaW1hbCgiMCIpOw0KICAgIH0gZWxzZSB7DQogICAgICBvcmRlcmVkUXVhbnRpdHlQcmljZVVNID0gbmV3IEJpZ0RlY2ltYWwoT3JkZXJlZFF1YW50aXR5UHJpY2VVTSk7DQogICAgfQ0KDQogICAgQmlnRGVjaW1hbCBvcmRlcmVkUXVhbnRpdHk7DQoNCiAgICBpZiAoT1JRQS5lcXVhbHMoIiIpKSB7DQogICAgICBvcmRlcmVkUXVhbnRpdHkgPSBuZXcgQmlnRGVjaW1hbCgiMCIpOw0KICAgIH0gZWxzZSB7DQogICAgICBvcmRlcmVkUXVhbnRpdHkgPSBuZXcgQmlnRGVjaW1hbChPUlFBKTsNCiAgICB9DQoNCiAgICBCaWdEZWNpbWFsIHByaWNlUGVyUGllY2VPcmRlclVNOw0KICAgIGlmIChuZXR0TGluZUFtb3VudC5jb21wYXJlVG8oQmlnRGVjaW1hbC5aRVJPKSA9PSAwIHx8IG9yZGVyZWRRdWFudGl0eS5jb21wYXJlVG8oQmlnRGVjaW1hbC5aRVJPKSA9PSAwKSB7DQogICAgICBwcmljZVBlclBpZWNlT3JkZXJVTSA9IG5ldyBCaWdEZWNpbWFsKCIwLjAiKTsNCiAgICB9IGVsc2Ugew0KICAgICAgcHJpY2VQZXJQaWVjZU9yZGVyVU0gPSBuZXR0TGluZUFtb3VudC5kaXZpZGUob3JkZXJlZFF1YW50aXR5LCBudW1iZXJPZkRlY2ltYWxzLnRvSW50ZWdlcigpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCk7DQogICAgfQ0KDQogICAgQmlnRGVjaW1hbCBwcmljZVBlclBpZWNlUHJpY2VVTTsNCg0KICAgIGlmIChvcmRlcmVkUXVhbnRpdHkuY29tcGFyZVRvKEJpZ0RlY2ltYWwuWkVSTykgPT0gMCB8fCBvcmRlcmVkUXVhbnRpdHlQcmljZVVNLmNvbXBhcmVUbyhCaWdEZWNpbWFsLlpFUk8pID09IDApIHsNCiAgICAgIHByaWNlUGVyUGllY2VQcmljZVVNID0gbmV3IEJpZ0RlY2ltYWwoIjAuMCIpOw0KICAgIH0gZWxzZSB7DQogICAgICBwcmljZVBlclBpZWNlUHJpY2VVTSA9IG9yZGVyZWRRdWFudGl0eS5kaXZpZGUob3JkZXJlZFF1YW50aXR5UHJpY2VVTSwgMTIsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS5tdWx0aXBseShwcmljZVBlclBpZWNlT3JkZXJVTSk7DQogICAgfQ0KDQogICAgQW1vdW50T3BlbiA9IG9wZW5RdWFudGl0eU9yZGVyVU0ubXVsdGlwbHkocHJpY2VQZXJQaWVjZU9yZGVyVU0pLnNldFNjYWxlKG51bWJlck9mRGVjaW1hbHMudG9JbnRlZ2VyKCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQoNCiAgICBQcmljZVBlclBpZWNlUHJpY2VVTSA9IHByaWNlUGVyUGllY2VQcmljZVVNLnNldFNjYWxlKG51bWJlck9mRGVjaW1hbHMudG9JbnRlZ2VyKCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgUHJpY2VQZXJQaWVjZU9yZGVyVU0gPSBwcmljZVBlclBpZWNlT3JkZXJVTS5zZXRTY2FsZShudW1iZXJPZkRlY2ltYWxzLnRvSW50ZWdlcigpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KDQogICAgaWYgKHByaWNlVW5pdFN0YW5kYXJkLnRyaW0oKS5lcXVhbHMoIjEiKSkgew0KICAgICAgU3RhbmRhcmRVTSA9IFBQVU4udHJpbSgpOw0KICAgICAgQWx0ZXJuYXRlVU0gPSBQVVVOLnRyaW0oKTsNCiAgICAgIFByaWNlUGVyUGllY2VTdGFuZGFyZFVNID0gUHJpY2VQZXJQaWVjZVByaWNlVU0gPT0gbnVsbCA/ICIiIDogUHJpY2VQZXJQaWVjZVByaWNlVU0udHJpbSgpOw0KICAgICAgT3BlblF1YW50aXR5U3RhbmRhcmRVTSA9IE9wZW5RdWFudGl0eVByaWNlVU0gPT0gbnVsbCA/ICIiIDogT3BlblF1YW50aXR5UHJpY2VVTS50cmltKCk7DQogICAgICBJbnZvaWNlZFF1YW50aXR5U3RhbmRhcmRVTSA9IEludm9pY2VkUXVhbnRpdHlQcmljZVVNID09IG51bGwgPyAiIiA6IEludm9pY2VkUXVhbnRpdHlQcmljZVVNLnRyaW0oKTsNCiAgICAgIE9yZGVyZWRRdWFudGl0eVN0YW5kYXJkVU0gPSBPcmRlcmVkUXVhbnRpdHlQcmljZVVNID09IG51bGwgPyAiIiA6IE9yZGVyZWRRdWFudGl0eVByaWNlVU0udHJpbSgpOw0KICAgICAgUmVjZWl2ZWRRdWFudGl0eVN0YW5kYXJkVU0gPSBSZWNlaXZlZFF1YW50aXR5UHJpY2VVTSA9PSBudWxsID8gIiIgOiBSZWNlaXZlZFF1YW50aXR5UHJpY2VVTS50cmltKCk7DQoNCiAgICAgIEFsdGVybmF0aXZlUXVhbnRpdHlPcGVuID0gT3BlblF1YW50aXR5T3JkZXJVTTsNCiAgICAgIEFsdGVybmF0aXZlUHJpY2UgPSBQcmljZVBlclBpZWNlT3JkZXJVTTsNCg0KICAgIH0gZWxzZSB7DQogICAgICBTdGFuZGFyZFVNID0gUFVVTi50cmltKCk7DQogICAgICBBbHRlcm5hdGVVTSA9IFBQVU4udHJpbSgpOw0KICAgICAgUHJpY2VQZXJQaWVjZVN0YW5kYXJkVU0gPSBQcmljZVBlclBpZWNlUHJpY2VVTSA9PSBudWxsID8gIiIgOiBQcmljZVBlclBpZWNlUHJpY2VVTS50cmltKCk7DQogICAgICBPcGVuUXVhbnRpdHlTdGFuZGFyZFVNID0gT3BlblF1YW50aXR5UHJpY2VVTSA9PSBudWxsID8gIiIgOiBPcGVuUXVhbnRpdHlQcmljZVVNLnRyaW0oKTsNCiAgICAgIEludm9pY2VkUXVhbnRpdHlTdGFuZGFyZFVNID0gSVZRQSA9PSBudWxsID8gIiIgOiBJVlFBLnRyaW0oKTsNCiAgICAgIE9yZGVyZWRRdWFudGl0eVN0YW5kYXJkVU0gPSBPUlFBID09IG51bGwgPyAiIiA6IE9SUUEudHJpbSgpOw0KICAgICAgUmVjZWl2ZWRRdWFudGl0eVN0YW5kYXJkVU0gPSBSVlFBID09IG51bGwgPyAiIiA6IFJWUUEudHJpbSgpOw0KDQogICAgICBBbHRlcm5hdGl2ZVF1YW50aXR5T3BlbiA9IE9wZW5RdWFudGl0eVByaWNlVU07DQogICAgICBBbHRlcm5hdGl2ZVByaWNlID0gUHJpY2VQZXJQaWVjZVByaWNlVU07DQogICAgfQ0KICAgIGVhY2hMaW5lLnB1dCgnQW1vdW50T3BlbicsIEFtb3VudE9wZW4pOw0KICAgIGVhY2hMaW5lLnB1dCgnUHJpY2VQZXJQaWVjZVN0YW5kYXJkVU0nLCBQcmljZVBlclBpZWNlU3RhbmRhcmRVTSk7DQogICAgZWFjaExpbmUucHV0KCdTdGFuZGFyZFVNJywgU3RhbmRhcmRVTSk7DQogICAgZWFjaExpbmUucHV0KCdPcGVuUXVhbnRpdHlTdGFuZGFyZFVNJywgT3BlblF1YW50aXR5U3RhbmRhcmRVTSk7DQogICAgZWFjaExpbmUucHV0KCdJbnZvaWNlZFF1YW50aXR5U3RhbmRhcmRVTScsIEludm9pY2VkUXVhbnRpdHlTdGFuZGFyZFVNKTsNCiAgICBlYWNoTGluZS5wdXQoJ09yZGVyZWRRdWFudGl0eVN0YW5kYXJkVU0nLCBPcmRlcmVkUXVhbnRpdHlTdGFuZGFyZFVNKTsNCiAgICBlYWNoTGluZS5wdXQoJ1JlY2VpdmVkUXVhbnRpdHlTdGFuZGFyZFVNJywgUmVjZWl2ZWRRdWFudGl0eVN0YW5kYXJkVU0pOw0KICAgIGVhY2hMaW5lLnB1dCgnQWx0ZXJuYXRlVU0nLCBBbHRlcm5hdGVVTSk7DQogICAgZWFjaExpbmUucHV0KCdBbHRlcm5hdGl2ZVF1YW50aXR5T3BlbicsIEFsdGVybmF0aXZlUXVhbnRpdHlPcGVuKTsNCiAgICBlYWNoTGluZS5wdXQoJ0FsdGVybmF0aXZlUHJpY2UnLCBBbHRlcm5hdGl2ZVByaWNlKTsNCiAgICBlYWNoTGluZS5wdXQoJ09wZW5RdWFudGl0eVByaWNlVU0nLCBPcGVuUXVhbnRpdHlQcmljZVVNKTsNCiAgICBlYWNoTGluZS5wdXQoJ1BPUE5fRUExMycsIFBPUE5fRUExMyk7DQogIH0NCg0KICAvKiBnZXQgUE8gbGluZSByZWNlaXB0IGRldGFpbHMgZnJvbSB0YWJsZSBGR1JFQ0wNCiAgICovDQoNCiAgcHVibGljIGdldExpbmVSZWNlaXB0cyhTdHJpbmcgZWFjaFBVTk8sIEhhc2h0YWJsZSBlYWNoTGluZSkgew0KICAgIGxpbmVSZWNlaXB0TGlzdCA9IG5ldyBBcnJheUxpc3QgPCBIYXNodGFibGUgPiAoKTsNCiAgICBEQkFjdGlvbiBxdWVyeUZHUkVDTCA9IGRhdGFiYXNlLnRhYmxlKCJGR1JFQ0wiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIkYyQ09OTyIsICJGMkRJVkkiLCAiRjJQVU5PIiwgIkYyUE5MSSIsICJGMlBOTFMiLCAiRjJSRVBOIiwgIkYyUkVMUCIsICJGMlJQUVQiLCAiRjJJVlFUIiwgIkYyUlBRQSIsICJGMklWUUEiLCAiRjJDQVdFIiwgIkYySVZDVyIsICJGMlJDQUMiLCAiRjJJQ0FDIiwgIkYyU0NPUCIsICJGMlNDT0MiLCAiRjJJTVNUIiwgIkYyVFJEVCIsICJGMlNFUkEiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIHJlY29yZEZHUkVDTCA9IHF1ZXJ5RkdSRUNMLmdldENvbnRhaW5lcigpOw0KICAgIHJlY29yZEZHUkVDTC5zZXQoIkYyQ09OTyIsIEludGVnZXIucGFyc2VJbnQoQ09OTy50cmltKCkpKTsNCiAgICByZWNvcmRGR1JFQ0wuc2V0KCJGMkRJVkkiLCBvRElWSS50cmltKCkpOw0KICAgIHJlY29yZEZHUkVDTC5zZXQoIkYyUFVOTyIsIGVhY2hQVU5PLnRyaW0oKSk7DQogICAgcmVjb3JkRkdSRUNMLnNldCgiRjJQTkxJIiwgZWFjaExpbmUuZ2V0KCdQTkxJJykudG9TdHJpbmcoKS50b0ludGVnZXIoKSk7DQogICAgcmVjb3JkRkdSRUNMLnNldCgiRjJQTkxTIiwgZWFjaExpbmUuZ2V0KCdQTkxTJykudG9TdHJpbmcoKS50b0ludGVnZXIoKSk7DQogICAgLy8gcmVhZCBsb2NrIGFuZCBjYWxsIGNyZWF0ZVJlY29yZHMoKQ0KICAgIGludCByZWFkcyA9IHF1ZXJ5RkdSRUNMLnJlYWRBbGwocmVjb3JkRkdSRUNMLCA1LCBnZXRGR1JFQ0xSZWNvcmRzKTsNCiAgfQ0KDQogIENsb3N1cmUgPCA/ID4gZ2V0RkdSRUNMUmVjb3JkcyA9IHsNCiAgICBEQkNvbnRhaW5lciByZWNvcmQgLT4NCiAgICBTdHJpbmcgRjJSRVBOID0gcmVjb3JkLmdldCgnRjJSRVBOJyk7DQogICAgU3RyaW5nIEYyUkVMUCA9IHJlY29yZC5nZXQoJ0YyUkVMUCcpOw0KICAgIFN0cmluZyBGMlJQUVQgPSByZWNvcmQuZ2V0KCdGMlJQUVQnKTsNCiAgICBTdHJpbmcgRjJJVlFUID0gcmVjb3JkLmdldCgnRjJJVlFUJyk7DQogICAgU3RyaW5nIEYyUlBRQSA9IHJlY29yZC5nZXQoJ0YyUlBRQScpOw0KICAgIFN0cmluZyBGMklWUUEgPSByZWNvcmQuZ2V0KCdGMklWUUEnKTsNCiAgICBTdHJpbmcgRjJDQVdFID0gcmVjb3JkLmdldCgnRjJDQVdFJyk7DQogICAgU3RyaW5nIEYySVZDVyA9IHJlY29yZC5nZXQoJ0YySVZDVycpOw0KICAgIFN0cmluZyBGMlJDQUMgPSByZWNvcmQuZ2V0KCdGMlJDQUMnKTsNCiAgICBTdHJpbmcgRjJJQ0FDID0gcmVjb3JkLmdldCgnRjJJQ0FDJyk7DQogICAgU3RyaW5nIEYyU0NPUCA9IHJlY29yZC5nZXQoJ0YyU0NPUCcpOw0KICAgIFN0cmluZyBGMlNDT0MgPSByZWNvcmQuZ2V0KCdGMlNDT0MnKTsNCiAgICBTdHJpbmcgRjJJTVNUID0gcmVjb3JkLmdldCgnRjJJTVNUJyk7DQogICAgU3RyaW5nIEYyVFJEVCA9IHJlY29yZC5nZXQoJ0YyVFJEVCcpOw0KICAgIFN0cmluZyBGMlNFUkEgPSByZWNvcmQuZ2V0KCdGMlNFUkEnKTsNCiAgICBIYXNodGFibGUgdGVtcFRhYmxlID0gbmV3IEhhc2h0YWJsZSA8IFN0cmluZywNCiAgICBTdHJpbmcgPiAoKTsNCiAgICB0ZW1wVGFibGUucHV0KCdGMlJFUE4nLCBGMlJFUE4pOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0YyUkVMUCcsIEYyUkVMUCk7DQogICAgdGVtcFRhYmxlLnB1dCgnRjJSUFFUJywgRjJSUFFUKTsNCiAgICB0ZW1wVGFibGUucHV0KCdGMklWUVQnLCBGMklWUVQpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0YyUlBRQScsIEYyUlBRQSk7DQogICAgdGVtcFRhYmxlLnB1dCgnRjJJVlFBJywgRjJJVlFBKTsNCiAgICB0ZW1wVGFibGUucHV0KCdGMkNBV0UnLCBGMkNBV0UpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0YySVZDVycsIEYySVZDVyk7DQogICAgdGVtcFRhYmxlLnB1dCgnRjJSQ0FDJywgRjJSQ0FDKTsNCiAgICB0ZW1wVGFibGUucHV0KCdGMklDQUMnLCBGMklDQUMpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0YyU0NPUCcsIEYyU0NPUCk7DQogICAgdGVtcFRhYmxlLnB1dCgnRjJTQ09DJywgRjJTQ09DKTsNCiAgICB0ZW1wVGFibGUucHV0KCdGMklNU1QnLCBGMklNU1QpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0YyVFJEVCcsIEYyVFJEVCk7DQogICAgdGVtcFRhYmxlLnB1dCgnRjJTRVJBJywgRjJTRVJBKTsNCiAgICBsaW5lUmVjZWlwdExpc3QuYWRkKHRlbXBUYWJsZSk7DQoNCiAgfQ0KICAvKiBjYWxjdWxhdGUgUE8gbGluZSByZWNlaXB0IHF1YW50aXRpZXMNCiAgICovDQogIHB1YmxpYyBjYWxjdWxhdGVSZWNlaXB0UXVhbnRpdGllcyhIYXNodGFibGUgZWFjaExpbmVSZWNlaXB0LCBIYXNodGFibGUgZWFjaExpbmUpIHsNCiAgICBTdHJpbmcgUFBVTiA9IGVhY2hMaW5lLmdldCgnUFBVTicpOw0KICAgIFN0cmluZyBQVVVOID0gZWFjaExpbmUuZ2V0KCdQVVVOJyk7DQogICAgU3RyaW5nIFVOTVMgPSBlYWNoTGluZS5nZXQoJ1VOTVMnKTsNCg0KICAgIFN0cmluZyBGMlJFUE4gPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMlJFUE4nKTsNCiAgICBTdHJpbmcgRjJSRUxQID0gZWFjaExpbmVSZWNlaXB0LmdldCgnRjJSRUxQJyk7DQogICAgU3RyaW5nIEYyUlBRVCA9IGVhY2hMaW5lUmVjZWlwdC5nZXQoJ0YyUlBRVCcpOw0KICAgIFN0cmluZyBGMklWUVQgPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMklWUVQnKTsNCiAgICBTdHJpbmcgRjJSUFFBID0gZWFjaExpbmVSZWNlaXB0LmdldCgnRjJSUFFBJyk7DQogICAgU3RyaW5nIEYySVZRQSA9IGVhY2hMaW5lUmVjZWlwdC5nZXQoJ0YySVZRQScpOw0KICAgIFN0cmluZyBGMkNBV0UgPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMkNBV0UnKTsNCiAgICBTdHJpbmcgRjJJVkNXID0gZWFjaExpbmVSZWNlaXB0LmdldCgnRjJJVkNXJyk7DQogICAgU3RyaW5nIEYyUkNBQyA9IGVhY2hMaW5lUmVjZWlwdC5nZXQoJ0YyUkNBQycpOw0KICAgIFN0cmluZyBGMklDQUMgPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMklDQUMnKTsNCiAgICBTdHJpbmcgRjJTQ09QID0gZWFjaExpbmVSZWNlaXB0LmdldCgnRjJTQ09QJyk7DQogICAgU3RyaW5nIEYyU0NPQyA9IGVhY2hMaW5lUmVjZWlwdC5nZXQoJ0YyU0NPQycpOw0KICAgIFN0cmluZyBGMklNU1QgPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMklNU1QnKTsNCiAgICBTdHJpbmcgRjJUUkRUID0gZWFjaExpbmVSZWNlaXB0LmdldCgnRjJUUkRUJyk7DQogICAgU3RyaW5nIEYyU0VSQSA9IGVhY2hMaW5lUmVjZWlwdC5nZXQoJ0YyU0VSQScpOw0KDQogICAgUFBVTiA9IFBQVU4gPT0gbnVsbCA/ICIiIDogUFBVTi50cmltKCk7DQogICAgUFVVTiA9IFBVVU4gPT0gbnVsbCA/ICIiIDogUFVVTi50cmltKCk7DQogICAgVU5NUyA9IFVOTVMgPT0gbnVsbCA/ICIiIDogVU5NUy50cmltKCk7DQogICAgUHJpY2VVTV9DT0ZBID0gUHJpY2VVTV9DT0ZBID09IG51bGwgPyAiMSIgOiBQcmljZVVNX0NPRkEudHJpbSgpOw0KICAgIFByaWNlVU1fRE1DRiA9IFByaWNlVU1fRE1DRiA9PSBudWxsID8gIjEiIDogUHJpY2VVTV9ETUNGLnRyaW0oKTsNCg0KICAgIFN0cmluZyBSZWNlaXZlZFF1YW50aXR5QWx0VU0gPSAiIjsNCiAgICBTdHJpbmcgT3BlblF1YW50aXR5T3JkZXJVTSA9ICIiOw0KICAgIFN0cmluZyBPcGVuQ2F0Y2hXZWlnaHQgPSAiIjsNCiAgICBTdHJpbmcgT3BlblF1YW50aXR5UHVyY2hhc2VPcmRlclByaWNlVU0gPSAiIjsNCiAgICBTdHJpbmcgT3BlbkFtb3VudExvY2FsQ3VycmVuY3kgPSAiIjsNCiAgICBTdHJpbmcgT3BlbkFtb3VudE9yZGVyVU0gPSAiIjsNCiAgICBTdHJpbmcgUmVjZWl2ZWRRdWFudGl0eSA9ICIiOw0KDQogICAgQmlnRGVjaW1hbCBkRjJSUFFUID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJJVlFUID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJSUFFBID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJJVlFBID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJDQVdFID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJJVkNXID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJSQ0FDID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJJQ0FDID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJTQ09QID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJTQ09DID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQogICAgQmlnRGVjaW1hbCBkRjJTRVJBID0gbmV3IEJpZ0RlY2ltYWwoMC4wZCk7DQoNCiAgICBCaWdEZWNpbWFsIGRDT0ZBID0gbmV3IEJpZ0RlY2ltYWwoUHJpY2VVTV9DT0ZBKTsNCg0KICAgIGludCBpbnRPcmRlclVNX0RDQ0QgPSBudW1iZXJPZkRlY2ltYWxzLnRvSW50ZWdlcigpOw0KICAgIGludCBpbnRQcmljZVVNX0RDQ0QgPSBudW1iZXJPZkRlY2ltYWxzLnRvSW50ZWdlcigpOw0KICAgIGludCBpbnRCYXNpY1VNX0RDQ0QgPSBudW1iZXJPZkRlY2ltYWxzLnRvSW50ZWdlcigpOw0KDQogICAgaWYgKEYyQ0FXRSAhPSBudWxsICYmICFGMkNBV0UudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJDQVdFID0gbmV3IEJpZ0RlY2ltYWwoRjJDQVdFLnRyaW0oKSk7DQogICAgaWYgKEYyUlBRVCAhPSBudWxsICYmICFGMlJQUVQudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJSUFFUID0gbmV3IEJpZ0RlY2ltYWwoRjJSUFFULnRyaW0oKSk7DQogICAgaWYgKEYySVZRVCAhPSBudWxsICYmICFGMklWUVQudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJJVlFUID0gbmV3IEJpZ0RlY2ltYWwoRjJJVlFULnRyaW0oKSk7DQogICAgaWYgKEYyUlBRQSAhPSBudWxsICYmICFGMlJQUUEudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJSUFFBID0gbmV3IEJpZ0RlY2ltYWwoRjJSUFFBLnRyaW0oKSk7DQogICAgaWYgKEYySVZRQSAhPSBudWxsICYmICFGMklWUUEudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJJVlFBID0gbmV3IEJpZ0RlY2ltYWwoRjJJVlFBLnRyaW0oKSk7DQogICAgaWYgKEYySVZDVyAhPSBudWxsICYmICFGMklWQ1cudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJJVkNXID0gbmV3IEJpZ0RlY2ltYWwoRjJJVkNXLnRyaW0oKSk7DQogICAgaWYgKEYyUkNBQyAhPSBudWxsICYmICFGMlJDQUMudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJSQ0FDID0gbmV3IEJpZ0RlY2ltYWwoRjJSQ0FDLnRyaW0oKSk7DQogICAgaWYgKEYySUNBQyAhPSBudWxsICYmICFGMklDQUMudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJJQ0FDID0gbmV3IEJpZ0RlY2ltYWwoRjJJQ0FDLnRyaW0oKSk7DQogICAgaWYgKEYyU0NPUCAhPSBudWxsICYmICFGMlNDT1AudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJTQ09QID0gbmV3IEJpZ0RlY2ltYWwoRjJTQ09QLnRyaW0oKSk7DQogICAgaWYgKEYyU0NPQyAhPSBudWxsICYmICFGMlNDT0MudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJTQ09DID0gbmV3IEJpZ0RlY2ltYWwoRjJTQ09DLnRyaW0oKSk7DQogICAgaWYgKEYyU0VSQSAhPSBudWxsICYmICFGMlNFUkEudHJpbSgpLmVxdWFscygiIikpDQogICAgICBkRjJTRVJBID0gbmV3IEJpZ0RlY2ltYWwoRjJTRVJBLnRyaW0oKSk7DQogICAgaWYgKE9yZGVyVU1fRENDRCAhPSBudWxsICYmICFPcmRlclVNX0RDQ0QudHJpbSgpLmVxdWFscygiIikpDQogICAgICBpbnRPcmRlclVNX0RDQ0QgPSBJbnRlZ2VyLnZhbHVlT2YoT3JkZXJVTV9EQ0NELnRyaW0oKSk7DQogICAgaWYgKFByaWNlVU1fRENDRCAhPSBudWxsICYmICFQcmljZVVNX0RDQ0QudHJpbSgpLmVxdWFscygiIikpDQogICAgICBpbnRQcmljZVVNX0RDQ0QgPSBJbnRlZ2VyLnZhbHVlT2YoUHJpY2VVTV9EQ0NELnRyaW0oKSk7DQogICAgaWYgKEJhc2ljVU1fRENDRCAhPSBudWxsICYmICFCYXNpY1VNX0RDQ0QudHJpbSgpLmVxdWFscygiIikpDQogICAgICBpbnRCYXNpY1VNX0RDQ0QgPSBJbnRlZ2VyLnZhbHVlT2YoQmFzaWNVTV9EQ0NELnRyaW0oKSk7DQoNCiAgICBpZiAoZEYyQ0FXRS5jb21wYXJlVG8obmV3IEJpZ0RlY2ltYWwoMC4wZCkpICE9IDApIC8qIGlmIGNhdGNod2VpZ2h0IGl0ZW0gKi8gew0KICAgICAgUmVjZWl2ZWRRdWFudGl0eUFsdFVNID0gRjJDQVdFOw0KICAgICAgT3BlbkNhdGNoV2VpZ2h0ID0gZEYyQ0FXRS5zdWJ0cmFjdChkRjJJVkNXKS5zZXRTY2FsZShudW1iZXJPZkRlY2ltYWxzLnRvSW50ZWdlcigpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgUmVjZWl2ZWRRdWFudGl0eSA9IGRGMlJQUVQuc3VidHJhY3QoZEYySVZRVCkuc2V0U2NhbGUoaW50QmFzaWNVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgT3BlblF1YW50aXR5T3JkZXJVTSA9IGRGMlJQUUEuc3VidHJhY3QoZEYySVZRQSkuc2V0U2NhbGUoaW50QmFzaWNVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgIH0gZWxzZSBpZiAoUFBVTi5lcXVhbHMoUFVVTikpIC8qIGlmIHByaWNlIHVuaXQgaXMgZXF1YWwgdG8gb3JkZXIgdW5pdCAqLyB7DQogICAgICAvL29SZWNlaXZlZFF1YW50aXR5QWx0VU0gPSBEb3VibGUudG9TdHJpbmcobmV3IEJpZ0RlY2ltYWwoKGRGMlJQUUEgLSBkRjJJVlFBKSkuc2V0U2NhbGUoTnVtYmVyT2ZEZWNpbWFscywgUm91bmRpbmdNb2RlLkhBTEZfVVApLmRvdWJsZVZhbHVlKCkpOw0KICAgICAgUmVjZWl2ZWRRdWFudGl0eUFsdFVNID0gZEYyUlBRQS5zdWJ0cmFjdChkRjJJVlFBKS5zZXRTY2FsZShpbnRPcmRlclVNX0RDQ0QsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICBSZWNlaXZlZFF1YW50aXR5ID0gZEYyUlBRVC5zdWJ0cmFjdChkRjJJVlFUKS5zZXRTY2FsZShpbnRCYXNpY1VNX0RDQ0QsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICBPcGVuUXVhbnRpdHlPcmRlclVNID0gZEYyUlBRQS5zdWJ0cmFjdChkRjJJVlFBKS5zZXRTY2FsZShpbnRCYXNpY1VNX0RDQ0QsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgfSBlbHNlIGlmICghUFBVTi5lcXVhbHMoUFVVTikgJiYgIVBQVU4uZXF1YWxzKFVOTVMpKSAvKiBpZiBwcmljZSB1bml0IGlzIG5vdCBlcXVhbCB0byBvcmRlciB1bml0IGFuZCBub3QgZXF1YWwgdG8gYmFzZSB1bml0Ki8gew0KICAgICAgLy9vUmVjZWl2ZWRRdWFudGl0eUFsdFVNID0gRG91YmxlLnRvU3RyaW5nKG5ldyBCaWdEZWNpbWFsKChkRjJSUFFBIC0gZEYySVZRQSkpLnNldFNjYWxlKE51bWJlck9mRGVjaW1hbHMsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS5kb3VibGVWYWx1ZSgpKTsNCiAgICAgIGlmIChQcmljZVVNX0RNQ0YuZXF1YWxzKCIxIikpIHsNCiAgICAgICAgUmVjZWl2ZWRRdWFudGl0eUFsdFVNID0gZEYyUlBRVC5zdWJ0cmFjdChkRjJJVlFUKS5kaXZpZGUoZENPRkEsIGludFByaWNlVU1fRENDRCwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgIH0gZWxzZSBpZiAoUHJpY2VVTV9ETUNGLmVxdWFscygiMiIpKSB7DQogICAgICAgIFJlY2VpdmVkUXVhbnRpdHlBbHRVTSA9IGRGMlJQUVQuc3VidHJhY3QoZEYySVZRVCkubXVsdGlwbHkoZENPRkEpLnNldFNjYWxlKGludFByaWNlVU1fRENDRCwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIFJlY2VpdmVkUXVhbnRpdHlBbHRVTSA9IGRGMlJQUUEuc3VidHJhY3QoZEYySVZRQSkuc2V0U2NhbGUoaW50T3JkZXJVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgfQ0KICAgICAgUmVjZWl2ZWRRdWFudGl0eSA9IGRGMlJQUUEuc3VidHJhY3QoZEYySVZRQSkuc2V0U2NhbGUoaW50T3JkZXJVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgT3BlblF1YW50aXR5T3JkZXJVTSA9IGRGMlJQUUEuc3VidHJhY3QoZEYySVZRQSkuc2V0U2NhbGUoaW50T3JkZXJVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgIH0gZWxzZSBpZiAoIVBQVU4uZXF1YWxzKFBVVU4pICYmIFBQVU4uZXF1YWxzKFVOTVMpKSAvKiBpZiBwcmljZSB1bml0IGlzIG5vdCBlcXVhbCB0byBvcmRlciB1bml0IGFuZCBub3QgZXF1YWwgdG8gYmFzZSB1bml0Ki8gew0KICAgICAgLy9vUmVjZWl2ZWRRdWFudGl0eUFsdFVNID0gRG91YmxlLnRvU3RyaW5nKG5ldyBCaWdEZWNpbWFsKChkRjJSUFFBIC0gZEYySVZRQSkpLnNldFNjYWxlKE51bWJlck9mRGVjaW1hbHMsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS5kb3VibGVWYWx1ZSgpKTsNCg0KICAgICAgUmVjZWl2ZWRRdWFudGl0eUFsdFVNID0gZEYyUlBRVC5zdWJ0cmFjdChkRjJJVlFUKS5zZXRTY2FsZShpbnRQcmljZVVNX0RDQ0QsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQoNCiAgICAgIC8vb1JlY2VpdmVkUXVhbnRpdHlBbHRVTSA9IGRGMlJQUUEuc3VidHJhY3QoZEYySVZRQSkuc2V0U2NhbGUoaW50T3JkZXJVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgT3BlblF1YW50aXR5T3JkZXJVTSA9IGRGMlJQUUEuc3VidHJhY3QoZEYySVZRQSkuc2V0U2NhbGUoaW50T3JkZXJVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgIH0gZWxzZSB7DQogICAgICAvL29SZWNlaXZlZFF1YW50aXR5QWx0VU0gPSBEb3VibGUudG9TdHJpbmcobmV3IEJpZ0RlY2ltYWwoKChkRjJTQ09QIC8gZEYyU0NPQykgICogZEYyUlBRVCkgLSBkRjJJVlFUKS5zZXRTY2FsZShOdW1iZXJPZkRlY2ltYWxzLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkuZG91YmxlVmFsdWUoKSk7DQogICAgICBSZWNlaXZlZFF1YW50aXR5QWx0VU0gPSBkRjJSUFFULnN1YnRyYWN0KGRGMklWUVQpLnNldFNjYWxlKGludEJhc2ljVU1fRENDRCwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgIFJlY2VpdmVkUXVhbnRpdHkgPSBkRjJSUFFULnN1YnRyYWN0KGRGMklWUVQpLnNldFNjYWxlKGludEJhc2ljVU1fRENDRCwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgIE9wZW5RdWFudGl0eU9yZGVyVU0gPSBkRjJSUFFBLnN1YnRyYWN0KGRGMklWUUEpLnNldFNjYWxlKGludEJhc2ljVU1fRENDRCwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICB9DQoNCiAgICBpZiAoIVBVVU4uZXF1YWxzKFBQVU4pKSB7DQogICAgICBPcGVuUXVhbnRpdHlQdXJjaGFzZU9yZGVyUHJpY2VVTSA9IGRGMlJQUUEuc3VidHJhY3QoZEYySVZRQSkuc2V0U2NhbGUoaW50T3JkZXJVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgIH0gZWxzZSB7fQ0KDQogICAgLy9vT3BlblF1YW50aXR5T3JkZXJVTSA9IERvdWJsZS50b1N0cmluZyhuZXcgQmlnRGVjaW1hbCgoZEYyUlBRVCAtIGRGMklWUVQpKS5zZXRTY2FsZShOdW1iZXJPZkRlY2ltYWxzLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkuZG91YmxlVmFsdWUoKSk7DQogICAgQmlnRGVjaW1hbCBkT3BlbkFtb3VudExvY2FsQ3VycmVuY3kgPSBkRjJSQ0FDLnN1YnRyYWN0KGRGMklDQUMpOw0KICAgIE9wZW5BbW91bnRMb2NhbEN1cnJlbmN5ID0gZE9wZW5BbW91bnRMb2NhbEN1cnJlbmN5LnRvUGxhaW5TdHJpbmcoKTsNCg0KICAgIGlmIChvRE1DVS5lcXVhbHMoIjEiKSkgew0KICAgICAgT3BlbkFtb3VudE9yZGVyVU0gPSBkT3BlbkFtb3VudExvY2FsQ3VycmVuY3kuZGl2aWRlKGRGMlNFUkEsIG51bWJlck9mRGVjaW1hbHMudG9JbnRlZ2VyKCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgfSBlbHNlIGlmIChvRE1DVS5lcXVhbHMoIjIiKSkgew0KICAgICAgT3BlbkFtb3VudE9yZGVyVU0gPSBkT3BlbkFtb3VudExvY2FsQ3VycmVuY3kubXVsdGlwbHkoZEYyU0VSQSkuc2V0U2NhbGUobnVtYmVyT2ZEZWNpbWFscy50b0ludGVnZXIoKSwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICB9DQoNCiAgICBlYWNoTGluZVJlY2VpcHQucHV0KCdSZWNlaXZlZFF1YW50aXR5QWx0VU0nLCBSZWNlaXZlZFF1YW50aXR5QWx0VU0pOw0KICAgIGVhY2hMaW5lUmVjZWlwdC5wdXQoJ09wZW5RdWFudGl0eU9yZGVyVU0nLCBPcGVuUXVhbnRpdHlPcmRlclVNKTsNCiAgICBlYWNoTGluZVJlY2VpcHQucHV0KCdPcGVuQ2F0Y2hXZWlnaHQnLCBPcGVuQ2F0Y2hXZWlnaHQpOw0KICAgIGVhY2hMaW5lUmVjZWlwdC5wdXQoJ09wZW5RdWFudGl0eVB1cmNoYXNlT3JkZXJQcmljZVVNJywgT3BlblF1YW50aXR5UHVyY2hhc2VPcmRlclByaWNlVU0pOw0KICAgIGVhY2hMaW5lUmVjZWlwdC5wdXQoJ09wZW5BbW91bnRMb2NhbEN1cnJlbmN5JywgT3BlbkFtb3VudExvY2FsQ3VycmVuY3kpOw0KICAgIGVhY2hMaW5lUmVjZWlwdC5wdXQoJ09wZW5BbW91bnRPcmRlclVNJywgT3BlbkFtb3VudE9yZGVyVU0pOw0KICAgIGVhY2hMaW5lUmVjZWlwdC5wdXQoJ1JlY2VpdmVkUXVhbnRpdHknLCBSZWNlaXZlZFF1YW50aXR5KTsNCiAgfQ0KDQogIC8qIGNoZWNrIG9wZW4gcmVjZWlwdCBsaW5lDQogICAqLw0KICBwdWJsaWMgYm9vbGVhbiBpZk9wZW5SZWNlaXB0KEhhc2h0YWJsZSBlYWNoTGluZVJlY2VpcHQpIHsNCiAgICBvcGVuTGluZVJlY2VpcHRMaXN0ID0gbmV3IEFycmF5TGlzdCA8IEhhc2h0YWJsZSA+ICgpOw0KICAgIFN0cmluZyBpRjJJTVNUID0gZWFjaExpbmVSZWNlaXB0LmdldCgnRjJJTVNUJyk7DQogICAgU3RyaW5nIGlPcGVuUXVhbnRpdHlPcmRlclVNID0gZWFjaExpbmVSZWNlaXB0LmdldCgnT3BlblF1YW50aXR5T3JkZXJVTScpOw0KICAgIGlGMklNU1QgPSBpRjJJTVNUID09IG51bGwgPyAiIiA6IGlGMklNU1QudHJpbSgpOw0KICAgIGlPcGVuUXVhbnRpdHlPcmRlclVNID0gaU9wZW5RdWFudGl0eU9yZGVyVU0gPT0gbnVsbCA/ICIiIDogaU9wZW5RdWFudGl0eU9yZGVyVU0udHJpbSgpOw0KICAgIGlPcGVuUXVhbnRpdHlPcmRlclVNID0gaU9wZW5RdWFudGl0eU9yZGVyVU0uZXF1YWxzKCIiKSA/ICIwIiA6IGlPcGVuUXVhbnRpdHlPcmRlclVNLnJlcGxhY2UoJywnLCAnLicpOw0KICAgIERvdWJsZSBkT3BlblF1YW50aXR5T3JkZXJVTSA9IERvdWJsZS5wYXJzZURvdWJsZShpT3BlblF1YW50aXR5T3JkZXJVTSk7DQogICAgLy90ZXN0DQogICAgLy9yZXR1cm4gdHJ1ZTsNCg0KICAgIHJldHVybiAoIWlGMklNU1QuZXF1YWxzKCI5IikgJiYgKERvdWJsZS5jb21wYXJlKGRPcGVuUXVhbnRpdHlPcmRlclVNLCAwLjAwMDFkKSA+IDAgfHwgRG91YmxlLmNvbXBhcmUoZE9wZW5RdWFudGl0eU9yZGVyVU0sIC0wLjAwMDFkKSA8IDApKTsNCiAgfQ0KDQogIC8qIHNlbmQgUE8gbGluZSByZWNlaXB0IGRldGFpbHMgdG8gb3V0cHV0DQogICAqLw0KICBwdWJsaWMgd3JpdGVSZWNlaXB0cyhTdHJpbmcgZWFjaFBVTk8sIEhhc2h0YWJsZSBlYWNoT3BlbkxpbmVSZWNlaXB0LCBIYXNodGFibGUgZWFjaExpbmUpIHsNCiAgICBpZiAoZWFjaExpbmUuZ2V0KCdQVVNMJykudG9TdHJpbmcoKSA8ICc4NScpIHsgLy9jaGFuZ2VkIGJ5IHNoYXNoYW5rDQogICAgICBtaS5vdXREYXRhLnB1dCgnUkNUUCcsICdMUicpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BVTk8nLCBlYWNoUFVOTyk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUE5MSScsIGVhY2hMaW5lLmdldCgnUE5MSScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BOTFMnLCBlYWNoTGluZS5nZXQoJ1BOTFMnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdJVE5PJywgZWFjaExpbmUuZ2V0KCdJVE5PJykudG9TdHJpbmcoKSk7DQoNCiAgICAgIG1pLm91dERhdGEucHV0KCdQTkxJJywgZWFjaExpbmUuZ2V0KCdQTkxJJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUE5MUycsIGVhY2hMaW5lLmdldCgnUE5MUycpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1RSRFQnLCBlYWNoTGluZS5nZXQoJ1RSRFQnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdMV0hMJywgZWFjaExpbmUuZ2V0KCdXSExPJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnSVROTycsIGVhY2hMaW5lLmdldCgnSVROTycpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BJVEQnLCBlYWNoTGluZS5nZXQoJ1BJVEQnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQSVRUJywgZWFjaExpbmUuZ2V0KCdQSVRUJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnU0lURScsIGVhY2hMaW5lLmdldCgnU0lURScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0NBUUEnLCBlYWNoTGluZS5nZXQoJ0NBUUEnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdSSlFBJywgZWFjaExpbmUuZ2V0KCdSSlFBJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnU0RRQScsIGVhY2hMaW5lLmdldCgnU0RRQScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ09SUUEnLCBlYWNoTGluZS5nZXQoJ09SUUEnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdJVlFBJywgZWFjaExpbmUuZ2V0KCdJVlFBJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUlZRQScsIGVhY2hMaW5lLmdldCgnUlZRQScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0NGUUEnLCBlYWNoTGluZS5nZXQoJ0NGUUEnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdPUVBVJywgZWFjaExpbmUuZ2V0KCdPcGVuUXVhbnRpdHlQcmljZVVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUFVSQycsIGVhY2hMaW5lLmdldCgnUFVSQycpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0xCVVknLCBlYWNoTGluZS5nZXQoJ0JVWUUnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdTVFVNJywgZWFjaExpbmUuZ2V0KCdTdGFuZGFyZFVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnVU5NUycsIGVhY2hMaW5lLmdldCgnVU5NUycpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0FMVU0nLCBlYWNoTGluZS5nZXQoJ0FsdGVybmF0ZVVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnTE5BTScsIGVhY2hMaW5lLmdldCgnTE5BTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BVUFInLCBlYWNoTGluZS5nZXQoJ1ByaWNlUGVyUGllY2VTdGFuZGFyZFVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUFVRVCcsIGVhY2hMaW5lLmdldCgnUFVRVCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0FMUFInLCBlYWNoTGluZS5nZXQoJ0FsdGVybmF0aXZlUHJpY2UnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQVENEJywgZWFjaExpbmUuZ2V0KCdWVENEJykudG9TdHJpbmcoKSk7DQogICAgICBpZiAoZWFjaExpbmUuZ2V0KCdWVENEJykudG9TdHJpbmcoKS5sZW5ndGgoKSA9PSAxKSB7DQoNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1ZUQ0QnLCAnMCcgKyBlYWNoTGluZS5nZXQoJ1ZUQ0QnKS50b1N0cmluZygpKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1pLm91dERhdGEucHV0KCdWVENEJywgZWFjaExpbmUuZ2V0KCdWVENEJykudG9TdHJpbmcoKSk7DQogICAgICB9DQogICAgICBtaS5vdXREYXRhLnB1dCgnR1JNVCcsIGVhY2hMaW5lLmdldCgnR1JNVCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0xNT0QnLCBlYWNoTGluZS5nZXQoJ01PREwnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdMVEVEJywgZWFjaExpbmUuZ2V0KCdURURMJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnTFRFTCcsIGVhY2hMaW5lLmdldCgnVEVMMScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0xQU0wnLCBlYWNoTGluZS5nZXQoJ1BVU0wnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdMUFNUJywgZWFjaExpbmUuZ2V0KCdQVVNUJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUE9QTicsIGVhY2hMaW5lLmdldCgnUE9QTl9FQTEzJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUk9SQycsIGVhY2hMaW5lLmdldCgnUk9SQycpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JPUk4nLCBlYWNoTGluZS5nZXQoJ1JPUk4nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdST1JMJywgZWFjaExpbmUuZ2V0KCdST1JMJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUk9SWCcsIGVhY2hMaW5lLmdldCgnUk9SWCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1NVRE8nLCBlYWNoTGluZS5nZXQoJ1NVRE8nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdGUlJDJywgZWFjaExpbmUuZ2V0KCdGUlJDJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnRlJSRScsIGVhY2hMaW5lLmdldCgnRlJSRScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0FEUUEnLCBlYWNoTGluZS5nZXQoJ0FEUUEnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdPUlFUJywgZWFjaExpbmUuZ2V0KCdPUlFUJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQU1PUCcsIGVhY2hMaW5lLmdldCgnQW1vdW50T3BlbicpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0FNT1InLCBlYWNoTGluZS5nZXQoJ0xOQU0nKS50b1N0cmluZygpKTsNCiAgICAgIC8vaWYgKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkuZXF1YWxzKCcwLjAwMDAwMCcpKXsgCQkJCQkJCSAgICAgICAvL2NoYW5nZWQgYnkJIHNoYXNoYW5rIA0KICAgICAgaWYgKERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NQUFInKS50b1N0cmluZygpKSA9PSAwKSB7IC8vQWRkZWQgYnkJIHNoYXNoYW5rIA0KICAgICAgICBtaS5vdXREYXRhLnB1dCgnUFJDRScsIGVhY2hMaW5lLmdldCgnUHJpY2VQZXJQaWVjZVN0YW5kYXJkVU0nKS50b1N0cmluZygpKTsgLy9BZGRlZCBieQkgc2hhc2hhbmsgDQogICAgICB9DQogICAgICBpZiAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpICE9IDAgJiYgRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ0ZEMScpLnRvU3RyaW5nKCkpICE9IDApIHsgLy9BZGRlZCBieQkgc2hhc2hhbmsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1BSQ0UnLCAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpIC0gKCgoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ0ZEMScpLnRvU3RyaW5nKCkpKSAvIDEwMCkgKiAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpKSkpLnRvU3RyaW5nKCkpOyAvL0FkZGVkIGJ5CSBzaGFzaGFuaw0KDQogICAgICB9DQogICAgICBpZiAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpICE9IDAgJiYgRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ0ZEMicpLnRvU3RyaW5nKCkpICE9IDApIHsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1BSQ0UnLCAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpIC0gKCgoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ0ZEMicpLnRvU3RyaW5nKCkpKSAvIDEwMCkgKiAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpKSkpLnRvU3RyaW5nKCkpOyAvL0FkZGVkIGJ5CSBzaGFzaGFuaw0KDQogICAgICB9DQogICAgICBpZiAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpICE9IDAgJiYgRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ0ZEMycpLnRvU3RyaW5nKCkpICE9IDApIHsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1BSQ0UnLCAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpIC0gKCgoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ0ZEMycpLnRvU3RyaW5nKCkpKSAvIDEwMCkgKiAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpKSkpLnRvU3RyaW5nKCkpOyAvL0FkZGVkIGJ5CSBzaGFzaGFuaw0KDQogICAgICB9DQogICAgICBpZiAoRG91YmxlLnBhcnNlRG91YmxlKGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpICE9IDAgJiYgKERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NGRDEnKS50b1N0cmluZygpKSA9PSAwICYmIERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NGRDInKS50b1N0cmluZygpKSA9PSAwICYmIERvdWJsZS5wYXJzZURvdWJsZShlYWNoTGluZS5nZXQoJ0NGRDMnKS50b1N0cmluZygpKSA9PSAwKSkgeyAvL0FkZGVkIGJ5CSBzaGFzaGFuaw0KICAgICAgICBtaS5vdXREYXRhLnB1dCgnUFJDRScsIGVhY2hMaW5lLmdldCgnQ1BQUicpLnRvU3RyaW5nKCkpOyAvL0FkZGVkIGJ5CSBzaGFzaGFuaw0KICAgICAgfSAvL0FkZGVkIGJ5CSBzaGFzaGFuayAgDQogICAgICBtaS5vdXREYXRhLnB1dCgnVU5JVCcsIGVhY2hMaW5lLmdldCgnU3RhbmRhcmRVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ09QUVQnLCBlYWNoTGluZS5nZXQoJ09wZW5RdWFudGl0eVN0YW5kYXJkVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdRVElWJywgZWFjaExpbmUuZ2V0KCdJbnZvaWNlZFF1YW50aXR5U3RhbmRhcmRVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1FUT1InLCBlYWNoTGluZS5nZXQoJ09yZGVyZWRRdWFudGl0eVN0YW5kYXJkVU0nKS50b1N0cmluZygpKQ0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1FUUlYnLCBlYWNoTGluZS5nZXQoJ1JlY2VpdmVkUXVhbnRpdHlTdGFuZGFyZFVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQUxUVScsIGVhY2hMaW5lLmdldCgnQWx0ZXJuYXRlVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBTFFPJywgZWFjaExpbmUuZ2V0KCdBbHRlcm5hdGl2ZVF1YW50aXR5T3BlbicpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0FMVFAnLCBlYWNoTGluZS5nZXQoJ0FsdGVybmF0aXZlUHJpY2UnKS50b1N0cmluZygpKTsNCg0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JFTFAnLCBlYWNoT3BlbkxpbmVSZWNlaXB0LmdldCgnRjJSRUxQJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUlBOTScsIGVhY2hPcGVuTGluZVJlY2VpcHQuZ2V0KCdGMlJFUE4nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdSUERUJywgZWFjaE9wZW5MaW5lUmVjZWlwdC5nZXQoJ0YyVFJEVCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JQUVQnLCBlYWNoT3BlbkxpbmVSZWNlaXB0LmdldCgnUmVjZWl2ZWRRdWFudGl0eScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JRQUwnLCBlYWNoT3BlbkxpbmVSZWNlaXB0LmdldCgnUmVjZWl2ZWRRdWFudGl0eUFsdFVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnT0FPVScsIGVhY2hPcGVuTGluZVJlY2VpcHQuZ2V0KCdPcGVuQW1vdW50T3JkZXJVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ09BTEMnLCBlYWNoT3BlbkxpbmVSZWNlaXB0LmdldCgnT3BlbkFtb3VudExvY2FsQ3VycmVuY3knKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdPUENXJywgZWFjaE9wZW5MaW5lUmVjZWlwdC5nZXQoJ09wZW5DYXRjaFdlaWdodCcpLnRvU3RyaW5nKCkpOw0KICAgICAgLy9taS5vdXREYXRhLnB1dCgnT1FPVScsIGVhY2hPcGVuTGluZVJlY2VpcHQuZ2V0KCdPcGVuUXVhbnRpdHlPcmRlclVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnT1FPVScsIGVhY2hPcGVuTGluZVJlY2VpcHQuZ2V0KCdSZWNlaXZlZFF1YW50aXR5QWx0VU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdPUVBNJywgZWFjaE9wZW5MaW5lUmVjZWlwdC5nZXQoJ09wZW5RdWFudGl0eVB1cmNoYXNlT3JkZXJQcmljZVVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS53cml0ZSgpOw0KICAgIH0NCg0KICB9DQogIC8qIHJlcnRpdmUgcmVjZWlwdCBjaGFyZ2VzIGZyb20gdGFibGUgRkdSUENMDQogICAqLw0KICBwdWJsaWMgZ2F0aGVyUmVjZWlwdENoYXJnZXMoU3RyaW5nIGVhY2hQVU5PLCBIYXNodGFibGUgZWFjaExpbmVSZWNlaXB0LCBIYXNodGFibGUgZWFjaExpbmUpIHsNCiAgICBsaW5lQ2hhcmdlUmVjZWlwdExpc3QgPSBuZXcgQXJyYXlMaXN0IDwgSGFzaHRhYmxlID4gKCk7DQogICAgREJBY3Rpb24gcXVlcnlGR1JQQ0wgPSBkYXRhYmFzZS50YWJsZSgiRkdSUENMIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJGM0NPTk8iLCAiRjNESVZJIiwgIkYzUFVOTyIsICJGM1BOTEkiLCAiRjNQTkxTIiwgIkYzUkVQTiIsICJGM1JFTFAiLCAiRjNDRFNFIiwgIkYzQ0VJRCIsICJGM0VYVFkiLCAiRjNTQ09DIiwgIkYzU0NPUCIsICJGM0lWUVQiLCAiRjNJVlFBIiwgIkYzUkNBQyIsICJGM0lDQUMiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIHJlY29yZEZHUlBDTCA9IHF1ZXJ5RkdSUENMLmdldENvbnRhaW5lcigpOw0KICAgIHJlY29yZEZHUlBDTC5zZXQoIkYzQ09OTyIsIEludGVnZXIucGFyc2VJbnQoQ09OTy50cmltKCkpKTsNCiAgICByZWNvcmRGR1JQQ0wuc2V0KCJGM0RJVkkiLCBvRElWSS50cmltKCkpOw0KICAgIHJlY29yZEZHUlBDTC5zZXQoIkYzUFVOTyIsIGVhY2hQVU5PLnRyaW0oKSk7DQogICAgcmVjb3JkRkdSUENMLnNldCgiRjNQTkxJIiwgZWFjaExpbmUuZ2V0KCdQTkxJJykudG9TdHJpbmcoKS50b0ludGVnZXIoKSk7DQogICAgcmVjb3JkRkdSUENMLnNldCgiRjNQTkxTIiwgZWFjaExpbmUuZ2V0KCdQTkxTJykudG9TdHJpbmcoKS50b0ludGVnZXIoKSk7DQogICAgcmVjb3JkRkdSUENMLnNldCgnRjNSRVBOJywgTG9uZy5wYXJzZUxvbmcoZWFjaExpbmVSZWNlaXB0LmdldCgnRjJSRVBOJykudG9TdHJpbmcoKSkpOw0KICAgIHJlY29yZEZHUlBDTC5zZXQoJ0YzUkVMUCcsIEludGVnZXIucGFyc2VJbnQoZWFjaExpbmVSZWNlaXB0LmdldCgnRjJSRUxQJykudG9TdHJpbmcoKSkpOw0KICAgIC8vIHJlYWQgbG9jayBhbmQgY2FsbCBjcmVhdGVSZWNvcmRzKCkNCiAgICBpbnQgcmVhZHMgPSBxdWVyeUZHUlBDTC5yZWFkQWxsKHJlY29yZEZHUlBDTCwgNywgZ2V0RkdSUENMUmVjb3Jkcyk7DQogIH0NCg0KICBDbG9zdXJlIDwgPyA+IGdldEZHUlBDTFJlY29yZHMgPSB7DQogICAgREJDb250YWluZXIgcmVjb3JkIC0+DQogICAgSGFzaHRhYmxlIHRlbXBUYWJsZSA9IG5ldyBIYXNodGFibGUgPCBTdHJpbmcsDQogICAgU3RyaW5nID4gKCk7DQogICAgdGVtcFRhYmxlLnB1dCgnQ0RTRV9MQ1InLCByZWNvcmQuZ2V0KCdGM0NEU0UnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdDRUlEX0xDUicsIHJlY29yZC5nZXQoJ0YzQ0VJRCcpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0VYVFlfTENSJywgcmVjb3JkLmdldCgnRjNFWFRZJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnU0NPQ19MQ1InLCByZWNvcmQuZ2V0KCdGM1NDT0MnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdTQ09QX0xDUicsIHJlY29yZC5nZXQoJ0YzU0NPUCcpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0lWUVRfTENSJywgcmVjb3JkLmdldCgnRjNJVlFUJykudG9TdHJpbmcoKSk7DQogICAgdGVtcFRhYmxlLnB1dCgnSVZRQV9MQ1InLCByZWNvcmQuZ2V0KCdGM0lWUUEnKS50b1N0cmluZygpKTsNCiAgICB0ZW1wVGFibGUucHV0KCdSQ0FDX0xDUicsIHJlY29yZC5nZXQoJ0YzUkNBQycpLnRvU3RyaW5nKCkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0lDQUNfTENSJywgcmVjb3JkLmdldCgnRjNJQ0FDJykudG9TdHJpbmcoKSk7DQogICAgbGluZUNoYXJnZVJlY2VpcHRMaXN0LmFkZCh0ZW1wVGFibGUpOw0KICB9DQogIC8qIHJldHJpdmUgY2hhcmdlIHRleHQgdXNpbmcgUFBTMjgwTUkuR2V0RWxlbWVudA0KICAgKi8NCiAgcHVibGljIGdldENoYXJnZVRleHQoSGFzaHRhYmxlIGVhY2hMaW5lQ2hhcmdlUmVjZWlwdCkgew0KICAgIFN0cmluZyBDRUlEID0gZWFjaExpbmVDaGFyZ2VSZWNlaXB0LmdldCgnQ0VJRF9MQ1InKTsNCiAgICBTdHJpbmcgVFgzMCA9ICIiOw0KICAgIGJvb2xlYW4gcmVjb3JkRXhpc3RzID0gdHJ1ZTsNCiAgICBkZWYgY2FsbGJhY2sgPSB7DQogICAgICBNYXAgPCBTdHJpbmcsDQogICAgICBTdHJpbmcgPiByZXN1bHRzIC0+DQogICAgICByZWNvcmRFeGlzdHMgPSAhcmVzdWx0cy5nZXQoJ2Vycm9yJyk7DQogICAgICBpZiAocmVjb3JkRXhpc3RzKSB7DQogICAgICAgIFRYMzAgPSByZXN1bHRzLmdldCgnVFgzMCcpOw0KDQogICAgICB9DQogICAgICBlYWNoTGluZUNoYXJnZVJlY2VpcHQucHV0KCdUWDMwX0xDUicsIFRYMzApOw0KDQogICAgfQ0KICAgIGRlZiBwYXJhbXMgPSBbIkNFSUQiOiBDRUlELnRyaW0oKV07DQogICAgbWlDYWxsZXIuY2FsbCgiUFBTMjgwTUkiLCAiR2V0RWxlbWVudCIsIHBhcmFtcywgY2FsbGJhY2spOw0KICB9DQogIC8qIGNhbGN1bGF0ZSByZWNlaXB0IGNoYXJnZSBxdWFudGl0aWVzDQogICAqLw0KICBwdWJsaWMgY2FsY3VsYXRlUmVjZWlwdENoYXJnZVF1YW50aXRpZXMoSGFzaHRhYmxlIGVhY2hMaW5lLCBIYXNodGFibGUgZWFjaExpbmVSZWNlaXB0LCBIYXNodGFibGUgZWFjaExpbmVDaGFyZ2VSZWNlaXB0KSB7DQogICAgU3RyaW5nIFBVVU4gPSBlYWNoTGluZS5nZXQoJ1BVVU4nKTsNCiAgICBTdHJpbmcgUFBVTiA9IGVhY2hMaW5lLmdldCgnUFBVTicpOw0KICAgIFN0cmluZyBGMkNBV0UgPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMkNBV0UnKTsNCiAgICBTdHJpbmcgUlBRQSA9IGVhY2hMaW5lUmVjZWlwdC5nZXQoJ0YyUlBRQScpOw0KICAgIFN0cmluZyBGMlJQUVQgPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMlJQUVQnKTsNCiAgICBTdHJpbmcgRjNJVlFUID0gZWFjaExpbmVDaGFyZ2VSZWNlaXB0LmdldCgnSVZRVF9MQ1InKTsNCiAgICBTdHJpbmcgRjJSUFFBID0gZWFjaExpbmVSZWNlaXB0LmdldCgnRjJSUFFBJyk7DQogICAgU3RyaW5nIEYzSVZRQSA9IGVhY2hMaW5lQ2hhcmdlUmVjZWlwdC5nZXQoJ0lWUUFfTENSJyk7DQogICAgU3RyaW5nIEYySVZDVyA9IGVhY2hMaW5lUmVjZWlwdC5nZXQoJ0YySVZDVycpOw0KICAgIFN0cmluZyBGM1JDQUMgPSBlYWNoTGluZUNoYXJnZVJlY2VpcHQuZ2V0KCdSQ0FDX0xDUicpOw0KICAgIFN0cmluZyBGM0lDQUMgPSBlYWNoTGluZUNoYXJnZVJlY2VpcHQuZ2V0KCdJQ0FDX0xDUicpOw0KICAgIFN0cmluZyBGM1NDT1AgPSBlYWNoTGluZUNoYXJnZVJlY2VpcHQuZ2V0KCdTQ09QX0xDUicpOw0KICAgIFN0cmluZyBGM1NDT0MgPSBlYWNoTGluZUNoYXJnZVJlY2VpcHQuZ2V0KCdTQ09DX0xDUicpOw0KICAgIFN0cmluZyBGMlNFUkEgPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMlNFUkEnKTsNCg0KICAgIFBVVU4gPSBQVVVOID09IG51bGwgPyAiIiA6IFBVVU4udHJpbSgpOw0KICAgIFBQVU4gPSBQUFVOID09IG51bGwgPyAiIiA6IFBQVU4udHJpbSgpOw0KICAgIEYyQ0FXRSA9IEYyQ0FXRSA9PSBudWxsID8gIiIgOiBGMkNBV0UudHJpbSgpOw0KICAgIFJQUUEgPSBSUFFBID09IG51bGwgPyAiIiA6IFJQUUEudHJpbSgpOw0KICAgIEYyUlBRVCA9IEYyUlBRVCA9PSBudWxsID8gIiIgOiBGMlJQUVQudHJpbSgpOw0KICAgIEYzSVZRVCA9IEYzSVZRVCA9PSBudWxsID8gIiIgOiBGM0lWUVQudHJpbSgpOw0KICAgIEYyUlBRQSA9IEYyUlBRQSA9PSBudWxsID8gIiIgOiBGMlJQUUEudHJpbSgpOw0KICAgIEYzSVZRQSA9IEYzSVZRQSA9PSBudWxsID8gIiIgOiBGM0lWUUEudHJpbSgpOw0KICAgIEYySVZDVyA9IEYySVZDVyA9PSBudWxsID8gIiIgOiBGMklWQ1cudHJpbSgpOw0KICAgIEYzUkNBQyA9IEYzUkNBQyA9PSBudWxsID8gIiIgOiBGM1JDQUMudHJpbSgpOw0KICAgIEYzSUNBQyA9IEYzSUNBQyA9PSBudWxsID8gIiIgOiBGM0lDQUMudHJpbSgpOw0KICAgIEYzU0NPUCA9IEYzU0NPUCA9PSBudWxsID8gIiIgOiBGM1NDT1AudHJpbSgpOw0KICAgIEYzU0NPQyA9IEYzU0NPQyA9PSBudWxsID8gIiIgOiBGM1NDT0MudHJpbSgpOw0KICAgIEYyU0VSQSA9IEYyU0VSQSA9PSBudWxsID8gIiIgOiBGMlNFUkEudHJpbSgpOw0KICAgIG9ETUNVID0gb0RNQ1UgPT0gbnVsbCA/ICIiIDogb0RNQ1UudHJpbSgpOw0KICAgIE9yZGVyVU1fRENDRCA9IE9yZGVyVU1fRENDRCA9PSBudWxsID8gIiIgOiBPcmRlclVNX0RDQ0QudHJpbSgpOw0KICAgIEJhc2ljVU1fRENDRCA9IEJhc2ljVU1fRENDRCA9PSBudWxsID8gIiIgOiBCYXNpY1VNX0RDQ0QudHJpbSgpOw0KDQogICAgRG91YmxlIGRGMkNBV0UgPSBEb3VibGUucGFyc2VEb3VibGUoRjJDQVdFLmlzRW1wdHkoKSA/ICIwIiA6IEYyQ0FXRS50cmltKCkpOw0KICAgIERvdWJsZSBkRjJSUFFUID0gRG91YmxlLnBhcnNlRG91YmxlKEYyUlBRVC5pc0VtcHR5KCkgPyAiMCIgOiBGMlJQUVQudHJpbSgpKTsNCiAgICBEb3VibGUgZEYzSVZRVCA9IERvdWJsZS5wYXJzZURvdWJsZShGM0lWUVQuaXNFbXB0eSgpID8gIjAiIDogRjNJVlFULnRyaW0oKSk7DQogICAgRG91YmxlIGRGMlJQUUEgPSBEb3VibGUucGFyc2VEb3VibGUoRjJSUFFBLmlzRW1wdHkoKSA/ICIwIiA6IEYyUlBRQS50cmltKCkpOw0KICAgIERvdWJsZSBkRjNSQ0FDID0gRG91YmxlLnBhcnNlRG91YmxlKEYzUkNBQy5pc0VtcHR5KCkgPyAiMCIgOiBGM1JDQUMudHJpbSgpKTsNCiAgICBEb3VibGUgZEYyU0VSQSA9IERvdWJsZS5wYXJzZURvdWJsZShGMlNFUkEuaXNFbXB0eSgpID8gIjAiIDogRjJTRVJBLnRyaW0oKSk7DQoNCiAgICBpbnQgaW50QmFzaWNVTV9EQ0NEID0gSW50ZWdlci52YWx1ZU9mKEJhc2ljVU1fRENDRC50cmltKCkpOw0KICAgIGludCBpbnRPcmRlclVNX0RDQ0QgPSBPcmRlclVNX0RDQ0QuaXNFbXB0eSgpID8gaW50QmFzaWNVTV9EQ0NEIDogSW50ZWdlci52YWx1ZU9mKE9yZGVyVU1fRENDRC50cmltKCkpOw0KDQogICAgRG91YmxlIGRSZWNlaXZlZFF1YW50aXR5ID0gMC4wZDsNCiAgICBEb3VibGUgZFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5ID0gMC4wZDsNCg0KICAgIGlmIChvRE1DVS5lcXVhbHMoIjEiKSkgew0KICAgICAgZEYyU0VSQSA9IDFkIC8gZEYyU0VSQTsNCiAgICB9DQogICAgZFJlY2VpdmVkUXVhbnRpdHkgPSBkRjJSUFFBOw0KICAgIGRSZWNlaXZlZENvc3RBbW91bnRPcmRlclVNT3JkZXJDdXJyZW5jeSA9IERvdWJsZS5jb21wYXJlKGRGMlJQUVQsIDAuMGQpID09IDAgPyAwLjBkIDogKERvdWJsZSkoKGRGMlJQUUEgLyBkRjJSUFFUKSAqIGRGM1JDQUMgKiBkRjJTRVJBKTsNCiAgICBSZWNlaXZlZFF1YW50aXR5T3JkZXJVTSA9IERvdWJsZS50b1N0cmluZyhuZXcgQmlnRGVjaW1hbChkUmVjZWl2ZWRRdWFudGl0eSkuc2V0U2NhbGUoaW50T3JkZXJVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkuZG91YmxlVmFsdWUoKSk7DQogICAgUmVjZWl2ZWRDb3N0QW1vdW50T3JkZXJVTU9yZGVyQ3VycmVuY3kgPSBEb3VibGUudG9TdHJpbmcobmV3IEJpZ0RlY2ltYWwoZFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5KS5zZXRTY2FsZShudW1iZXJPZkRlY2ltYWxzLnRvSW50ZWdlcigpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkuZG91YmxlVmFsdWUoKSk7DQogICAgT3BlblF1YW50aXR5T3JkZXJVTSA9IERvdWJsZS50b1N0cmluZyhuZXcgQmlnRGVjaW1hbCgoZEYyUlBRVCAtIGRGM0lWUVQpKS5zZXRTY2FsZShpbnRCYXNpY1VNX0RDQ0QsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS5kb3VibGVWYWx1ZSgpKTsNCg0KICAgIGVhY2hMaW5lQ2hhcmdlUmVjZWlwdC5wdXQoJ1JlY2VpdmVkUXVhbnRpdHlPcmRlclVNJywgUmVjZWl2ZWRRdWFudGl0eU9yZGVyVU0pOw0KICAgIGVhY2hMaW5lQ2hhcmdlUmVjZWlwdC5wdXQoJ1JlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5JywgUmVjZWl2ZWRDb3N0QW1vdW50T3JkZXJVTU9yZGVyQ3VycmVuY3kpOw0KICAgIGVhY2hMaW5lQ2hhcmdlUmVjZWlwdC5wdXQoJ09wZW5RdWFudGl0eU9yZGVyVU0nLCBPcGVuUXVhbnRpdHlPcmRlclVNKTsNCiAgfQ0KDQogIHB1YmxpYyBpZlJlY2VpcHRDaGFyZ2VPcGVuKEhhc2h0YWJsZSBlYWNoTGluZUNoYXJnZVJlY2VpcHQpIHsNCiAgICBTdHJpbmcgT3BlblF1YW50aXR5T3JkZXJVTSA9IGVhY2hMaW5lQ2hhcmdlUmVjZWlwdC5nZXQoJ09wZW5RdWFudGl0eU9yZGVyVU0nKTsNCiAgICBTdHJpbmcgUmVjZWl2ZWRDb3N0QW1vdW50T3JkZXJVTU9yZGVyQ3VycmVuY3kgPSBlYWNoTGluZUNoYXJnZVJlY2VpcHQuZ2V0KCdSZWNlaXZlZENvc3RBbW91bnRPcmRlclVNT3JkZXJDdXJyZW5jeScpOw0KDQogICAgT3BlblF1YW50aXR5T3JkZXJVTSA9IE9wZW5RdWFudGl0eU9yZGVyVU0gPT0gbnVsbCA/ICIiIDogT3BlblF1YW50aXR5T3JkZXJVTS50cmltKCk7DQogICAgT3BlblF1YW50aXR5T3JkZXJVTSA9IE9wZW5RdWFudGl0eU9yZGVyVU0uZXF1YWxzKCIiKSA/ICIwIiA6IE9wZW5RdWFudGl0eU9yZGVyVU0ucmVwbGFjZSgnLCcsICcuJyk7DQoNCiAgICBCaWdEZWNpbWFsIG9wZW5RdWFudGl0eU9yZGVyVU0gPSBuZXcgQmlnRGVjaW1hbChPcGVuUXVhbnRpdHlPcmRlclVNKTsNCg0KICAgIFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5ID0gUmVjZWl2ZWRDb3N0QW1vdW50T3JkZXJVTU9yZGVyQ3VycmVuY3kgPT0gbnVsbCA/ICIiIDogUmVjZWl2ZWRDb3N0QW1vdW50T3JkZXJVTU9yZGVyQ3VycmVuY3kudHJpbSgpOw0KICAgIFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5ID0gUmVjZWl2ZWRDb3N0QW1vdW50T3JkZXJVTU9yZGVyQ3VycmVuY3kuZXF1YWxzKCIiKSA/ICIwIiA6IFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5LnJlcGxhY2UoJywnLCAnLicpOw0KDQogICAgQmlnRGVjaW1hbCByZWNlaXZlZENvc3RBbW91bnRPcmRlclVNT3JkZXJDdXJyZW5jeSA9IG5ldyBCaWdEZWNpbWFsKFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5KTsNCg0KICAgIFN0cmluZyBFeHBvcnRFbXB0eUNoYXJnZXMgPSBleHBvcnRFbXB0eSA9PSBudWxsID8gIiIgOiBleHBvcnRFbXB0eS50cmltKCk7DQoNCiAgICBib29sZWFuIG9wZW5RdWFudGl0eSA9IG9wZW5RdWFudGl0eU9yZGVyVU0uY29tcGFyZVRvKEJpZ0RlY2ltYWwuWkVSTykgIT0gMDsNCg0KICAgIGJvb2xlYW4gb3BlbkFtb3VudCA9IHJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5LmNvbXBhcmVUbyhCaWdEZWNpbWFsLlpFUk8pICE9IDA7DQoNCiAgICBpZiAoIUV4cG9ydEVtcHR5Q2hhcmdlcy5lcXVhbHMoIjEiKSAmJiAhb3BlbkFtb3VudCAmJiBvcGVuUXVhbnRpdHkpIHsNCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9IGVsc2Ugew0KICAgICAgcmV0dXJuIG9wZW5RdWFudGl0eTsNCiAgICB9DQogIH0NCiAgLyogY2hlY2sgUE8gbGluZSBjaGFyZ2Ugb3JkZXIgcHJpY2UgYW5kIEJhc2ljIHVuaXQNCiAgICovDQogIHB1YmxpYyBjaGVja0NoYXJnZU9yZGVyUHJpY2VBbmRCYXNlVW5pdChIYXNodGFibGUgZWFjaExpbmUsIEhhc2h0YWJsZSBlYWNoTGluZVJlY2VpcHQsIEhhc2h0YWJsZSBlYWNoTGluZUNoYXJnZVJlY2VpcHQpIHsNCiAgICBTdHJpbmcgUFVVTiA9IGVhY2hMaW5lLmdldCgnUFVVTicpOw0KICAgIFN0cmluZyBVTk1TID0gZWFjaExpbmUuZ2V0KCdVTk1TJyk7DQogICAgU3RyaW5nIFBQVU4gPSBlYWNoTGluZS5nZXQoJ1BQVU4nKTsNCiAgICBTdHJpbmcgT1JRQSA9IGVhY2hMaW5lLmdldCgnT1JRQScpOw0KICAgIFN0cmluZyBPUlFUID0gZWFjaExpbmUuZ2V0KCdPUlFUJyk7DQogICAgU3RyaW5nIFJQUUEgPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMlJQUUEnKTsNCiAgICBTdHJpbmcgUlBRVCA9IGVhY2hMaW5lUmVjZWlwdC5nZXQoJ0YyUlBRVCcpOw0KICAgIFN0cmluZyBJVlFBID0gZWFjaExpbmVDaGFyZ2VSZWNlaXB0LmdldCgnSVZRQV9MQ1InKTsNCiAgICBTdHJpbmcgSVZRVCA9IGVhY2hMaW5lQ2hhcmdlUmVjZWlwdC5nZXQoJ0lWUVRfTENSJyk7DQoNCiAgICBpZiAoUFVVTi50cmltKCkuZXF1YWxzKFVOTVMudHJpbSgpKSkgew0KICAgICAgZWFjaExpbmVDaGFyZ2VSZWNlaXB0LnJlcGxhY2UoJ0lWUVRfTENSJywgSVZRQSk7DQogICAgfSBlbHNlIHsNCiAgICAgIEJpZ0RlY2ltYWwgZGJsSVZRQSA9IG5ldyBCaWdEZWNpbWFsKElWUUEpOw0KICAgICAgQmlnRGVjaW1hbCBkYmxDT0ZBID0gbmV3IEJpZ0RlY2ltYWwoT3JkZXJVTV9DT0ZBKTsNCg0KICAgICAgaWYgKE9yZGVyVU1fRE1DRi5lcXVhbHMoIjEiKSkgew0KICAgICAgICBJVlFUID0gZGJsSVZRQS5tdWx0aXBseShkYmxDT0ZBKS5zZXRTY2FsZSg4LCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KDQogICAgICB9IGVsc2Ugew0KICAgICAgICBJVlFUID0gZGJsSVZRQS5kaXZpZGUoZGJsQ09GQSkuc2V0U2NhbGUoOCwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgIH0NCiAgICAgIGVhY2hMaW5lQ2hhcmdlUmVjZWlwdC5yZXBsYWNlKCdJVlFUX0xDUicsIElWUVQpOw0KICAgIH0NCg0KICAgIGlmIChQUFVOLnRyaW0oKS5lcXVhbHMoUFVVTi50cmltKCkpKSB7DQogICAgICBPUlFBID0gT1JRQSA9PSBudWxsID8gIiIgOiBPUlFBLnRyaW0oKTsNCiAgICAgIFJQUUEgPSBSUFFBID09IG51bGwgPyAiIiA6IFJQUUEudHJpbSgpOw0KICAgICAgSVZRQSA9IElWUUEgPT0gbnVsbCA/ICIiIDogSVZRQS50cmltKCk7DQoNCiAgICAgIE9yZGVyZWRRdWFudGl0eVByaWNlVU0gPSBPUlFBOw0KICAgICAgUmVjZWl2ZWRRdWFudGl0eVByaWNlVU0gPSBSUFFBOw0KICAgICAgSW52b2ljZWRRdWFudGl0eVByaWNlVU0gPSBJVlFBOw0KDQogICAgICBCaWdEZWNpbWFsIGRibFJQUUEgPSBuZXcgQmlnRGVjaW1hbChSUFFBKTsNCiAgICAgIEJpZ0RlY2ltYWwgZGJsSVZRQSA9IG5ldyBCaWdEZWNpbWFsKElWUUEpOw0KDQogICAgICBPcGVuUXVhbnRpdHlQcmljZVVNID0gKGRibFJQUUEgLSBkYmxJVlFBKS5zZXRTY2FsZSg0LCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgIH0NCg0KICAgIGlmIChQUFVOLnRyaW0oKS5lcXVhbHMoVU5NUy50cmltKCkpICYmICFQUFVOLnRyaW0oKS5lcXVhbHMoUFVVTi50cmltKCkpKSB7DQogICAgICBPUlFUID0gT1JRVCA9PSBudWxsID8gIiIgOiBPUlFULnRyaW0oKTsNCiAgICAgIFJQUVQgPSBSUFFUID09IG51bGwgPyAiIiA6IFJQUVQudHJpbSgpOw0KICAgICAgSVZRVCA9IElWUVQgPT0gbnVsbCA/ICIiIDogSVZRVC50cmltKCk7DQoNCiAgICAgIE9yZGVyZWRRdWFudGl0eVByaWNlVU0gPSBPUlFUOw0KICAgICAgUmVjZWl2ZWRRdWFudGl0eVByaWNlVU0gPSBSUFFUOw0KICAgICAgSW52b2ljZWRRdWFudGl0eVByaWNlVU0gPSBJVlFUOw0KDQogICAgICBCaWdEZWNpbWFsIGRibFJQUVQgPSBuZXcgQmlnRGVjaW1hbChSUFFUKTsNCiAgICAgIEJpZ0RlY2ltYWwgZGJsSVZRVCA9IG5ldyBCaWdEZWNpbWFsKElWUVQpOw0KDQogICAgICBPcGVuUXVhbnRpdHlQcmljZVVNID0gKGRibFJQUVQgLSBkYmxJVlFUKS5zZXRTY2FsZSg0LCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgIH0NCiAgICBpZiAoIVBQVU4udHJpbSgpLmVxdWFscyhVTk1TLnRyaW0oKSkgJiYgIVBQVU4udHJpbSgpLmVxdWFscyhQVVVOLnRyaW0oKSkpIHsNCiAgICAgIElWUVQgPSBJVlFUID09IG51bGwgPyAiIiA6IElWUVQudHJpbSgpOw0KICAgICAgT1JRVCA9IE9SUVQgPT0gbnVsbCA/ICIiIDogT1JRVC50cmltKCk7DQogICAgICBSUFFUID0gUlBRVCA9PSBudWxsID8gIiIgOiBSUFFULnRyaW0oKTsNCiAgICAgIFN0cmluZyBEQ0NEID0gUHJpY2VVTV9EQ0NEID09IG51bGwgPyAiIiA6IFByaWNlVU1fRENDRC50cmltKCk7DQogICAgICBTdHJpbmcgRE1DRiA9IFByaWNlVU1fRE1DRiA9PSBudWxsID8gIiIgOiBQcmljZVVNX0RNQ0YudHJpbSgpOw0KICAgICAgU3RyaW5nIENPRkEgPSBQcmljZVVNX0NPRkEgPT0gbnVsbCA/ICIiIDogUHJpY2VVTV9DT0ZBLnRyaW0oKTsNCg0KICAgICAgQmlnRGVjaW1hbCBkYmxJVlFUID0gbmV3IEJpZ0RlY2ltYWwoSVZRVCk7DQogICAgICBCaWdEZWNpbWFsIGRibENPRkEgPSBuZXcgQmlnRGVjaW1hbChDT0ZBKTsNCiAgICAgIEJpZ0RlY2ltYWwgZGJsT1JRVCA9IG5ldyBCaWdEZWNpbWFsKE9SUVQpOw0KICAgICAgQmlnRGVjaW1hbCBkYmxSUFFUID0gbmV3IEJpZ0RlY2ltYWwoUlBRVCk7DQoNCiAgICAgIGlmIChBVVRQX2EuZXF1YWxzKCIxIikpIHsNCiAgICAgICAgaWYgKERNQ0YuZXF1YWxzKCIxIikpIHsNCiAgICAgICAgICBJbnZvaWNlZFF1YW50aXR5UHJpY2VVTSA9IGRibElWUVQuZGl2aWRlKGRibENPRkEpLnNldFNjYWxlKEludGVnZXIucGFyc2VJbnQoRENDRCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgICAgT3JkZXJlZFF1YW50aXR5UHJpY2VVTSA9IGRibE9SUVQuZGl2aWRlKGRibENPRkEpLnNldFNjYWxlKEludGVnZXIucGFyc2VJbnQoRENDRCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgICAgUmVjZWl2ZWRRdWFudGl0eVByaWNlVU0gPSBkYmxSUFFULmRpdmlkZShkYmxDT0ZBKS5zZXRTY2FsZShJbnRlZ2VyLnBhcnNlSW50KERDQ0QpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICAgIE9wZW5RdWFudGl0eVByaWNlVU0gPSAoZGJsUlBRVCAtIGRibElWUVQpLmRpdmlkZShkYmxDT0ZBKS5zZXRTY2FsZShJbnRlZ2VyLnBhcnNlSW50KERDQ0QpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgSW52b2ljZWRRdWFudGl0eVByaWNlVU0gPSBkYmxJVlFULm11bHRpcGx5KGRibENPRkEpLnNldFNjYWxlKEludGVnZXIucGFyc2VJbnQoRENDRCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgICAgT3JkZXJlZFF1YW50aXR5UHJpY2VVTSA9IGRibE9SUVQubXVsdGlwbHkoZGJsQ09GQSkuc2V0U2NhbGUoSW50ZWdlci5wYXJzZUludChEQ0NEKSwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICBSZWNlaXZlZFF1YW50aXR5UHJpY2VVTSA9IGRibFJQUVQubXVsdGlwbHkoZGJsQ09GQSkuc2V0U2NhbGUoSW50ZWdlci5wYXJzZUludChEQ0NEKSwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICBPcGVuUXVhbnRpdHlQcmljZVVNID0gKGRibFJQUVQgLSBkYmxJVlFUKS5tdWx0aXBseShkYmxDT0ZBKS5zZXRTY2FsZShJbnRlZ2VyLnBhcnNlSW50KERDQ0QpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICB9DQogICAgICB9DQogICAgICBpZiAoQVVUUF9hLmVxdWFscygiMiIpKSB7DQogICAgICAgIGlmIChETUNGLmVxdWFscygiMSIpKSB7DQogICAgICAgICAgSW52b2ljZWRRdWFudGl0eVByaWNlVU0gPSBkYmxJVlFULmRpdmlkZShkYmxDT0ZBKS5zZXRTY2FsZSgyLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICAgIE9yZGVyZWRRdWFudGl0eVByaWNlVU0gPSBkYmxPUlFULmRpdmlkZShkYmxDT0ZBKS5zZXRTY2FsZSgyLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICAgIFJlY2VpdmVkUXVhbnRpdHlQcmljZVVNID0gZGJsUlBRVC5kaXZpZGUoZGJsQ09GQSkuc2V0U2NhbGUoMiwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgICBPcGVuUXVhbnRpdHlQcmljZVVNID0gKGRibFJQUVQgLSBkYmxJVlFUKS5kaXZpZGUoZGJsQ09GQSkuc2V0U2NhbGUoMiwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCg0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIEludm9pY2VkUXVhbnRpdHlQcmljZVVNID0gZGJsSVZRVC5tdWx0aXBseShkYmxDT0ZBKS5zZXRTY2FsZSgyLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgICAgICAgIE9yZGVyZWRRdWFudGl0eVByaWNlVU0gPSBkYmxPUlFULm11bHRpcGx5KGRibENPRkEpLnNldFNjYWxlKDIsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgICAgUmVjZWl2ZWRRdWFudGl0eVByaWNlVU0gPSBkYmxSUFFULm11bHRpcGx5KGRibENPRkEpLnNldFNjYWxlKDIsIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgICAgICAgT3BlblF1YW50aXR5UHJpY2VVTSA9IChkYmxSUFFUIC0gZGJsSVZRVCkubXVsdGlwbHkoZGJsQ09GQSkuc2V0U2NhbGUoMiwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIFJQUUEgPSBSUFFBID09IG51bGwgPyAiIiA6IFJQUUEudHJpbSgpOw0KICAgIElWUUEgPSBJVlFBID09IG51bGwgPyAiIiA6IElWUUEudHJpbSgpOw0KICAgIE9yZGVyVU1fRENDRCA9IE9yZGVyVU1fRENDRCA9PSBudWxsID8gIiIgOiBPcmRlclVNX0RDQ0QudHJpbSgpOw0KDQogICAgQmlnRGVjaW1hbCBkYmxSUFFBID0gbmV3IEJpZ0RlY2ltYWwoUlBRQSk7DQogICAgQmlnRGVjaW1hbCBkYmxJVlFBID0gbmV3IEJpZ0RlY2ltYWwoSVZRQSk7DQogICAgaW50IGludE9yZGVyVU1fRENDRCA9IEludGVnZXIudmFsdWVPZihPcmRlclVNX0RDQ0QpOw0KDQogICAgT3BlblF1YW50aXR5T3JkZXJVTSA9IGRibFJQUUEuc3VidHJhY3QoZGJsSVZRQSkuc2V0U2NhbGUoaW50T3JkZXJVTV9EQ0NELCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KDQogICAgLy9DYWxjdWxhdGUgYW1vdW50IGFuZCBQcmljZQ0KICAgIE9wZW5RdWFudGl0eU9yZGVyVU0gPSBPcGVuUXVhbnRpdHlPcmRlclVNID09IG51bGwgPyAiIiA6IE9wZW5RdWFudGl0eU9yZGVyVU0udHJpbSgpOw0KICAgIFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5ID0gUmVjZWl2ZWRDb3N0QW1vdW50T3JkZXJVTU9yZGVyQ3VycmVuY3kgPT0gbnVsbCA/ICIiIDogUmVjZWl2ZWRDb3N0QW1vdW50T3JkZXJVTU9yZGVyQ3VycmVuY3kudHJpbSgpOw0KICAgIFJlY2VpdmVkUXVhbnRpdHlQcmljZVVNID0gUmVjZWl2ZWRRdWFudGl0eVByaWNlVU0gPT0gbnVsbCA/ICIiIDogUmVjZWl2ZWRRdWFudGl0eVByaWNlVU0udHJpbSgpOw0KICAgIFJlY2VpdmVkUXVhbnRpdHlPcmRlclVNID0gUmVjZWl2ZWRRdWFudGl0eU9yZGVyVU0gPT0gbnVsbCA/ICIiIDogUmVjZWl2ZWRRdWFudGl0eU9yZGVyVU0udHJpbSgpOw0KICAgIE9wZW5RdWFudGl0eVByaWNlVU0gPSBPcGVuUXVhbnRpdHlQcmljZVVNID09IG51bGwgPyAiIiA6IE9wZW5RdWFudGl0eVByaWNlVU0udHJpbSgpOw0KDQogICAgQmlnRGVjaW1hbCBkYmxPcGVuUXVhbnRpdHlPcmRlclVNID0gbmV3IEJpZ0RlY2ltYWwoT3BlblF1YW50aXR5T3JkZXJVTSk7DQogICAgQmlnRGVjaW1hbCBkYmxSZWNlaXZlZENvc3RBbW91bnRPcmRlclVNT3JkZXJDdXJyZW5jeSA9IG5ldyBCaWdEZWNpbWFsKFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5KTsNCiAgICBCaWdEZWNpbWFsIGRibFJlY2VpdmVkUXVhbnRpdHlQcmljZVVNID0gbmV3IEJpZ0RlY2ltYWwoUmVjZWl2ZWRRdWFudGl0eVByaWNlVU0pOw0KICAgIEJpZ0RlY2ltYWwgZGJsUmVjZWl2ZWRRdWFudGl0eU9yZGVyVU0gPSBuZXcgQmlnRGVjaW1hbChSZWNlaXZlZFF1YW50aXR5T3JkZXJVTSk7DQogICAgQmlnRGVjaW1hbCBkYmxPcGVuUXVhbnRpdHlQcmljZVVNID0gbmV3IEJpZ0RlY2ltYWwoT3BlblF1YW50aXR5UHJpY2VVTSk7DQoNCiAgICBCaWdEZWNpbWFsIGRibFByaWNlUGVyUGllY2VPcmRlclVNID0gZGJsUmVjZWl2ZWRRdWFudGl0eU9yZGVyVU0uY29tcGFyZVRvKDAuMCkgPT0gMCA/IDAuMCA6IGRibFJlY2VpdmVkQ29zdEFtb3VudE9yZGVyVU1PcmRlckN1cnJlbmN5IC8gZGJsUmVjZWl2ZWRRdWFudGl0eU9yZGVyVU07DQogICAgQmlnRGVjaW1hbCBkYmxQcmljZVBlclBpZWNlUHJpY2VVTSA9IGRibFJlY2VpdmVkUXVhbnRpdHlQcmljZVVNLmNvbXBhcmVUbygwLjApID09IDAgPyAwLjAgOiAoZGJsUmVjZWl2ZWRRdWFudGl0eU9yZGVyVU0gLyBkYmxSZWNlaXZlZFF1YW50aXR5UHJpY2VVTSkgKiBkYmxQcmljZVBlclBpZWNlT3JkZXJVTTsNCg0KICAgIEFtb3VudFJlY2VpdmVkUHJpY2VVTSA9IGRibFJlY2VpdmVkUXVhbnRpdHlQcmljZVVNLm11bHRpcGx5KGRibFByaWNlUGVyUGllY2VQcmljZVVNKS5zZXRTY2FsZShudW1iZXJPZkRlY2ltYWxzLnRvSW50ZWdlcigpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOw0KICAgIEFtb3VudE9wZW5QcmljZVVNID0gZGJsT3BlblF1YW50aXR5UHJpY2VVTS5tdWx0aXBseShkYmxQcmljZVBlclBpZWNlUHJpY2VVTSkuc2V0U2NhbGUobnVtYmVyT2ZEZWNpbWFscy50b0ludGVnZXIoKSwgUm91bmRpbmdNb2RlLkhBTEZfVVApLnRvUGxhaW5TdHJpbmcoKTsNCiAgICBBbW91bnRPcGVuT3JkZXJVTSA9IGRibE9wZW5RdWFudGl0eU9yZGVyVU0ubXVsdGlwbHkoZGJsUHJpY2VQZXJQaWVjZU9yZGVyVU0pLnNldFNjYWxlKG51bWJlck9mRGVjaW1hbHMudG9JbnRlZ2VyKCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQoNCiAgICBQcmljZVBlclBpZWNlUHJpY2VVTSA9IGRibFByaWNlUGVyUGllY2VQcmljZVVNLnNldFNjYWxlKG51bWJlck9mRGVjaW1hbHMudG9JbnRlZ2VyKCksIFJvdW5kaW5nTW9kZS5IQUxGX1VQKS50b1BsYWluU3RyaW5nKCk7DQogICAgUHJpY2VQZXJQaWVjZU9yZGVyVU0gPSBkYmxQcmljZVBlclBpZWNlT3JkZXJVTS5zZXRTY2FsZShudW1iZXJPZkRlY2ltYWxzLnRvSW50ZWdlcigpLCBSb3VuZGluZ01vZGUuSEFMRl9VUCkudG9QbGFpblN0cmluZygpOzsNCg0KICB9DQoNCiAgLyogYWRkIFBPIGxpbmUgb3BlbiBjaGFyZ2UgdG8gcmVjZWlwdCBsaXN0DQogICAqLw0KICBwdWJsaWMgYWRkVG9MaW5lT3BlbkNoYXJnZVJlY2VpcHRMaXN0KFN0cmluZyBlYWNoUFVOTywgSGFzaHRhYmxlIGVhY2hMaW5lLCBIYXNodGFibGUgZWFjaExpbmVSZWNlaXB0LCBIYXNodGFibGUgZWFjaExpbmVDaGFyZ2VSZWNlaXB0KSB7DQogICAgU3RyaW5nIFBOTEkgPSBlYWNoTGluZS5nZXQoJ1BOTEknKTsNCiAgICBTdHJpbmcgUE5MUyA9IGVhY2hMaW5lLmdldCgnUE5MUycpOw0KICAgIFN0cmluZyBDRFNFID0gZWFjaExpbmVDaGFyZ2VSZWNlaXB0LmdldCgnQ0RTRV9MQ1InKTsNCiAgICBTdHJpbmcgQ0VJRCA9IGVhY2hMaW5lQ2hhcmdlUmVjZWlwdC5nZXQoJ0NFSURfTENSJyk7DQogICAgU3RyaW5nIFJFUE4gPSBlYWNoTGluZVJlY2VpcHQuZ2V0KCdGMlJFUE4nKTsNCiAgICBTdHJpbmcgUkVMUCA9IGVhY2hMaW5lUmVjZWlwdC5nZXQoJ0YyUkVMUCcpOw0KICAgIFN0cmluZyBUWDMwID0gZWFjaExpbmVDaGFyZ2VSZWNlaXB0LmdldCgnVFgzMF9MQ1InKTsNCiAgICBTdHJpbmcgRVhUWSA9IGVhY2hMaW5lQ2hhcmdlUmVjZWlwdC5nZXQoJ0VYVFlfTENSJyk7DQogICAgU3RyaW5nIElUTk8gPSBlYWNoTGluZS5nZXQoJ0lUTk8nKTsNCiAgICBTdHJpbmcgUFBVTiA9IGVhY2hMaW5lLmdldCgnUFBVTicpOw0KICAgIFN0cmluZyBQVVVOID0gZWFjaExpbmUuZ2V0KCdQVVVOJyk7DQoNCiAgICBIYXNodGFibGUgdGVtcFRhYmxlID0gbmV3IEhhc2h0YWJsZSA8IFN0cmluZywgU3RyaW5nID4gKCk7DQogICAgdGVtcFRhYmxlLnB1dCgiUFVOTyIsIGVhY2hQVU5PKTsNCiAgICB0ZW1wVGFibGUucHV0KCJQTkxJIiwgUE5MSSk7DQogICAgdGVtcFRhYmxlLnB1dCgiUE5MUyIsIFBOTFMpOw0KICAgIHRlbXBUYWJsZS5wdXQoIlNlcXVlbmNlTnVtYmVyIiwgQ0RTRSk7DQogICAgdGVtcFRhYmxlLnB1dCgiQ29zdGluZ0VsZW1lbnQiLCBDRUlEKTsNCiAgICB0ZW1wVGFibGUucHV0KCJSZWNlaXB0TnVtYmVyIiwgUkVQTik7DQogICAgdGVtcFRhYmxlLnB1dCgiQ29zdGluZ0VsZW1lbnREZXNjcmlwdGlvbiIsIFRYMzApOw0KICAgIHRlbXBUYWJsZS5wdXQoIkNoYXJnZVR5cGUiLCBFWFRZKTsNCiAgICB0ZW1wVGFibGUucHV0KCJJdGVtTnVtYmVyIiwgSVROTyk7DQogICAgdGVtcFRhYmxlLnB1dCgnRjJSRUxQJywgUkVMUCk7DQoNCiAgICAvL1N0cmluZyBhbW91bnRPcGVuID0gRG91YmxlLnRvU3RyaW5nKERvdWJsZS5wYXJzZURvdWJsZShpUHJpY2VQZXJQaWVjZVByaWNlVU0pICogRG91YmxlLnBhcnNlRG91YmxlKGlRdWFudGl0eU9wZW4pKTsNCg0KICAgIHRlbXBUYWJsZS5wdXQoIkFtb3VudE9wZW4iLCBBbW91bnRPcGVuUHJpY2VVTSk7DQogICAgdGVtcFRhYmxlLnB1dCgiQW1vdW50T3JkZXJlZCIsIEFtb3VudFJlY2VpdmVkUHJpY2VVTSk7DQogICAgdGVtcFRhYmxlLnB1dCgiUHJpY2UiLCBQcmljZVBlclBpZWNlUHJpY2VVTSk7DQogICAgdGVtcFRhYmxlLnB1dCgiVW5pdCIsIFBQVU4pOw0KICAgIHRlbXBUYWJsZS5wdXQoIlF1YW50aXR5T3BlbiIsIE9wZW5RdWFudGl0eVByaWNlVU0pOw0KICAgIHRlbXBUYWJsZS5wdXQoIlF1YW50aXR5SW52b2ljZWQiLCBJbnZvaWNlZFF1YW50aXR5UHJpY2VVTSk7DQogICAgdGVtcFRhYmxlLnB1dCgiUXVhbnRpdHlPcmRlcmVkIiwgT3JkZXJlZFF1YW50aXR5UHJpY2VVTSk7DQogICAgdGVtcFRhYmxlLnB1dCgiUXVhbnRpdHlSZWNlaXZlZCIsIFJlY2VpdmVkUXVhbnRpdHlQcmljZVVNKTsNCg0KICAgIGlmIChQVVVOLmVxdWFscyhQUFVOLnRyaW0oKSkpIHsNCiAgICAgIHRlbXBUYWJsZS5wdXQoIkFsdGVybmF0aXZlVW5pdCIsICItIik7DQogICAgICB0ZW1wVGFibGUucHV0KCJBbHRlcm5hdGl2ZVF1YW50aXR5T3BlbiIsICIwLjAiKTsNCiAgICAgIHRlbXBUYWJsZS5wdXQoIkFsdGVybmF0aXZlUHJpY2UiLCAiMC4wIik7DQogICAgfSBlbHNlIHsNCiAgICAgIHRlbXBUYWJsZS5wdXQoIkFsdGVybmF0aXZlVW5pdCIsIFBVVU4pOw0KICAgICAgdGVtcFRhYmxlLnB1dCgiQWx0ZXJuYXRpdmVRdWFudGl0eU9wZW4iLCBPcGVuUXVhbnRpdHlPcmRlclVNKTsNCiAgICAgIHRlbXBUYWJsZS5wdXQoIkFsdGVybmF0aXZlUHJpY2UiLCBQcmljZVBlclBpZWNlT3JkZXJVTSk7DQogICAgfQ0KICAgIGxpbmVPcGVuQ2hhcmdlUmVjZWlwdExpc3QuYWRkKHRlbXBUYWJsZSk7DQogICAgLy9taS5vdXREYXRhLnB1dCgnUFVOTycsJ3Rlc3QnKTsNCiAgICAvL21pLndyaXRlKCk7DQoNCiAgfQ0KICAvKiBnZXQgbGluZSBjaGFyZ2VzIGZyb20gdGFibGUgTVBPRVhQDQogICAqLw0KICBwcml2YXRlIGdldExpbmVDaGFyZ2VzKFN0cmluZyBlYWNoUFVOTywgSGFzaHRhYmxlIGVhY2hMaW5lKSB7DQogICAgdGVtcExpbmVDaGFyZ2VMaXN0ID0gbmV3IEFycmF5TGlzdCA8IEhhc2h0YWJsZSA+ICgpOw0KICAgIExpbmVDaGFyZ2VMaXN0ID0gbmV3IEFycmF5TGlzdCA8IEhhc2h0YWJsZSA+ICgpOw0KICAgIERCQWN0aW9uIHF1ZXJ5TVBPRVhQID0gZGF0YWJhc2UudGFibGUoIk1QT0VYUCIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiSVZDT05PIiwgIklWUFVOTyIsICJJVlBOTEkiLCAiSVZQTkxTIiwgIklWQ0RTRSIsICJJVlJFUE4iLCAiSVZFWFRZIiwgIklWQ0VJRCIsICJJVkVYSUMiLCAiSVZXU09QIiwgIklWQ1VDRCIsICJJVkNFVkEiLCAiSVZDRVZKIiwgIklWVEhQUiIsICJJVklWQ1EiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIHJlY29yZE1QT0VYUCA9IHF1ZXJ5TVBPRVhQLmdldENvbnRhaW5lcigpOw0KICAgIHJlY29yZE1QT0VYUC5zZXQoIklWQ09OTyIsIEludGVnZXIucGFyc2VJbnQoQ09OTy50cmltKCkpKTsNCiAgICByZWNvcmRNUE9FWFAuc2V0KCJJVlBVTk8iLCBlYWNoUFVOTy50cmltKCkpOw0KICAgIHJlY29yZE1QT0VYUC5zZXQoIklWUE5MSSIsIEludGVnZXIucGFyc2VJbnQoZWFjaExpbmUuZ2V0KCdQTkxJJykudG9TdHJpbmcoKSkpOw0KICAgIHJlY29yZE1QT0VYUC5zZXQoIklWUE5MUyIsIEludGVnZXIucGFyc2VJbnQoZWFjaExpbmUuZ2V0KCdQTkxTJykudG9TdHJpbmcoKSkpOw0KICAgIC8vIHJlYWQgbG9jayBhbmQgY2FsbCBjcmVhdGVSZWNvcmRzKCkNCiAgICBpbnQgcmVhZHMgPSBxdWVyeU1QT0VYUC5yZWFkQWxsKHJlY29yZE1QT0VYUCwgNCwgZ2V0TVBPRVhQTGluZVJlY29yZHMpOw0KDQogIH0NCg0KICBDbG9zdXJlIDwgPyA+IGdldE1QT0VYUExpbmVSZWNvcmRzID0gew0KICAgIERCQ29udGFpbmVyIHJlY29yZCAtPg0KICAgIFN0cmluZyBQTkxJID0gcmVjb3JkLmdldCgnSVZQTkxJJyk7DQogICAgU3RyaW5nIFBOTFMgPSByZWNvcmQuZ2V0KCdJVlBOTFMnKTsNCiAgICBTdHJpbmcgQ0RTRSA9IHJlY29yZC5nZXQoJ0lWQ0RTRScpOw0KICAgIFN0cmluZyBSRVBOID0gcmVjb3JkLmdldCgnSVZSRVBOJyk7DQogICAgU3RyaW5nIEVYVFkgPSByZWNvcmQuZ2V0KCdJVkVYVFknKTsNCiAgICBTdHJpbmcgQ0VJRCA9IHJlY29yZC5nZXQoJ0lWQ0VJRCcpOw0KICAgIFN0cmluZyBFWElDID0gcmVjb3JkLmdldCgnSVZFWElDJyk7DQogICAgU3RyaW5nIFdTT1AgPSByZWNvcmQuZ2V0KCdJVldTT1AnKTsNCiAgICBTdHJpbmcgQ1VDRCA9IHJlY29yZC5nZXQoJ0lWQ1VDRCcpOw0KICAgIFN0cmluZyBDRVZBID0gcmVjb3JkLmdldCgnSVZDRVZBJyk7DQogICAgU3RyaW5nIENFVkogPSByZWNvcmQuZ2V0KCdJVkNFVkonKTsNCiAgICBTdHJpbmcgVEhQUiA9IHJlY29yZC5nZXQoJ0lWVEhQUicpOw0KICAgIFN0cmluZyBJVkNRID0gcmVjb3JkLmdldCgnSVZJVkNRJyk7DQogICAgSGFzaHRhYmxlIHRlbXBUYWJsZSA9IG5ldyBIYXNodGFibGUgPCBTdHJpbmcsDQogICAgU3RyaW5nID4gKCk7DQogICAgdGVtcFRhYmxlLnB1dCgnUE5MSScsIFBOTEkpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1BOTFMnLCBQTkxTKTsNCiAgICB0ZW1wVGFibGUucHV0KCdDRFNFJywgQ0RTRSk7DQogICAgdGVtcFRhYmxlLnB1dCgnUkVQTicsIFJFUE4pOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0VYVFknLCBFWFRZKTsNCiAgICB0ZW1wVGFibGUucHV0KCdDRUlEJywgQ0VJRCk7DQogICAgdGVtcFRhYmxlLnB1dCgnRVhJQycsIEVYSUMpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ1dTT1AnLCBXU09QKTsNCiAgICB0ZW1wVGFibGUucHV0KCdDVUNEJywgQ1VDRCk7DQogICAgdGVtcFRhYmxlLnB1dCgnQ0VWQScsIENFVkEpOw0KICAgIHRlbXBUYWJsZS5wdXQoJ0NFVkonLCBDRVZKKTsNCiAgICB0ZW1wVGFibGUucHV0KCdUSFBSJywgVEhQUik7DQogICAgdGVtcFRhYmxlLnB1dCgnSVZDUScsIElWQ1EpOw0KICAgIHRlbXBMaW5lQ2hhcmdlTGlzdC5hZGQodGVtcFRhYmxlKTsNCg0KICB9DQogIC8qIGdldCBsaW5lIGNoYXJnZSB0ZXh0IHVzaW5nIFBQUzI4ME1JLkdldEVsZW1lbnQNCiAgICovDQogIHByaXZhdGUgZ2V0TGluZUNoYXJnZVRleHQoU3RyaW5nIGVhY2hQVU5PLCBIYXNodGFibGUgZWFjaFRlbXBMaW5lQ2hhcmdlLCBIYXNodGFibGUgZWFjaExpbmUpIHsNCiAgICBTdHJpbmcgQ0VJRCA9IGVhY2hUZW1wTGluZUNoYXJnZS5nZXQoJ0NFSUQnKTsNCiAgICBTdHJpbmcgaVBVTk8gPSBlYWNoUFVOTzsNCiAgICBTdHJpbmcgaVBOTEkgPSBlYWNoVGVtcExpbmVDaGFyZ2UuZ2V0KCdQTkxJJyk7DQogICAgU3RyaW5nIGlQTkxTID0gZWFjaFRlbXBMaW5lQ2hhcmdlLmdldCgnUE5MUycpOw0KICAgIFN0cmluZyBpQ0RTRSA9IGVhY2hUZW1wTGluZUNoYXJnZS5nZXQoJ0NEU0UnKTsNCiAgICBTdHJpbmcgaUNFSUQgPSBlYWNoVGVtcExpbmVDaGFyZ2UuZ2V0KCdDRUlEJyk7DQogICAgU3RyaW5nIGlXU09QID0gZWFjaFRlbXBMaW5lQ2hhcmdlLmdldCgnV1NPUCcpOw0KICAgIFN0cmluZyBUWDMwID0gIiI7DQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgVFgzMCA9IHJlc3VsdHMuZ2V0KCdUWDMwJyk7DQoNCiAgICAgIH0NCg0KICAgICAgU3RyaW5nIEVYVFkgPSBlYWNoVGVtcExpbmVDaGFyZ2UuZ2V0KCdFWFRZJyk7DQoNCiAgICAgIGlmICh2YWxpZENoYXJnZVR5cGVzLmNvbnRhaW5zKEVYVFkudHJpbSgpKSkgew0KDQogICAgICAgIGxpbmVPcGVuQ2hhcmdlUmVjZWlwdExpc3QuZWFjaCB7DQoNCiAgICAgICAgICBsaW5lT3BlbkNoYXJnZVJlY2VpcHQgLT4NCiAgICAgICAgICAgIEhhc2h0YWJsZSBodE9wZW5SZWNlaXB0Q2hhcmdlID0gbGluZU9wZW5DaGFyZ2VSZWNlaXB0Ow0KDQogICAgICAgICAgU3RyaW5nIHB1bm8gPSBodE9wZW5SZWNlaXB0Q2hhcmdlLmNvbnRhaW5zS2V5KCJQVU5PIikgPyBodE9wZW5SZWNlaXB0Q2hhcmdlDQogICAgICAgICAgICAuZ2V0KCJQVU5PIikgOiBudWxsOw0KICAgICAgICAgIFN0cmluZyBwbmxpID0gaHRPcGVuUmVjZWlwdENoYXJnZS5jb250YWluc0tleSgiUE5MSSIpID8gaHRPcGVuUmVjZWlwdENoYXJnZQ0KICAgICAgICAgICAgLmdldCgiUE5MSSIpIDogbnVsbDsNCiAgICAgICAgICBTdHJpbmcgcG5scyA9IGh0T3BlblJlY2VpcHRDaGFyZ2UuY29udGFpbnNLZXkoIlBOTFMiKSA/IGh0T3BlblJlY2VpcHRDaGFyZ2UNCiAgICAgICAgICAgIC5nZXQoIlBOTFMiKSA6IG51bGw7DQogICAgICAgICAgU3RyaW5nIGNkc2UgPSBodE9wZW5SZWNlaXB0Q2hhcmdlLmNvbnRhaW5zS2V5KCJTZXF1ZW5jZU51bWJlciIpID8gaHRPcGVuUmVjZWlwdENoYXJnZQ0KICAgICAgICAgICAgLmdldCgiU2VxdWVuY2VOdW1iZXIiKSA6IG51bGw7DQogICAgICAgICAgU3RyaW5nIGNlaWQgPSBodE9wZW5SZWNlaXB0Q2hhcmdlLmNvbnRhaW5zS2V5KCJDb3N0aW5nRWxlbWVudCIpID8gaHRPcGVuUmVjZWlwdENoYXJnZQ0KICAgICAgICAgICAgLmdldCgiQ29zdGluZ0VsZW1lbnQiKSA6IG51bGw7DQogICAgICAgICAgcHVubyA9IHB1bm8gPT0gbnVsbCA/ICIiIDogcHVuby50cmltKCk7DQogICAgICAgICAgcG5saSA9IHBubGkgPT0gbnVsbCA/ICIiIDogcG5saS50cmltKCk7DQogICAgICAgICAgcG5scyA9IHBubHMgPT0gbnVsbCA/ICIiIDogcG5scy50cmltKCk7DQogICAgICAgICAgY2RzZSA9IGNkc2UgPT0gbnVsbCA/ICIiIDogY2RzZS50cmltKCk7DQogICAgICAgICAgY2VpZCA9IGNlaWQgPT0gbnVsbCA/ICIiIDogY2VpZC50cmltKCk7DQogICAgICAgICAgaWYgKHB1bm8uZXF1YWxzKGlQVU5PKSAmJiBwbmxpLmVxdWFscyhpUE5MSSkgJiYgcG5scy5lcXVhbHMoaVBOTFMpICYmDQogICAgICAgICAgICBjZHNlLmVxdWFscyhpQ0RTRSkgJiYgY2VpZC5lcXVhbHMoaUNFSUQpKSB7DQoNCiAgICAgICAgICAgIGh0T3BlblJlY2VpcHRDaGFyZ2UucHV0KCJPcGVyYXRvciIsIGVhY2hUZW1wTGluZUNoYXJnZS5nZXQoJ1dTT1AnKSk7DQogICAgICAgICAgICBodE9wZW5SZWNlaXB0Q2hhcmdlLnB1dCgiQ29zdGluZ0VsZW1lbnREZXNjcmlwdGlvbiIsIFRYMzApOw0KICAgICAgICAgICAgaHRPcGVuUmVjZWlwdENoYXJnZS5wdXQoIlRoaXJkUGFydHlDb3N0cyIsIGVhY2hUZW1wTGluZUNoYXJnZS5nZXQoJ1RIUFInKSk7DQogICAgICAgICAgICBodE9wZW5SZWNlaXB0Q2hhcmdlLnB1dCgiSW52b2ljZUNvc3RzIiwgZWFjaFRlbXBMaW5lQ2hhcmdlLmdldCgnSVZDUScpKTsNCiAgICAgICAgICAgIGh0T3BlblJlY2VpcHRDaGFyZ2UucHV0KCJDdXJyZW5jeSIsIGVhY2hUZW1wTGluZUNoYXJnZS5nZXQoJ0NVQ0QnKSk7DQogICAgICAgICAgICBodE9wZW5SZWNlaXB0Q2hhcmdlLnB1dCgiQ29zdGluZ0VsZW1lbnRBbW91bnQiLCBlYWNoVGVtcExpbmVDaGFyZ2UuZ2V0KCdDRVZBJykpOw0KICAgICAgICAgICAgaHRPcGVuUmVjZWlwdENoYXJnZS5wdXQoIkFkanVzdGVkQ29zdGluZ0VsZW1lbnRBbW91bnQiLCBlYWNoVGVtcExpbmVDaGFyZ2UuZ2V0KCdDRVZKJykpOw0KICAgICAgICAgICAgaHRPcGVuUmVjZWlwdENoYXJnZS5wdXQoIlZBVENvZGUiLCBlYWNoTGluZS5nZXQoJ1ZUQ0QnKSk7DQogICAgICAgICAgICBodE9wZW5SZWNlaXB0Q2hhcmdlLnB1dCgiQ2hhcmdlRmFjdG9yIiwgZWFjaFRlbXBMaW5lQ2hhcmdlLmdldCgnRVhJQycpKTsNCiAgICAgICAgICAgIC8vICAgaHRPcGVuUmVjZWlwdENoYXJnZS5wdXQoIkYyUkVMUCIsZWFjaFRlbXBMaW5lQ2hhcmdlLmdldCgiRjJSRUxQIikpOw0KDQogICAgICAgICAgICBib29sZWFuIGFkZENoYXJnZSA9IHRydWU7DQogICAgICAgICAgICBpV1NPUCA9ICIyMCI7IC8vQ09NTUVOVEVEIEZPUiBURVNUSU5HDQoNCiAgICAgICAgICAgIGlmIChmaXhlZENoYXJnZVR5cGVzLmNvbnRhaW5zKGlXU09QKSkgew0KDQogICAgICAgICAgICAgIEJpZ0RlY2ltYWwgcXVhbnRpdHlJbnZvaWNlZCA9IG5ldyBCaWdEZWNpbWFsKGh0T3BlblJlY2VpcHRDaGFyZ2UuZ2V0KCJRdWFudGl0eUludm9pY2VkIikudG9TdHJpbmcoKSk7DQogICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgY2hhcmdlIHN0aWxsIG5lZWRzIHRvIGJlIGludm9pY2VkLCBpZiB0aGVyZSBoYXMgYmVlbiBhbnkgaW52b2ljaW5nIG9uIHRoaXMgY2hhcmdlIHdlIGNvbnNpZGVyIGl0IGZ1bGx5IGludm9pY2VkDQogICAgICAgICAgICAgIGlmIChxdWFudGl0eUludm9pY2VkLmNvbXBhcmVUbyhCaWdEZWNpbWFsLlpFUk8pICE9IDApIHsNCiAgICAgICAgICAgICAgICAvLyAgICBhZGRDaGFyZ2UgPSBmYWxzZTsgLy8gQ09NTUVOVEVEIEZPUiBURVNUSU5HDQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBodE9wZW5SZWNlaXB0Q2hhcmdlLnB1dCgiUXVhbnRpdHlPcGVuIiwgIjEiKTsNCiAgICAgICAgICAgICAgaHRPcGVuUmVjZWlwdENoYXJnZS5wdXQoIlF1YW50aXR5SW52b2ljZWQiLCAiMSIpOw0KICAgICAgICAgICAgICBodE9wZW5SZWNlaXB0Q2hhcmdlLnB1dCgiUXVhbnRpdHlPcmRlcmVkIiwgIjEiKTsNCiAgICAgICAgICAgICAgaHRPcGVuUmVjZWlwdENoYXJnZS5wdXQoIlF1YW50aXR5UmVjZWl2ZWQiLCAiMSIpOw0KICAgICAgICAgICAgICBodE9wZW5SZWNlaXB0Q2hhcmdlLnB1dCgiUHJpY2UiLCBodE9wZW5SZWNlaXB0Q2hhcmdlLmdldCgiQW1vdW50T3JkZXJlZCIpKTsNCg0KICAgICAgICAgICAgICBodE9wZW5SZWNlaXB0Q2hhcmdlLnB1dCgiQWx0ZXJuYXRpdmVRdWFudGl0eU9wZW4iLCAiMSIpOw0KICAgICAgICAgICAgICBodE9wZW5SZWNlaXB0Q2hhcmdlLnB1dCgiQWx0ZXJuYXRpdmVQcmljZSIsIGh0T3BlblJlY2VpcHRDaGFyZ2UuZ2V0KCJBbW91bnRPcmRlcmVkIikpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoYWRkQ2hhcmdlKSB7DQoNCiAgICAgICAgICAgICAgTGluZUNoYXJnZUxpc3QuYWRkKGh0T3BlblJlY2VpcHRDaGFyZ2UpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQoNCiAgICB9DQogICAgZGVmIHBhcmFtcyA9IFsiQ0VJRCI6IENFSUQudHJpbSgpXTsNCiAgICBtaUNhbGxlci5jYWxsKCJQUFMyODBNSSIsICJHZXRFbGVtZW50IiwgcGFyYW1zLCBjYWxsYmFjayk7DQogIH0NCiAgLyogc2VuZCBsaW5lIGNoYXJnZSBkZXRhaWxzIHRvIG91dHB1dA0KICAgKi8NCiAgcHJpdmF0ZSB3cml0ZUxpbmVDaGFyZ2VzKFN0cmluZyBQVU5PLCBIYXNodGFibGUgZWFjaExpbmVDaGFyZ2UsIEhhc2h0YWJsZSBlYWNoTGluZSkgew0KICAgIGlmICgoIWVhY2hMaW5lQ2hhcmdlLmdldCgiQ29zdGluZ0VsZW1lbnRBbW91bnQiKS5lcXVhbHMoIjAuMDAiKSAmJiBlYWNoTGluZUNoYXJnZS5nZXQoIlByaWNlIikgPT0gbnVsbCkgfHwgZWFjaExpbmVDaGFyZ2UuZ2V0KCJQcmljZSIpICE9IG51bGwpIHsNCiAgICAgIFN0cmluZyBvT3JkZXJOdW1iZXIgPSBQVU5POw0KICAgICAgU3RyaW5nIG9MaW5lTnVtYmVyID0gZWFjaExpbmVDaGFyZ2UuZ2V0KCJQTkxJIik7DQogICAgICBTdHJpbmcgb1N1YkxpbmVOdW1iZXIgPSBlYWNoTGluZUNoYXJnZS5nZXQoIlBOTFMiKTsNCiAgICAgIFN0cmluZyBvU2VxdWVuY2VOdW1iZXIgPSBlYWNoTGluZUNoYXJnZS5nZXQoIlNlcXVlbmNlTnVtYmVyIik7DQogICAgICBTdHJpbmcgb0Nvc3RpbmdFbGVtZW50ID0gZWFjaExpbmVDaGFyZ2UuZ2V0KCJDb3N0aW5nRWxlbWVudCIpOw0KICAgICAgU3RyaW5nIG9SZWNlaXB0TnVtYmVyID0gZWFjaExpbmVDaGFyZ2UuZ2V0KCJSZWNlaXB0TnVtYmVyIik7DQogICAgICBTdHJpbmcgb0Nvc3RpbmdFbGVtZW50RGVzY3JpcHRpb24gPSBlYWNoTGluZUNoYXJnZS5nZXQoIkNvc3RpbmdFbGVtZW50RGVzY3JpcHRpb24iKTsNCiAgICAgIFN0cmluZyBvQ2hhcmdlVHlwZSA9IGVhY2hMaW5lQ2hhcmdlLmdldCgiQ2hhcmdlVHlwZSIpOw0KICAgICAgU3RyaW5nIG9PcGVyYXRvciA9IGVhY2hMaW5lQ2hhcmdlLmdldCgiT3BlcmF0b3IiKTsNCiAgICAgIFN0cmluZyBvSXRlbU51bWJlciA9IGVhY2hMaW5lQ2hhcmdlLmdldCgiSXRlbU51bWJlciIpOw0KICAgICAgU3RyaW5nIG9UaGlyZFBhcnR5Q29zdHMgPSBlYWNoTGluZUNoYXJnZS5nZXQoIlRoaXJkUGFydHlDb3N0cyIpOw0KICAgICAgU3RyaW5nIG9JbnZvaWNlQ29zdHMgPSBlYWNoTGluZUNoYXJnZS5nZXQoIkludm9pY2VDb3N0cyIpOw0KICAgICAgU3RyaW5nIG9DdXJyZW5jeSA9IGVhY2hMaW5lQ2hhcmdlLmdldCgiQ3VycmVuY3kiKTsNCiAgICAgIFN0cmluZyBvQ29zdGluZ0VsZW1lbnRBbW91bnQgPSBlYWNoTGluZUNoYXJnZS5nZXQoIkNvc3RpbmdFbGVtZW50QW1vdW50Iik7DQogICAgICBTdHJpbmcgb0FkanVzdGVkQ29zdGluZ0VsZW1lbnRBbW91bnQgPSBlYWNoTGluZUNoYXJnZS5nZXQoIkFkanVzdGVkQ29zdGluZ0VsZW1lbnRBbW91bnQiKTsNCiAgICAgIFN0cmluZyBvVkFUQ29kZSA9IGVhY2hMaW5lQ2hhcmdlLmdldCgiVkFUQ29kZSIpOw0KICAgICAgU3RyaW5nIG9DaGFyZ2VGYWN0b3IgPSBlYWNoTGluZUNoYXJnZS5nZXQoIkNoYXJnZUZhY3RvciIpOw0KICAgICAgU3RyaW5nIG9BbW91bnRPcGVuID0gZWFjaExpbmVDaGFyZ2UuZ2V0KCJBbW91bnRPcGVuIik7DQogICAgICBTdHJpbmcgb0Ftb3VudE9yZGVyZWQgPSBlYWNoTGluZUNoYXJnZS5nZXQoIkFtb3VudE9yZGVyZWQiKTsNCiAgICAgIFN0cmluZyBvUHJpY2UgPSBlYWNoTGluZUNoYXJnZS5nZXQoIlByaWNlIik7DQogICAgICBTdHJpbmcgb1VuaXQgPSBlYWNoTGluZUNoYXJnZS5nZXQoIlVuaXQiKTsNCiAgICAgIFN0cmluZyBvUXVhbnRpdHlPcGVuID0gZWFjaExpbmVDaGFyZ2UuZ2V0KCJRdWFudGl0eU9wZW4iKTsNCiAgICAgIFN0cmluZyBvUXVhbnRpdHlJbnZvaWNlZCA9IGVhY2hMaW5lQ2hhcmdlLmdldCgiUXVhbnRpdHlJbnZvaWNlZCIpOw0KICAgICAgU3RyaW5nIG9RdWFudGl0eU9yZGVyZWQgPSBlYWNoTGluZUNoYXJnZS5nZXQoIlF1YW50aXR5T3JkZXJlZCIpOw0KICAgICAgU3RyaW5nIG9RdWFudGl0eVJlY2VpdmVkID0gZWFjaExpbmVDaGFyZ2UuZ2V0KCJRdWFudGl0eVJlY2VpdmVkIik7DQogICAgICBTdHJpbmcgb0FsdGVybmF0aXZlVW5pdCA9IGVhY2hMaW5lQ2hhcmdlLmdldCgiQWx0ZXJuYXRpdmVVbml0Iik7DQogICAgICBTdHJpbmcgb0FsdGVybmF0aXZlUXVhbnRpdHlPcGVuID0gZWFjaExpbmVDaGFyZ2UuZ2V0KCJBbHRlcm5hdGl2ZVF1YW50aXR5T3BlbiIpOw0KICAgICAgU3RyaW5nIG9BbHRlcm5hdGl2ZVByaWNlID0gZWFjaExpbmVDaGFyZ2UuZ2V0KCJBbHRlcm5hdGl2ZVByaWNlIik7DQogICAgICBTdHJpbmcgRjJSRUxQID0gZWFjaExpbmVDaGFyZ2UuZ2V0KCJGMlJFTFAiKTsNCg0KICAgICAgb0Ftb3VudE9wZW4gPSBvQW1vdW50T3BlbiA9PSBudWxsID8gb0Nvc3RpbmdFbGVtZW50QW1vdW50IDogb0Ftb3VudE9wZW47DQogICAgICBvQW1vdW50T3JkZXJlZCA9IG9BbW91bnRPcmRlcmVkID09IG51bGwgPyAiMSIgOiBvQW1vdW50T3JkZXJlZDsNCiAgICAgIG9QcmljZSA9IG9QcmljZSA9PSBudWxsID8gb0Nvc3RpbmdFbGVtZW50QW1vdW50IDogb1ByaWNlOw0KICAgICAgb1VuaXQgPSBvVW5pdCA9PSBudWxsID8gIiAiIDogb1VuaXQ7DQogICAgICBvUXVhbnRpdHlPcGVuID0gb1F1YW50aXR5T3BlbiA9PSBudWxsID8gIjEiIDogb1F1YW50aXR5T3BlbjsNCiAgICAgIG9RdWFudGl0eUludm9pY2VkID0gb1F1YW50aXR5SW52b2ljZWQgPT0gbnVsbCA/ICIgIiA6IG9RdWFudGl0eUludm9pY2VkOw0KICAgICAgb1F1YW50aXR5T3JkZXJlZCA9IG9RdWFudGl0eU9yZGVyZWQgPT0gbnVsbCA/ICIgIiA6IG9RdWFudGl0eU9yZGVyZWQ7DQogICAgICBvUXVhbnRpdHlSZWNlaXZlZCA9IG9RdWFudGl0eVJlY2VpdmVkID09IG51bGwgPyAiICIgOiBvUXVhbnRpdHlSZWNlaXZlZDsNCiAgICAgIG9BbHRlcm5hdGl2ZVVuaXQgPSBvQWx0ZXJuYXRpdmVVbml0ID09IG51bGwgPyAiICIgOiBvQWx0ZXJuYXRpdmVVbml0Ow0KICAgICAgb0FsdGVybmF0aXZlUXVhbnRpdHlPcGVuID0gb0FsdGVybmF0aXZlUXVhbnRpdHlPcGVuID09IG51bGwgPyAiICIgOiBvQWx0ZXJuYXRpdmVRdWFudGl0eU9wZW47DQogICAgICBvQWx0ZXJuYXRpdmVQcmljZSA9IG9BbHRlcm5hdGl2ZVByaWNlID09IG51bGwgPyAiICIgOiBvQWx0ZXJuYXRpdmVQcmljZTsNCg0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JDVFAnLCAiTEMiKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQVU5PJywgb09yZGVyTnVtYmVyKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQTkxJJywgb0xpbmVOdW1iZXIpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BOTFMnLCBvU3ViTGluZU51bWJlcik7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQ0RTRScsIG9TZXF1ZW5jZU51bWJlcik7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQ0VJRCcsIG9Db3N0aW5nRWxlbWVudCk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUlBOTScsIG9SZWNlaXB0TnVtYmVyKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdDRUxEJywgb0Nvc3RpbmdFbGVtZW50RGVzY3JpcHRpb24pOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0VYVFknLCBvQ2hhcmdlVHlwZSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnV1NPUCcsIG9PcGVyYXRvcik7DQogICAgICBtaS5vdXREYXRhLnB1dCgnVEhQUicsIG9UaGlyZFBhcnR5Q29zdHMpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0NVQ0QnLCBvQ3VycmVuY3kpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0NIRkMnLCBvQ2hhcmdlRmFjdG9yKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdDRVZBJywgb0Nvc3RpbmdFbGVtZW50QW1vdW50KTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdDRVZKJywgb0FkanVzdGVkQ29zdGluZ0VsZW1lbnRBbW91bnQpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1ZUQ0QnLCBvVkFUQ29kZSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnSVROTycsIG9JdGVtTnVtYmVyKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBTU9QJywgb0Ftb3VudE9wZW4pOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0FNT1InLCBvQW1vdW50T3JkZXJlZCk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUFJDRScsIG9QcmljZSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnVU5JVCcsIG9Vbml0KTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdPUFFUJywgb1F1YW50aXR5T3Blbik7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUVRJVicsIG9RdWFudGl0eUludm9pY2VkKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdRVE9SJywgb1F1YW50aXR5T3JkZXJlZCk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUVRSVicsIG9RdWFudGl0eVJlY2VpdmVkKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBTFRVJywgb0FsdGVybmF0aXZlVW5pdCk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQUxRTycsIG9BbHRlcm5hdGl2ZVF1YW50aXR5T3Blbik7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQUxUUCcsIG9BbHRlcm5hdGl2ZVByaWNlKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdSRUxQJywgRjJSRUxQKTsNCg0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BOTEknLCBlYWNoTGluZS5nZXQoJ1BOTEknKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQTkxTJywgZWFjaExpbmUuZ2V0KCdQTkxTJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnVFJEVCcsIGVhY2hMaW5lLmdldCgnVFJEVCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0xXSEwnLCBlYWNoTGluZS5nZXQoJ1dITE8nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdJVE5PJywgZWFjaExpbmUuZ2V0KCdJVE5PJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUElURCcsIGVhY2hMaW5lLmdldCgnUElURCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BJVFQnLCBlYWNoTGluZS5nZXQoJ1BJVFQnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdTSVRFJywgZWFjaExpbmUuZ2V0KCdTSVRFJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQ0FRQScsIGVhY2hMaW5lLmdldCgnQ0FRQScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JKUUEnLCBlYWNoTGluZS5nZXQoJ1JKUUEnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdTRFFBJywgZWFjaExpbmUuZ2V0KCdTRFFBJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnT1JRQScsIGVhY2hMaW5lLmdldCgnT1JRQScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0lWUUEnLCBlYWNoTGluZS5nZXQoJ0lWUUEnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdSVlFBJywgZWFjaExpbmUuZ2V0KCdSVlFBJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQ0ZRQScsIGVhY2hMaW5lLmdldCgnQ0ZRQScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ09RUFUnLCBlYWNoTGluZS5nZXQoJ09wZW5RdWFudGl0eVByaWNlVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQVVJDJywgZWFjaExpbmUuZ2V0KCdQVVJDJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnTEJVWScsIGVhY2hMaW5lLmdldCgnQlVZRScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1NUVU0nLCBlYWNoTGluZS5nZXQoJ1N0YW5kYXJkVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdVTk1TJywgZWFjaExpbmUuZ2V0KCdVTk1TJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQUxVTScsIGVhY2hMaW5lLmdldCgnQWx0ZXJuYXRlVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdMTkFNJywgZWFjaExpbmUuZ2V0KCdMTkFNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUFVQUicsIGVhY2hMaW5lLmdldCgnUHJpY2VQZXJQaWVjZVN0YW5kYXJkVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQVVFUJywgZWFjaExpbmUuZ2V0KCdQVVFUJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQUxQUicsIGVhY2hMaW5lLmdldCgnQWx0ZXJuYXRpdmVQcmljZScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BUQ0QnLCBlYWNoTGluZS5nZXQoJ1ZUQ0QnKS50b1N0cmluZygpKTsNCiAgICAgIGlmIChlYWNoTGluZS5nZXQoJ1ZUQ0QnKS50b1N0cmluZygpLmxlbmd0aCgpID09IDEpIHsNCg0KICAgICAgICBtaS5vdXREYXRhLnB1dCgnVlRDRCcsICcwJyArIGVhY2hMaW5lLmdldCgnVlRDRCcpLnRvU3RyaW5nKCkpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1ZUQ0QnLCBlYWNoTGluZS5nZXQoJ1ZUQ0QnKS50b1N0cmluZygpKTsNCiAgICAgIH0NCiAgICAgIG1pLm91dERhdGEucHV0KCdHUk1UJywgZWFjaExpbmUuZ2V0KCdHUk1UJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnTE1PRCcsIGVhY2hMaW5lLmdldCgnTU9ETCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0xURUQnLCBlYWNoTGluZS5nZXQoJ1RFREwnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdMVEVMJywgZWFjaExpbmUuZ2V0KCdURUwxJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnTFBTTCcsIGVhY2hMaW5lLmdldCgnUFVTTCcpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0xQU1QnLCBlYWNoTGluZS5nZXQoJ1BVU1QnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdQT1BOJywgZWFjaExpbmUuZ2V0KCdQT1BOX0VBMTMnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdST1JDJywgZWFjaExpbmUuZ2V0KCdST1JDJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnUk9STicsIGVhY2hMaW5lLmdldCgnUk9STicpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1JPUkwnLCBlYWNoTGluZS5nZXQoJ1JPUkwnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdST1JYJywgZWFjaExpbmUuZ2V0KCdST1JYJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnU1VETycsIGVhY2hMaW5lLmdldCgnU1VETycpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0ZSUkMnLCBlYWNoTGluZS5nZXQoJ0ZSUkMnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdGUlJFJywgZWFjaExpbmUuZ2V0KCdGUlJFJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQURRQScsIGVhY2hMaW5lLmdldCgnQURRQScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ09SUVQnLCBlYWNoTGluZS5nZXQoJ09SUVQnKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBTU9QJywgZWFjaExpbmUuZ2V0KCdBbW91bnRPcGVuJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQU1PUicsIGVhY2hMaW5lLmdldCgnTE5BTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1BSQ0UnLCBlYWNoTGluZS5nZXQoJ1ByaWNlUGVyUGllY2VTdGFuZGFyZFVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnVU5JVCcsIGVhY2hMaW5lLmdldCgnU3RhbmRhcmRVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ09QUVQnLCBlYWNoTGluZS5nZXQoJ09wZW5RdWFudGl0eVN0YW5kYXJkVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdRVElWJywgZWFjaExpbmUuZ2V0KCdJbnZvaWNlZFF1YW50aXR5U3RhbmRhcmRVTScpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1FUT1InLCBlYWNoTGluZS5nZXQoJ09yZGVyZWRRdWFudGl0eVN0YW5kYXJkVU0nKS50b1N0cmluZygpKQ0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1FUUlYnLCBlYWNoTGluZS5nZXQoJ1JlY2VpdmVkUXVhbnRpdHlTdGFuZGFyZFVNJykudG9TdHJpbmcoKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgnQUxUVScsIGVhY2hMaW5lLmdldCgnQWx0ZXJuYXRlVU0nKS50b1N0cmluZygpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdBTFFPJywgZWFjaExpbmUuZ2V0KCdBbHRlcm5hdGl2ZVF1YW50aXR5T3BlbicpLnRvU3RyaW5nKCkpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoJ0FMVFAnLCBlYWNoTGluZS5nZXQoJ0FsdGVybmF0aXZlUHJpY2UnKS50b1N0cmluZygpKTsNCg0KICAgICAgbWkud3JpdGUoKTsNCg0KICAgIH0NCiAgfQ0KfQ=="}}}