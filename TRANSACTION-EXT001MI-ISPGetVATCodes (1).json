{"utilities":{},"programModules":{"EXT001MI":{"program":"EXT001MI","triggers":{},"transactions":{"ISPGetVATCodes":{"sourceUuid":"508ac32e-ae10-4688-a843-f94531ab82b8","name":"ISPGetVATCodes","program":"EXT001MI","description":"ALL_MI_0001_GetVATCodes","active":true,"multi":true,"modified":1668253432605,"modifiedBy":"MALALS01","outputFields":[{"name":"DIVI","description":"division","length":3,"mandatory":false,"type":"A"},{"name":"VTCD","description":"VAT code","length":2,"mandatory":false,"type":"N"},{"name":"TX40","description":"description","length":40,"mandatory":false,"type":"A"},{"name":"VTD1","description":"nondeductible VAT 1","length":5,"mandatory":false,"type":"N"},{"name":"VTP1","description":"VAT rate 1","length":5,"mandatory":false,"type":"N"},{"name":"VTD2","description":"nondeductible VAT 2","length":5,"mandatory":false,"type":"N"},{"name":"VTP2","description":"VAT rate 2","length":5,"mandatory":false,"type":"N"},{"name":"FRDT","description":"from date","length":8,"mandatory":false,"type":"N"},{"name":"ONSR","description":"VAT on service","length":1,"mandatory":false,"type":"A"},{"name":"VATT","description":"VAT method","length":20,"mandatory":false,"type":"N"},{"name":"CSCD","description":"country","length":3,"mandatory":false,"type":"A"}],"inputFields":[],"utilities":[]}},"batches":{}}},"sources":{"508ac32e-ae10-4688-a843-f94531ab82b8":{"uuid":"508ac32e-ae10-4688-a843-f94531ab82b8","updated":1668253423265,"updatedBy":"MALALS01","created":1652953843455,"createdBy":"MALALS01","apiVersion":"0.9","beVersion":"16.0.0.20220817161547","codeHash":"0F303E990572E7B83CAF1BFB1463424131BBCC87898C50D4250FC2DB59E44D40","code":"LyoqDQogKiBOYW1lOiBJU1BHZXRWQVRDb2Rlcw0KICogVHlwZSA6IEV4dGVuZE0zQVBJDQogKiBEZXNjcmlwdGlvbjogU2VuZCBNMyBWQVQgY29kZSBkZXRhaWxzIHRvIDNyZCBwYXJ0eSBhcHBsaWNhdGlvbg0KICogKg0KICogQ3JlYXRlZCBCeTogQXBleCBzeXN0ZW1zDQogKiBBdXRob3I6IFNoYXNoYW5rIE1hbGFsaSwgQW5naGVsbyBGZXJuYW5kZXoNCiAqDQogKiBIaXN0b3J5Og0KICogMjAyMi0wNS0xOTogQmFzZSBzY3JpcHQgY3JlYXRlZA0KICogMjAyMi0xMS0xMiBDb2RlIGNsZWFuIHVwIA0KICoNCiAqLw0KDQpwdWJsaWMgY2xhc3MgSVNQR2V0VkFUQ29kZXMgZXh0ZW5kcyBFeHRlbmRNM1RyYW5zYWN0aW9uIHsNCiAgcHJpdmF0ZSBmaW5hbCBNSUFQSSBtaTsNCiAgcHJpdmF0ZSBmaW5hbCBQcm9ncmFtQVBJIHByb2dyYW07DQogIHByaXZhdGUgZmluYWwgTUlDYWxsZXJBUEkgbWlDYWxsZXI7DQogIHByaXZhdGUgZmluYWwgRGF0YWJhc2VBUEkgZGF0YWJhc2U7DQogIHByaXZhdGUgU3RyaW5nIENPTk8gPSAiIjsNCiAgcHJpdmF0ZSBTdHJpbmcgc3RhcnRESVZJID0gIiI7DQogIHByaXZhdGUgU3RyaW5nIGlnbm9yZUJsYW5rRGl2aXNpb24gPSAiIjsNCiAgcHJpdmF0ZSBBcnJheUxpc3QgPCBTdHJpbmcgPiBtZXRob2RQb3NpdGlvbkxpc3QgPSBudWxsOw0KICBwcml2YXRlIEFycmF5TGlzdCA8IFN0cmluZyA+IG9uU2VydmljZVBvc2l0aW9uTGlzdCA9IG51bGw7DQogIHByaXZhdGUgQXJyYXlMaXN0IDwgU3RyaW5nID4gZGl2aXNpb25MaXN0ID0gbnVsbDsNCiAgcHJpdmF0ZSBib29sZWFuIGhhc0RhdGEgPSBmYWxzZTsNCg0KICBwdWJsaWMgSVNQR2V0VkFUQ29kZXMoTUlBUEkgbWksIFByb2dyYW1BUEkgcHJvZ3JhbSwgTUlDYWxsZXJBUEkgbWlDYWxsZXIsIERhdGFiYXNlQVBJIGRhdGFiYXNlKSB7DQogICAgdGhpcy5taSA9IG1pOw0KICAgIHRoaXMubWlDYWxsZXIgPSBtaUNhbGxlcjsNCiAgICB0aGlzLnByb2dyYW0gPSBwcm9ncmFtOw0KICAgIHRoaXMuZGF0YWJhc2UgPSBkYXRhYmFzZTsNCiAgfQ0KDQogIHB1YmxpYyB2b2lkIG1haW4oKSB7DQogICAgQ09OTyA9IHByb2dyYW0uTERBWkQuZ2V0KCdDT05PJyk7DQogICAgcG9wdWxhdGVDb250cm9sUHJvcGVydGllcygpOw0KICAgIGlmIChpZ25vcmVCbGFua0RpdmlzaW9uLnRyaW0oKS5lcXVhbHMoIjEiKSkgew0KICAgICAgc3RhcnRESVZJID0gIjAiOw0KICAgIH0NCiAgICBnYXRoZXJBbGxEaXZpc2lvbnMoKTsNCiAgICBkaXZpc2lvbkxpc3QuZWFjaCB7DQogICAgICB2YWx1ZSAtPg0KICAgICAgICBTdHJpbmcgZWFjaERpdmlzaW9uID0gdmFsdWU7DQogICAgICBpZiAoZWFjaERpdmlzaW9uLnRyaW0oKS5pc0VtcHR5KCkgJiYgaWdub3JlQmxhbmtEaXZpc2lvbiA9PSAiMSIpIHsNCiAgICAgICAgLy8gU2tpcCBkaXZpc2lvbg0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgZ2V0VkFUQ29kZXMoZWFjaERpdmlzaW9uKTsNCiAgICAgICAgZ2V0WmVyb1ZBVENvZGUoZWFjaERpdmlzaW9uKTsNCiAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoaGFzRGF0YSkgew0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1RYNDAnLCAnJSVFT0YlJScpOw0KICAgICAgbWkud3JpdGUoKTsNCiAgICB9DQogIH0NCg0KICAvKioNCiAgICogR2V0IGNvbnRyb2wgcHJvcGVydGllcyBmcm9tIENVR0VYMQ0KICAgKiANCiAgICovDQoNCiAgcHVibGljIHBvcHVsYXRlQ29udHJvbFByb3BlcnRpZXMoKSB7DQoNCiAgICBib29sZWFuIHJlY29yZEV4aXN0cyA9IHRydWU7DQogICAgZGVmIGNhbGxiYWNrID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICBpZ25vcmVCbGFua0RpdmlzaW9uID0gcmVzdWx0cy5nZXQoJ0ExMjEnKTsNCg0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgbWkuZXJyb3IoIlBsZWFzZSBtYWludGFpbiByZWNvcmQgaW4gQ1VHRVgxIGZvciBJR05PUkVCTEFOS0RJVkkiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgIH0NCiAgICBkZWYgcGFyYW1zID0gWyJGSUxFIjogIklTUEZJTEUiLCAiUEswMSI6ICJHRVRWQVRDT0RFUyIsICJQSzAyIjogIklHTk9SRUJMQU5LRElWSSJdOw0KICAgIG1pQ2FsbGVyLmNhbGwoIkNVU0VYVE1JIiwgIkdldEZpZWxkVmFsdWUiLCBwYXJhbXMsIGNhbGxiYWNrKTsNCg0KICAgIG1ldGhvZFBvc2l0aW9uTGlzdCA9IG5ldyBBcnJheUxpc3QgPCBTdHJpbmcgPiAoKTsNCiAgICByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjazIgPSB7DQogICAgICBNYXAgPCBTdHJpbmcsDQogICAgICBTdHJpbmcgPiByZXN1bHRzIC0+DQogICAgICByZWNvcmRFeGlzdHMgPSAhcmVzdWx0cy5nZXQoJ2Vycm9yJyk7DQogICAgICBpZiAocmVjb3JkRXhpc3RzKSB7DQogICAgICAgIFN0cmluZyBtZXRob2RQb3NpdGlvbnMgPSByZXN1bHRzLmdldCgnQTEyMScpOw0KICAgICAgICBTdHJpbmdbXSBtZXRob2RQb3NpdGlvbnNBcnJheSA9IG1ldGhvZFBvc2l0aW9ucy5zcGxpdCgnOycpOw0KICAgICAgICBtZXRob2RQb3NpdGlvbnNBcnJheS5lYWNoIHsNCiAgICAgICAgICB2YWx1ZSAtPg0KICAgICAgICAgICAgU3RyaW5nIG1ldGhvZFBvc2l0aW9uID0gdmFsdWU7DQogICAgICAgICAgbWV0aG9kUG9zaXRpb25MaXN0LmFkZChtZXRob2RQb3NpdGlvbi50cmltKCkpOw0KDQogICAgICAgIH0NCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1pLmVycm9yKCJQbGVhc2UgbWFpbnRhaW4gcmVjb3JkIGluIENVR0VYMSBmb3IgTUVUSE9EUE9TSVRJT04iKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgIH0NCiAgICBkZWYgcGFyYW1zMiA9IFsiRklMRSI6ICJJU1BGSUxFIiwgIlBLMDEiOiAiR0VUVkFUQ09ERVMiLCAiUEswMiI6ICJNRVRIT0RQT1NJVElPTiJdOw0KICAgIG1pQ2FsbGVyLmNhbGwoIkNVU0VYVE1JIiwgIkdldEZpZWxkVmFsdWUiLCBwYXJhbXMyLCBjYWxsYmFjazIpOw0KDQogICAgb25TZXJ2aWNlUG9zaXRpb25MaXN0ID0gbmV3IEFycmF5TGlzdCA8IFN0cmluZyA+ICgpOw0KDQogICAgcmVjb3JkRXhpc3RzID0gdHJ1ZTsNCiAgICBkZWYgY2FsbGJhY2szID0gew0KICAgICAgTWFwIDwgU3RyaW5nLA0KICAgICAgU3RyaW5nID4gcmVzdWx0cyAtPg0KICAgICAgcmVjb3JkRXhpc3RzID0gIXJlc3VsdHMuZ2V0KCdlcnJvcicpOw0KICAgICAgaWYgKHJlY29yZEV4aXN0cykgew0KICAgICAgICBTdHJpbmcgb25TZXJ2aWNlUG9zaXRpb25zID0gcmVzdWx0cy5nZXQoJ0ExMjEnKTsNCiAgICAgICAgU3RyaW5nW10gb25TZXJ2aWNlUG9zaXRpb25zQXJyYXkgPSBvblNlcnZpY2VQb3NpdGlvbnMuc3BsaXQoJzsnKTsNCiAgICAgICAgb25TZXJ2aWNlUG9zaXRpb25zQXJyYXkuZWFjaCB7DQogICAgICAgICAgdmFsdWUgLT4NCiAgICAgICAgICAgIFN0cmluZyBvblNlcnZpY2VQb3NpdGlvbiA9IHZhbHVlOw0KICAgICAgICAgIG9uU2VydmljZVBvc2l0aW9uTGlzdC5hZGQob25TZXJ2aWNlUG9zaXRpb24udHJpbSgpKTsNCg0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICBtaS5lcnJvcigiUGxlYXNlIG1haW50YWluIHJlY29yZCBpbiBDVUdFWDEgZm9yIE9OU0VSVklDRVBPU0lUSU9OIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICB9DQogICAgZGVmIHBhcmFtczMgPSBbIkZJTEUiOiAiSVNQRklMRSIsICJQSzAxIjogIkdFVFZBVENPREVTIiwgIlBLMDIiOiAiT05TRVJWSUNFUE9TSVRJT04iXTsNCiAgICBtaUNhbGxlci5jYWxsKCJDVVNFWFRNSSIsICJHZXRGaWVsZFZhbHVlIiwgcGFyYW1zMywgY2FsbGJhY2szKTsNCg0KICB9DQoNCiAgLyoqDQogICAqIExpc3QgYWxsIE0zIGRpdmlzaW9ucw0KICAgKiANCiAgICovDQogIHB1YmxpYyBnYXRoZXJBbGxEaXZpc2lvbnMoKSB7DQogICAgZGl2aXNpb25MaXN0ID0gbmV3IEFycmF5TGlzdCA8IFN0cmluZyA+ICgpOw0KICAgIGJvb2xlYW4gcmVjb3JkRXhpc3RzID0gdHJ1ZTsNCiAgICBkZWYgY2FsbGJhY2sgPSB7DQogICAgICBNYXAgPCBTdHJpbmcsDQogICAgICBTdHJpbmcgPiByZXN1bHRzIC0+DQogICAgICByZWNvcmRFeGlzdHMgPSAhcmVzdWx0cy5nZXQoJ2Vycm9yJyk7DQogICAgICBpZiAocmVjb3JkRXhpc3RzKSB7DQogICAgICAgIFN0cmluZyBESVZJID0gcmVzdWx0cy5nZXQoJ0RJVkknKTsNCiAgICAgICAgZGl2aXNpb25MaXN0LmFkZChESVZJLnRyaW0oKSk7DQoNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1pLmVycm9yKCJObyBEaXZpc2lvbnMgZm91bmQiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgIH0NCiAgICBkZWYgcGFyYW1zID0gWyJDT05PIjogQ09OTywgIkRJVkkiOiBzdGFydERJVkldOw0KICAgIG1pQ2FsbGVyLmNhbGwoIk1OUzEwME1JIiwgIkxzdERpdmlzaW9ucyIsIHBhcmFtcywgY2FsbGJhY2spOw0KICB9DQoNCiAgLyoqDQogICAqIFJlYWQgYWxsIFZBVCBjb2RlIA0KICAgKiANCiAgICovDQoNCiAgcHVibGljIGdldFZBVENvZGVzKFN0cmluZyBlYWNoRGl2aXNpb24pIHsNCiAgICBEQkFjdGlvbiBxdWVyeUNWQVRQQyA9IGRhdGFiYXNlLnRhYmxlKCJDVkFUUEMiKQ0KICAgICAgLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiQ1ZDT05PIiwgIkNWRElWSSIsICJDVlZUQ0QiLCAiQ1ZGUkRUIiwgIkNWVFg0MCIsICJDVlZUUDEiLCAiQ1ZWVFAyIiwgIkNWVlREMSIsICJDVlZURDIiLCAiQ1ZDU0NEIikNCiAgICAgIC5idWlsZCgpDQogICAgREJDb250YWluZXIgcmVjb3JkQ1ZBVFBDID0gcXVlcnlDVkFUUEMuZ2V0Q29udGFpbmVyKCkNCiAgICByZWNvcmRDVkFUUEMuc2V0KCJDVkNPTk8iLCBDT05PLnRvSW50ZWdlcigpKTsNCiAgICByZWNvcmRDVkFUUEMuc2V0KCJDVkRJVkkiLCBlYWNoRGl2aXNpb24pOw0KICAgIC8vIHJlYWQgbG9jayBhbmQgY2FsbCBjcmVhdGVSZWNvcmRzKCkNCiAgICBpbnQgcmVhZHMgPSBxdWVyeUNWQVRQQy5yZWFkQWxsKHJlY29yZENWQVRQQywgMiwgZ2V0Q1ZBVFBDUmVjb3Jkcyk7DQoNCiAgfQ0KDQogIENsb3N1cmUgPCA/ID4gZ2V0Q1ZBVFBDUmVjb3JkcyA9IHsNCiAgICBEQkNvbnRhaW5lciByZWNvcmQgLT4NCiAgICBTdHJpbmcgVlRDRCA9IHJlY29yZC5nZXQoIkNWVlRDRCIpOw0KICAgIFN0cmluZyBESVZJID0gcmVjb3JkLmdldCgiQ1ZESVZJIik7DQogICAgU3RyaW5nIEZSRFQgPSByZWNvcmQuZ2V0KCJDVkZSRFQiKTsNCiAgICBTdHJpbmcgVFg0MCA9IHJlY29yZC5nZXQoIkNWVFg0MCIpOw0KICAgIFN0cmluZyBWVFAxID0gcmVjb3JkLmdldCgiQ1ZWVFAxIik7DQogICAgU3RyaW5nIFZUUDIgPSByZWNvcmQuZ2V0KCJDVlZUUDIiKTsNCiAgICBTdHJpbmcgVlREMSA9IHJlY29yZC5nZXQoIkNWVlREMSIpOw0KICAgIFN0cmluZyBWVEQyID0gcmVjb3JkLmdldCgiQ1ZWVEQyIik7DQogICAgU3RyaW5nIENTQ0QgPSByZWNvcmQuZ2V0KCJDVkNTQ0QiKTsNCiAgICBWVENEID0gU3RyaW5nLmZvcm1hdCgiJTAyZCIsIFZUQ0QudHJpbSgpLnRvSW50ZWdlcigpKTsNCiAgICBTdHJpbmdbXSB2YXREZXRhaWxzID0gZ2V0VmF0RGV0YWlscyhWVENELCBESVZJKTsNCiAgICBpZiAodmF0RGV0YWlscy5sZW5ndGggPT0gMikgew0KICAgICAgbWkub3V0RGF0YS5wdXQoJ1ZBVFQnLCB2YXREZXRhaWxzWzBdKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCdPTlNSJywgdmF0RGV0YWlsc1sxXSk7DQogICAgfQ0KICAgIG1pLm91dERhdGEucHV0KCdWVENEJywgVlRDRCk7DQogICAgbWkub3V0RGF0YS5wdXQoJ0RJVkknLCBESVZJKTsNCiAgICBtaS5vdXREYXRhLnB1dCgnRlJEVCcsIEZSRFQpOw0KICAgIG1pLm91dERhdGEucHV0KCdUWDQwJywgVFg0MCk7DQogICAgbWkub3V0RGF0YS5wdXQoJ1ZUUDEnLCBWVFAxKTsNCiAgICBtaS5vdXREYXRhLnB1dCgnVlRQMicsIFZUUDIpOw0KICAgIG1pLm91dERhdGEucHV0KCdWVEQxJywgVlREMSk7DQogICAgbWkub3V0RGF0YS5wdXQoJ1ZURDInLCBWVEQyKTsNCiAgICBtaS5vdXREYXRhLnB1dCgnQ1NDRCcsIENTQ0QpOw0KICAgIG1pLndyaXRlKCk7DQogICAgaGFzRGF0YSA9IHRydWU7DQoNCiAgfQ0KDQogIC8qKg0KICAgKiBEZXBlbmQgdXBvbiBjb250cm9sIHByb3BlcnR5IGdldCBWQVQgY29kZSBkZXRhaWxzDQogICAqIA0KICAgKi8NCiAgcHVibGljIFN0cmluZ1tdIGdldFZhdERldGFpbHMoU3RyaW5nIFZUQ0QsIFN0cmluZyBESVZJKSB7DQogICAgU3RyaW5nW10gdmF0RGV0YWlscyA9IG5ldyBTdHJpbmdbMl07DQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgU3RyaW5nIFBBUk0gPSByZXN1bHRzLmdldCgnUEFSTScpOw0KICAgICAgICBpbnQgbWV0aG9kU3RhcnRQb3NpdGlvbiA9IG1ldGhvZFBvc2l0aW9uTGlzdC5nZXQoMCkudG9JbnRlZ2VyKCk7DQogICAgICAgIGludCBtZXRob2RQb3NpdGlvbkxlbmd0aCA9IG1ldGhvZFBvc2l0aW9uTGlzdC5nZXQoMSkudG9JbnRlZ2VyKCk7DQogICAgICAgIGludCBvblNlcnZpY2VTdGFydFBvc2l0aW9uID0gb25TZXJ2aWNlUG9zaXRpb25MaXN0LmdldCgwKS50b0ludGVnZXIoKTsNCiAgICAgICAgaW50IG9uU2VydmljZUxlbmd0aCA9IG9uU2VydmljZVBvc2l0aW9uTGlzdC5nZXQoMSkudG9JbnRlZ2VyKCk7DQoNCiAgICAgICAgU3RyaW5nIFZBVFQgPSBQQVJNLmxlbmd0aCgpIDwgbWV0aG9kU3RhcnRQb3NpdGlvbiArIG1ldGhvZFBvc2l0aW9uTGVuZ3RoID8gIiIgOiBQQVJNLnN1YnN0cmluZyhtZXRob2RTdGFydFBvc2l0aW9uLCBtZXRob2RTdGFydFBvc2l0aW9uICsgbWV0aG9kUG9zaXRpb25MZW5ndGgpOw0KICAgICAgICBTdHJpbmcgVkFUT25TZXJ2aWNlcyA9IFBBUk0ubGVuZ3RoKCkgPCBvblNlcnZpY2VTdGFydFBvc2l0aW9uICsgb25TZXJ2aWNlTGVuZ3RoID8gIiIgOiBQQVJNLnN1YnN0cmluZyhvblNlcnZpY2VTdGFydFBvc2l0aW9uLCBvblNlcnZpY2VTdGFydFBvc2l0aW9uICsgb25TZXJ2aWNlTGVuZ3RoKTsNCiAgICAgICAgdmF0RGV0YWlsc1swXSA9IFZBVFQ7DQogICAgICAgIHZhdERldGFpbHNbMV0gPSBWQVRPblNlcnZpY2VzOw0KICAgICAgfQ0KDQogICAgfQ0KICAgIGRlZiBwYXJhbXMgPSBbIkNPTk8iOiBDT05PLCAiRElWSSI6IERJVkksICJTVENPIjogIlZUQ0QiLCAiU1RLWSI6IFZUQ0RdOw0KICAgIG1pQ2FsbGVyLmNhbGwoIkNSUzE3NU1JIiwgIkdldEdlbmVyYWxDb2RlIiwgcGFyYW1zLCBjYWxsYmFjayk7DQogICAgcmV0dXJuIHZhdERldGFpbHM7DQogIH0NCg0KICAvKioNCiAgICogRGVwZW5kIHVwb24gY29udHJvbCBwcm9wZXJ0eSBnZXQgVkFUIGNvZGUgZGV0YWlscw0KICAgKiANCiAgICovDQogIHB1YmxpYyBnZXRaZXJvVkFUQ29kZShTdHJpbmcgZWFjaERpdmlzaW9uKSB7DQogICAgYm9vbGVhbiByZWNvcmRFeGlzdHMgPSB0cnVlOw0KICAgIGRlZiBjYWxsYmFjayA9IHsNCiAgICAgIE1hcCA8IFN0cmluZywNCiAgICAgIFN0cmluZyA+IHJlc3VsdHMgLT4NCiAgICAgIHJlY29yZEV4aXN0cyA9ICFyZXN1bHRzLmdldCgnZXJyb3InKTsNCiAgICAgIGlmIChyZWNvcmRFeGlzdHMpIHsNCiAgICAgICAgU3RyaW5nIFRYNDAgPSByZXN1bHRzLmdldCgnVFg0MCcpOw0KICAgICAgICBTdHJpbmcgUEFSTSA9IHJlc3VsdHMuZ2V0KCdQQVJNJyk7DQogICAgICAgIGludCBtZXRob2RTdGFydFBvc2l0aW9uID0gbWV0aG9kUG9zaXRpb25MaXN0LmdldCgwKS50b0ludGVnZXIoKTsNCiAgICAgICAgaW50IG1ldGhvZFBvc2l0aW9uTGVuZ3RoID0gbWV0aG9kUG9zaXRpb25MaXN0LmdldCgxKS50b0ludGVnZXIoKTsNCiAgICAgICAgaW50IG9uU2VydmljZVN0YXJ0UG9zaXRpb24gPSBvblNlcnZpY2VQb3NpdGlvbkxpc3QuZ2V0KDApLnRvSW50ZWdlcigpOw0KICAgICAgICBpbnQgb25TZXJ2aWNlTGVuZ3RoID0gb25TZXJ2aWNlUG9zaXRpb25MaXN0LmdldCgxKS50b0ludGVnZXIoKTsNCg0KICAgICAgICBTdHJpbmcgVkFUVCA9IFBBUk0ubGVuZ3RoKCkgPCBtZXRob2RTdGFydFBvc2l0aW9uICsgbWV0aG9kUG9zaXRpb25MZW5ndGggPyAiIiA6IFBBUk0uc3Vic3RyaW5nKG1ldGhvZFN0YXJ0UG9zaXRpb24sIG1ldGhvZFN0YXJ0UG9zaXRpb24gKyBtZXRob2RQb3NpdGlvbkxlbmd0aCk7DQoNCiAgICAgICAgU3RyaW5nIFZBVE9uU2VydmljZXMgPSBQQVJNLmxlbmd0aCgpIDwgb25TZXJ2aWNlU3RhcnRQb3NpdGlvbiArIG9uU2VydmljZUxlbmd0aCA/ICIiIDogUEFSTS5zdWJzdHJpbmcob25TZXJ2aWNlU3RhcnRQb3NpdGlvbiwgb25TZXJ2aWNlU3RhcnRQb3NpdGlvbiArIG9uU2VydmljZUxlbmd0aCk7DQogICAgICAgIG1pLm91dERhdGEucHV0KCdESVZJJywgZWFjaERpdmlzaW9uKTsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1ZUQ0QnLCAiMDAiKTsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1RYNDAnLCBUWDQwKTsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ09OU1InLCBWQVRPblNlcnZpY2VzKTsNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoJ1ZBVFQnLCBWQVRUKTsNCiAgICAgICAgbWkud3JpdGUoKTsNCiAgICAgIH0NCg0KICAgIH0NCiAgICBkZWYgcGFyYW1zID0gWyJDT05PIjogQ09OTywgIkRJVkkiOiBlYWNoRGl2aXNpb24sICJTVENPIjogIlZUQ0QiLCAiU1RLWSI6ICIwMCJdOw0KICAgIG1pQ2FsbGVyLmNhbGwoIkNSUzE3NU1JIiwgIkdldEdlbmVyYWxDb2RlIiwgcGFyYW1zLCBjYWxsYmFjayk7DQogIH0NCn0="}}}